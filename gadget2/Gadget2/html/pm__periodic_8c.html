<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GADGET-2: pm_periodic.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>pm_periodic.c File Reference</h1>routines for periodic PM-force computation <a href="#_details">More...</a>
<p>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;math.h&gt;</code><br>
<code>#include &lt;float.h&gt;</code><br>
<code>#include &lt;mpi.h&gt;</code><br>
<code>#include &lt;srfftw_mpi.h&gt;</code><br>
<code>#include "<a class="el" href="allvars_8h-source.html">allvars.h</a>"</code><br>
<code>#include "<a class="el" href="proto_8h-source.html">proto.h</a>"</code><br>

<p>
<a href="pm__periodic_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__periodic_8c.html#a0">PMGRID2</a>&nbsp;&nbsp;&nbsp;(2*(PMGRID/2 + 1))</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__periodic_8c.html#a20">pm_init_periodic</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__periodic_8c.html#a21">pm_init_periodic_allocate</a> (int dimprod)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__periodic_8c.html#a22">pm_init_periodic_free</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__periodic_8c.html#a23">pmforce_periodic</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pm__periodic_8c.html#a24">pmpotential_periodic</a> (void)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
routines for periodic PM-force computation 
<p>

<p>
Definition in file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="pm_periodic.c::PMGRID2"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define PMGRID2&nbsp;&nbsp;&nbsp;(2*(PMGRID/2 + 1))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="pm__periodic_8c-source.html#l00029">29</a> of file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.
<p>
Referenced by <a class="el" href="pm__periodic_8c-source.html#l00181">pmforce_periodic()</a>, and <a class="el" href="pm__periodic_8c-source.html#l00694">pmpotential_periodic()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a20" doxytag="pm_periodic.c::pm_init_periodic"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pm_init_periodic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routines generates the FFTW-plans to carry out the parallel FFTs later on. Some auxiliary variables are also initialized.<p>
&lt; @-ASMTH gives the scale of the short-range/long-range force split in units of FFT-mesh cells <p>
&lt; @-RCUT gives the maximum distance (in units of the scale used for the force split) out to which short-range forces are evaluated in the short-range tree walk. 
<p>
Definition at line <a class="el" href="pm__periodic_8c-source.html#l00055">55</a> of file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00374">global_data_all_processes::Asmth</a>, <a class="el" href="allvars_8h-source.html#l00083">ASMTH</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00375">global_data_all_processes::Rcut</a>, <a class="el" href="allvars_8h-source.html#l00087">RCUT</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="longrange_8c-source.html#l00020">long_range_init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="pm_periodic.c::pm_init_periodic_allocate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pm_init_periodic_allocate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dimprod</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function allocates the memory neeed to compute the long-range PM force. Three fields are used, one to hold the density (and its FFT, and then the real-space potential), one to hold the force field obtained by finite differencing, and finally a workspace field, which is used both as workspace for the parallel FFT, and as buffer for the communication algorithm used in the force computation. 
<p>
Definition at line <a class="el" href="pm__periodic_8c-source.html#l00114">114</a> of file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.
<p>
References <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="system_8c-source.html#l00115">imax()</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="pm__periodic_8c-source.html#l00181">pmforce_periodic()</a>, and <a class="el" href="pm__periodic_8c-source.html#l00694">pmpotential_periodic()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="pm_periodic.c::pm_init_periodic_free"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pm_init_periodic_free           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine frees the space allocated for the parallel FFT algorithm. 
<p>
Definition at line <a class="el" href="pm__periodic_8c-source.html#l00161">161</a> of file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.
<p>
Referenced by <a class="el" href="pm__periodic_8c-source.html#l00181">pmforce_periodic()</a>, and <a class="el" href="pm__periodic_8c-source.html#l00694">pmpotential_periodic()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="pm_periodic.c::pmforce_periodic"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pmforce_periodic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Calculates the long-range periodic force given the particle positions using the PM method. The force is Gaussian filtered with Asmth, given in mesh-cell units. We carry out a CIC charge assignment, and compute the potenial by Fourier transform methods. The potential is finite differenced using a 4-point finite differencing formula, and the forces are interpolated tri-linearly to the particle positions. The CIC kernel is deconvolved. Note that the particle distribution is not in the slab decomposition that is used for the FFT. Instead, overlapping patches between local domains and FFT slabs are communicated as needed. 
<p>
Definition at line <a class="el" href="pm__periodic_8c-source.html#l00181">181</a> of file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00374">global_data_all_processes::Asmth</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="forcetree_8c-source.html#l02622">force_treeallocate()</a>, <a class="el" href="forcetree_8c-source.html#l02687">force_treefree()</a>, <a class="el" href="allvars_8h-source.html#l00302">global_data_all_processes::G</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00297">global_data_all_processes::NumForcesSinceLastDomainDecomp</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="pm__periodic_8c-source.html#l00114">pm_init_periodic_allocate()</a>, <a class="el" href="pm__periodic_8c-source.html#l00161">pm_init_periodic_free()</a>, <a class="el" href="pm__periodic_8c-source.html#l00029">PMGRID2</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="tags_8h-source.html#l00020">TAG_PERIODIC_A</a>, <a class="el" href="tags_8h-source.html#l00021">TAG_PERIODIC_B</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00279">global_data_all_processes::TreeAllocFactor</a>, and <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>.
<p>
Referenced by <a class="el" href="longrange_8c-source.html#l00056">long_range_force()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="pm_periodic.c::pmpotential_periodic"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pmpotential_periodic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Calculates the long-range potential using the PM method. The potential is Gaussian filtered with Asmth, given in mesh-cell units. We carry out a CIC charge assignment, and compute the potenial by Fourier transform methods. The CIC kernel is deconvolved. 
<p>
Definition at line <a class="el" href="pm__periodic_8c-source.html#l00694">694</a> of file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00374">global_data_all_processes::Asmth</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="forcetree_8c-source.html#l02622">force_treeallocate()</a>, <a class="el" href="forcetree_8c-source.html#l02687">force_treefree()</a>, <a class="el" href="allvars_8h-source.html#l00302">global_data_all_processes::G</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00297">global_data_all_processes::NumForcesSinceLastDomainDecomp</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="pm__periodic_8c-source.html#l00114">pm_init_periodic_allocate()</a>, <a class="el" href="pm__periodic_8c-source.html#l00161">pm_init_periodic_free()</a>, <a class="el" href="pm__periodic_8c-source.html#l00029">PMGRID2</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00504">particle_data::Potential</a>, <a class="el" href="tags_8h-source.html#l00022">TAG_PERIODIC_C</a>, <a class="el" href="tags_8h-source.html#l00023">TAG_PERIODIC_D</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00279">global_data_all_processes::TreeAllocFactor</a>, and <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>.
<p>
Referenced by <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat Apr 22 15:29:42 2006 for GADGET-2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
