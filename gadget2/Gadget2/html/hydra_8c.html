<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GADGET-2: hydra.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>hydra.c File Reference</h1>Computation of SPH forces and rate of entropy generation. <a href="#_details">More...</a>
<p>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;math.h&gt;</code><br>
<code>#include &lt;mpi.h&gt;</code><br>
<code>#include &lt;gsl/gsl_math.h&gt;</code><br>
<code>#include "<a class="el" href="allvars_8h-source.html">allvars.h</a>"</code><br>
<code>#include "<a class="el" href="proto_8h-source.html">proto.h</a>"</code><br>

<p>
<a href="hydra_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hydra_8c.html#a0">boxSize_X</a>&nbsp;&nbsp;&nbsp;boxSize</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hydra_8c.html#a1">boxHalf_X</a>&nbsp;&nbsp;&nbsp;boxHalf</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hydra_8c.html#a2">boxSize_Y</a>&nbsp;&nbsp;&nbsp;boxSize</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hydra_8c.html#a3">boxHalf_Y</a>&nbsp;&nbsp;&nbsp;boxHalf</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hydra_8c.html#a4">boxSize_Z</a>&nbsp;&nbsp;&nbsp;boxSize</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hydra_8c.html#a5">boxHalf_Z</a>&nbsp;&nbsp;&nbsp;boxHalf</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hydra_8c.html#a15">hydro_force</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hydra_8c.html#a16">hydro_evaluate</a> (int target, int mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hydra_8c.html#a17">hydro_compare_key</a> (const void *a, const void *b)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Computation of SPH forces and rate of entropy generation. 
<p>
This file contains the "second SPH loop", where the SPH forces are computed, and where the rate of change of entropy due to the shock heating (via artificial viscosity) is computed.
<p>
Definition in file <a class="el" href="hydra_8c-source.html">hydra.c</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="hydra.c::boxHalf_X"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define boxHalf_X&nbsp;&nbsp;&nbsp;boxHalf          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00028">28</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="hydra.c::boxHalf_Y"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define boxHalf_Y&nbsp;&nbsp;&nbsp;boxHalf          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00034">34</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="hydra.c::boxHalf_Z"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define boxHalf_Z&nbsp;&nbsp;&nbsp;boxHalf          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00040">40</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="hydra.c::boxSize_X"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define boxSize_X&nbsp;&nbsp;&nbsp;boxSize          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00027">27</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="hydra.c::boxSize_Y"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define boxSize_Y&nbsp;&nbsp;&nbsp;boxSize          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00033">33</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="hydra.c::boxSize_Z"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define boxSize_Z&nbsp;&nbsp;&nbsp;boxSize          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00039">39</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a17" doxytag="hydra.c::hydro_compare_key"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int hydro_compare_key           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>b</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This is a comparison kernel for a sort routine, which is used to group particles that are going to be exported to the same CPU. 
<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00563">563</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.
<p>
Referenced by <a class="el" href="hydra_8c-source.html#l00050">hydro_force()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="hydra.c::hydro_evaluate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void hydro_evaluate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is the 'core' of the SPH force computation. A target particle is specified which may either be local, or reside in the communication buffer.<p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00353">353</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00766">hydrodata_out::Acc</a>, <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00288">global_data_all_processes::ArtBulkViscConst</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00546">sph_particle_data::CurlVel</a>, <a class="el" href="allvars_8h-source.html#l00536">sph_particle_data::Density</a>, <a class="el" href="allvars_8h-source.html#l00753">hydrodata_in::Density</a>, <a class="el" href="allvars_8h-source.html#l00548">sph_particle_data::DhsmlDensityFactor</a>, <a class="el" href="allvars_8h-source.html#l00756">hydrodata_in::DhsmlDensityFactor</a>, <a class="el" href="system_8c-source.html#l00105">dmin()</a>, <a class="el" href="allvars_8h-source.html#l00542">sph_particle_data::DtEntropy</a>, <a class="el" href="allvars_8h-source.html#l00767">hydrodata_out::DtEntropy</a>, <a class="el" href="allvars_8h-source.html#l00755">hydrodata_in::F1</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00052">GAMMA</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00751">hydrodata_in::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00543">sph_particle_data::HydroAccel</a>, <a class="el" href="allvars_8c-source.html#l00201">HydroDataGet</a>, <a class="el" href="allvars_8c-source.html#l00205">HydroDataResult</a>, <a class="el" href="system_8c-source.html#l00115">imax()</a>, <a class="el" href="allvars_8h-source.html#l00111">KERNEL_COEFF_3</a>, <a class="el" href="allvars_8h-source.html#l00114">KERNEL_COEFF_6</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00752">hydrodata_in::Mass</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00549">sph_particle_data::MaxSignalVel</a>, <a class="el" href="allvars_8h-source.html#l00768">hydrodata_out::MaxSignalVel</a>, <a class="el" href="ngb_8c-source.html#l00064">ngb_treefind_pairs()</a>, <a class="el" href="allvars_8c-source.html#l00032">Ngblist</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00749">hydrodata_in::Pos</a>, <a class="el" href="allvars_8h-source.html#l00541">sph_particle_data::Pressure</a>, <a class="el" href="allvars_8h-source.html#l00754">hydrodata_in::Pressure</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>, <a class="el" href="allvars_8h-source.html#l00757">hydrodata_in::Timestep</a>, <a class="el" href="allvars_8h-source.html#l00750">hydrodata_in::Vel</a>, and <a class="el" href="allvars_8h-source.html#l00544">sph_particle_data::VelPred</a>.
<p>
Referenced by <a class="el" href="hydra_8c-source.html#l00050">hydro_force()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="hydra.c::hydro_force"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void hydro_force           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is the driver routine for the calculation of hydrodynamical force and rate of change of entropy due to shock heating for all active particles .<p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00050">50</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00766">hydrodata_out::Acc</a>, <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="density_8c-source.html#l00028">boxHalf_X</a>, <a class="el" href="density_8c-source.html#l00034">boxHalf_Y</a>, <a class="el" href="density_8c-source.html#l00040">boxHalf_Z</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="density_8c-source.html#l00027">boxSize_X</a>, <a class="el" href="density_8c-source.html#l00033">boxSize_Y</a>, <a class="el" href="density_8c-source.html#l00039">boxSize_Z</a>, <a class="el" href="allvars_8h-source.html#l00272">global_data_all_processes::BunchSizeHydro</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00397">global_data_all_processes::CPU_HydCommSumm</a>, <a class="el" href="allvars_8h-source.html#l00396">global_data_all_processes::CPU_HydCompWalk</a>, <a class="el" href="allvars_8h-source.html#l00398">global_data_all_processes::CPU_HydImbalance</a>, <a class="el" href="allvars_8h-source.html#l00546">sph_particle_data::CurlVel</a>, <a class="el" href="allvars_8h-source.html#l00753">hydrodata_in::Density</a>, <a class="el" href="allvars_8h-source.html#l00536">sph_particle_data::Density</a>, <a class="el" href="allvars_8h-source.html#l00756">hydrodata_in::DhsmlDensityFactor</a>, <a class="el" href="allvars_8h-source.html#l00548">sph_particle_data::DhsmlDensityFactor</a>, <a class="el" href="allvars_8h-source.html#l00542">sph_particle_data::DtEntropy</a>, <a class="el" href="allvars_8h-source.html#l00767">hydrodata_out::DtEntropy</a>, <a class="el" href="allvars_8c-source.html#l00030">Exportflag</a>, <a class="el" href="allvars_8h-source.html#l00755">hydrodata_in::F1</a>, <a class="el" href="allvars_8h-source.html#l00052">GAMMA</a>, <a class="el" href="allvars_8h-source.html#l00055">GAMMA_MINUS1</a>, <a class="el" href="allvars_8h-source.html#l00751">hydrodata_in::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="hydra_8c-source.html#l00563">hydro_compare_key()</a>, <a class="el" href="hydra_8c-source.html#l00353">hydro_evaluate()</a>, <a class="el" href="allvars_8h-source.html#l00543">sph_particle_data::HydroAccel</a>, <a class="el" href="allvars_8c-source.html#l00201">HydroDataGet</a>, <a class="el" href="allvars_8c-source.html#l00201">HydroDataIn</a>, <a class="el" href="allvars_8c-source.html#l00205">HydroDataPartialResult</a>, <a class="el" href="allvars_8c-source.html#l00205">HydroDataResult</a>, <a class="el" href="allvars_8h-source.html#l00507">particle_data::ID</a>, <a class="el" href="allvars_8h-source.html#l00759">hydrodata_in::Index</a>, <a class="el" href="allvars_8h-source.html#l00752">hydrodata_in::Mass</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00549">sph_particle_data::MaxSignalVel</a>, <a class="el" href="allvars_8h-source.html#l00768">hydrodata_out::MaxSignalVel</a>, <a class="el" href="allvars_8c-source.html#l00016">N_gas</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8c-source.html#l00021">NumSphUpdate</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00749">hydrodata_in::Pos</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="allvars_8h-source.html#l00754">hydrodata_in::Pressure</a>, <a class="el" href="allvars_8h-source.html#l00541">sph_particle_data::Pressure</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="tags_8h-source.html#l00017">TAG_HYDRO_A</a>, <a class="el" href="tags_8h-source.html#l00018">TAG_HYDRO_B</a>, <a class="el" href="allvars_8h-source.html#l00758">hydrodata_in::Task</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8h-source.html#l00757">hydrodata_in::Timestep</a>, <a class="el" href="allvars_8h-source.html#l00750">hydrodata_in::Vel</a>, and <a class="el" href="allvars_8h-source.html#l00544">sph_particle_data::VelPred</a>.
<p>
Referenced by <a class="el" href="accel_8c-source.html#l00024">compute_accelerations()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat Apr 22 15:29:42 2006 for GADGET-2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
