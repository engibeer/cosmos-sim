<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GADGET-2: io.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>io.c File Reference</h1>Routines for producing a snapshot file on disk. <a href="#_details">More...</a>
<p>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;math.h&gt;</code><br>
<code>#include &lt;mpi.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &lt;hdf5.h&gt;</code><br>
<code>#include "<a class="el" href="allvars_8h-source.html">allvars.h</a>"</code><br>
<code>#include "<a class="el" href="proto_8h-source.html">proto.h</a>"</code><br>

<p>
<a href="io_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a0">SKIP</a>&nbsp;&nbsp;&nbsp;{my_fwrite(&amp;blksize,sizeof(int),1,fd);}</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a3">savepositions</a> (int num)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a4">fill_write_buffer</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr, int *startindex, int pc, int type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a5">get_bytes_per_blockelement</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a6">get_datatype_in_block</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a7">get_values_per_blockelement</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a8">get_particles_in_block</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr, int *typelist)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a9">blockpresent</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a10">fill_Tab_IO_Labels</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a11">get_dataset_name</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr, char *buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a12">write_file</a> (char *fname, int writeTask, int lastTask)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a13">write_header_attributes_in_hdf5</a> (hid_t handle)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a14">my_fwrite</a> (void *ptr, size_t size, size_t nmemb, FILE *stream)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a15">my_fread</a> (void *ptr, size_t size, size_t nmemb, FILE *stream)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Routines for producing a snapshot file on disk. 
<p>

<p>
Definition in file <a class="el" href="io_8c-source.html">io.c</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="io.c::SKIP"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define SKIP&nbsp;&nbsp;&nbsp;{my_fwrite(&amp;blksize,sizeof(int),1,fd);}          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a9" doxytag="io.c::blockpresent"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int blockpresent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>blocknr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function tells whether or not a given block in the output file is present, depending on the type of simulation run and the compile-time options. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00532">532</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="io.c::fill_Tab_IO_Labels"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void fill_Tab_IO_Labels           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function associates a short 4-character block name with each block number. This is stored in front of each block for snapshot FileFormat=2. If one wants to add a new output-block, this function should be augmented accordingly.<p>
&lt; total number of defined information blocks for snapshot files. Must be equal to the number of entries in "enum iofields" 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00566">566</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>, <a class="el" href="allvars_8h-source.html#l00640">iofields</a>, and <a class="el" href="allvars_8c-source.html#l00167">Tab_IO_Labels</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00031">read_ic()</a>, and <a class="el" href="io_8c-source.html#l00033">savepositions()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="io.c::fill_write_buffer"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void fill_write_buffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>blocknr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>startindex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function fills the write buffer with particle data. New output blocks can in principle be added here.<p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00129">129</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00536">sph_particle_data::Density</a>, <a class="el" href="system_8c-source.html#l00095">dmax()</a>, <a class="el" href="allvars_8h-source.html#l00542">sph_particle_data::DtEntropy</a>, <a class="el" href="allvars_8h-source.html#l00535">sph_particle_data::Entropy</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00052">GAMMA</a>, <a class="el" href="allvars_8h-source.html#l00055">GAMMA_MINUS1</a>, <a class="el" href="driftfac_8c-source.html#l00105">get_gravkick_factor()</a>, <a class="el" href="driftfac_8c-source.html#l00142">get_hydrokick_factor()</a>, <a class="el" href="allvars_8h-source.html#l00497">particle_data::GravAccel</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00543">sph_particle_data::HydroAccel</a>, <a class="el" href="allvars_8h-source.html#l00507">particle_data::ID</a>, <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00291">global_data_all_processes::MinEgySpec</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00367">global_data_all_processes::PM_Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00366">global_data_all_processes::PM_Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00504">particle_data::Potential</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, and <a class="el" href="allvars_8h-source.html#l00496">particle_data::Vel</a>.
<p>
Referenced by <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="io.c::get_bytes_per_blockelement"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int get_bytes_per_blockelement           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>blocknr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function tells the size of one data entry in each of the blocks defined for the output file. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00366">366</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, and <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="io.c::get_dataset_name"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void get_dataset_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>blocknr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function returns a descriptive character string that describes the name of the block when the HDF5 file format is used. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00614">614</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, and <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="io.c::get_datatype_in_block"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int get_datatype_in_block           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>blocknr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function returns the type of the data contained in a given block of the output file. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00405">405</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="io.c::get_particles_in_block"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int get_particles_in_block           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>blocknr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>typelist</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function determines how many particles there are in a given block, based on the information in the header-structure. It also flags particle types that are present in the block in the typelist array. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00465">465</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00161">header</a>, <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>, <a class="el" href="allvars_8h-source.html#l00462">global_data_all_processes::MassTable</a>, and <a class="el" href="allvars_8h-source.html#l00613">io_header::npart</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="io.c::get_values_per_blockelement"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int get_values_per_blockelement           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>blocknr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function informs about the number of elements stored per particle for the given block of the output file. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00432">432</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, and <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="io.c::my_fread"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">size_t my_fread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname" nowrap> <em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>nmemb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>stream</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This catches I/O errors occuring for fread(). In this case we better stop. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l01141">1141</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="io.c::my_fwrite"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">size_t my_fwrite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname" nowrap> <em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>nmemb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>stream</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This catches I/O errors occuring for <a class="el" href="io_8c.html#a14">my_fwrite()</a>. In this case we better stop. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l01124">1124</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="io.c::savepositions"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void savepositions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>num</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function writes a snapshot of the particle distribution to one or several files using the selected file format. If NumFilesPerSnapshot&gt;1, the snapshot is distributed onto several files, several of them can be written simultaneously (up to NumFilesWrittenInParallel). Each file contains data from a group of processors. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00033">33</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00392">global_data_all_processes::CPU_Snapshot</a>, <a class="el" href="read__ic_8c-source.html#l00725">distribute_file()</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="io_8c-source.html#l00566">fill_Tab_IO_Labels()</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00265">global_data_all_processes::NumFilesPerSnapshot</a>, <a class="el" href="allvars_8h-source.html#l00266">global_data_all_processes::NumFilesWrittenInParallel</a>, <a class="el" href="allvars_8h-source.html#l00297">global_data_all_processes::NumForcesSinceLastDomainDecomp</a>, <a class="el" href="allvars_8h-source.html#l00471">global_data_all_processes::OutputDir</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="allvars_8h-source.html#l00263">global_data_all_processes::SnapFormat</a>, <a class="el" href="allvars_8h-source.html#l00472">global_data_all_processes::SnapshotFileBase</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.
<p>
Referenced by <a class="el" href="run_8c-source.html#l00020">run()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="io.c::write_file"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void write_file           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>writeTask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>lastTask</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function writes an actual snapshot file containing the data from processors 'writeTask' to 'lastTask'. 'writeTask' is the one that actually writes. Each snapshot file contains a header first, then particle positions, velocities and ID's. Particle masses are written only for those particle types with zero entry in MassTable. After that, first the internal energies u, and then the density is written for the SPH particles. If cooling is enabled, mean molecular weight and neutral hydrogen abundance are written for the gas particles. This is followed by the SPH smoothing length and further blocks of information, depending on included physics and compile-time flags. If HDF5 is used, the header is stored in a group called "/Header", and the particle data is stored separately for each particle type in groups calles "/PartType0", "/PartType1", etc. The sequence of the blocks is unimportant in this case.<p>
&lt; Various tags used for labelling MPI messages <p>
&lt; Various tags used for labelling MPI messages <p>
&lt; total number of defined information blocks for snapshot files. Must be equal to the number of entries in "enum iofields" 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00673">673</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="io_8c-source.html#l00532">blockpresent()</a>, <a class="el" href="allvars_8h-source.html#l00624">io_header::BoxSize</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="allvars_8h-source.html#l00269">global_data_all_processes::BufferSize</a>, <a class="el" href="allvars_8c-source.html#l00101">CommBuffer</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="io_8c-source.html#l00129">fill_write_buffer()</a>, <a class="el" href="allvars_8h-source.html#l00622">io_header::flag_cooling</a>, <a class="el" href="allvars_8h-source.html#l00619">io_header::flag_feedback</a>, <a class="el" href="allvars_8h-source.html#l00629">io_header::flag_metals</a>, <a class="el" href="allvars_8h-source.html#l00618">io_header::flag_sfr</a>, <a class="el" href="allvars_8h-source.html#l00628">io_header::flag_stellarage</a>, <a class="el" href="io_8c-source.html#l00366">get_bytes_per_blockelement()</a>, <a class="el" href="io_8c-source.html#l00614">get_dataset_name()</a>, <a class="el" href="io_8c-source.html#l00405">get_datatype_in_block()</a>, <a class="el" href="io_8c-source.html#l00465">get_particles_in_block()</a>, <a class="el" href="io_8c-source.html#l00432">get_values_per_blockelement()</a>, <a class="el" href="allvars_8c-source.html#l00161">header</a>, <a class="el" href="allvars_8h-source.html#l00627">io_header::HubbleParam</a>, <a class="el" href="allvars_8h-source.html#l00323">global_data_all_processes::HubbleParam</a>, <a class="el" href="allvars_8h-source.html#l00640">iofields</a>, <a class="el" href="allvars_8h-source.html#l00614">io_header::mass</a>, <a class="el" href="allvars_8h-source.html#l00462">global_data_all_processes::MassTable</a>, <a class="el" href="io_8c-source.html#l01124">my_fwrite()</a>, <a class="el" href="allvars_8h-source.html#l00613">io_header::npart</a>, <a class="el" href="allvars_8h-source.html#l00620">io_header::npartTotal</a>, <a class="el" href="allvars_8h-source.html#l00630">io_header::npartTotalHighWord</a>, <a class="el" href="allvars_8h-source.html#l00623">io_header::num_files</a>, <a class="el" href="allvars_8h-source.html#l00265">global_data_all_processes::NumFilesPerSnapshot</a>, <a class="el" href="allvars_8h-source.html#l00625">io_header::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00626">io_header::OmegaLambda</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, <a class="el" href="allvars_8h-source.html#l00617">io_header::redshift</a>, <a class="el" href="allvars_8h-source.html#l00263">global_data_all_processes::SnapFormat</a>, <a class="el" href="allvars_8c-source.html#l00167">Tab_IO_Labels</a>, <a class="el" href="tags_8h-source.html#l00032">TAG_LOCALN</a>, <a class="el" href="tags_8h-source.html#l00005">TAG_N</a>, <a class="el" href="tags_8h-source.html#l00019">TAG_NFORTHISTASK</a>, <a class="el" href="tags_8h-source.html#l00007">TAG_PDATA</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00616">io_header::time</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, and <a class="el" href="io_8c-source.html#l01000">write_header_attributes_in_hdf5()</a>.
<p>
Referenced by <a class="el" href="io_8c-source.html#l00033">savepositions()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="io.c::write_header_attributes_in_hdf5"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void write_header_attributes_in_hdf5           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">hid_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>handle</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function writes the header information in case HDF5 is selected as file format. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l01000">1000</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
Referenced by <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat Apr 22 15:29:42 2006 for GADGET-2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
