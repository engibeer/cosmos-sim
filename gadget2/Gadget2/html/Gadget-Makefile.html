<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GADGET-2: Makefile of GADGET-2</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1><a class="anchor" name="Gadget-Makefile">Makefile of GADGET-2</a></h1>A number of features of GADGET-2 are controlled with compile-time options in the makefile rather than by the parameterfile. This has been done in order to allow the generation of highly optimised binaries by the compiler, even when the underlying source code allows for many different ways to run the code.<p>
The makefile contains a dummy list of all available compile-time options, with most of them commented out by default. To activate a certain feature, the corresponding parameter should be commented in, and given the desired value, where appropriate. Below, a brief guide to these options is included.<p>
<b>Important Note:</b> Whenever one of the compile-time options described below is modified, a full recompilation of the code may be necessary. To guarantee that this is done when a simple <b>make</b> is specified, all source files have been specified in the Makefile as being dependent on the Makefile itself. Alternatively, one can also issue the command <b>make clean</b>, which will erase all object files, followed by <b>make</b>.<p>
Note that the above technique has the disadvantage that different simulations may require different binaries of GADGET-2. If several simulations are run concurrently, there is hence the danger that a simulation is started/resumed with the `wrong' binary. Note that while GADGET-2 checks the plausibility of some of the most important code options, this is not done for all of them. To minimise the risk of using the wrong executable for a simulation, it is recommended to produce a separate executable for each simulation that is run. For example, a good strategy is to make a copy of the whole code together with its makefile in the output directory of each simulation run, and then to use this copy to compile the code and to run the simulation.<p>
<br>
 <h2><a class="anchor" name="secmake1">
Basic operation mode of code</a></h2>
<ul>
<li><b>PERIODIC</b> <br>
 Set this if you want to have periodic boundary conditions.</li></ul>
<p>
<ul>
<li><b>UNEQUALSOFTENINGS</b> <br>
 Set this if you use particles with different gravitational softening lengths.</li></ul>
<p>
<br>
 <h2><a class="anchor" name="secmake2">
Things that are always recommended</a></h2>
<ul>
<li><b>PEANOHILBERT</b> <br>
 This is a tuning option. When set, the code will bring the particles into Peano-Hilbert order after each domain decomposition. This improves cache utilisation and performance.</li></ul>
<p>
<ul>
<li><b>WALLCLOCK</b> <br>
 If set, a wallclock timer is used by the code to measure internal time consumption (see cpu-log file). Otherwise, a timer that measures consumed processor ticks is used.</li></ul>
<p>
<br>
 <h2><a class="anchor" name="secmake3">
TreePM options</a></h2>
<ul>
<li><b>PMGRID=128</b> <br>
 This enables the TreePM method, i.e. the long-range force is computed with a PM-algorithm, and the short range force with the tree. The parameter has to be set to the size of the mesh that should be used, e.g.~64, 96, 128, etc. The mesh dimensions need not necessarily be a power of two, but the FFT is fastest for such a choice. Note: If the simulation is not in a periodic box, then a FFT method for vacuum boundaries is employed, using a mesh with dimension twice that specified by <b>PMGRID</b>.</li></ul>
<p>
<ul>
<li><b>PLACEHIGHRESREGION=1+8</b> <br>
 If this option is set (will only work together with <b>PMGRID</b>), then the long range force is computed in two stages: One Fourier-grid is used to cover the whole simulation volume, allowing the computation of the large-scale force. A second Fourier mesh is placed on the region occupied by `high-resolution' particles, allowing the computation of an intermediate-scale force. Finally, the force on very small scales is computed by the tree. This procedure can be useful for `zoom-simulations', where the majority of particles (the high-res particles) are occupying only a small fraction of the volume. To activate this option, the parameter needs to be set to an integer that encodes the particle types that make up the high-res particles in the form of a bit mask. For example, if types 0, 1, and 4 are the high-res particles, then the parameter should be set to <b>PLACEHIGHRESREGION=1+2+16</b>, i.e. to the sum <img class="formulaInl" alt="$2^0+2^1+2^4$" src="form_1.png">. The spatial region covered by the high-res grid is determined automatically from the initial conditions. Note: If a periodic box is used, the high-res zone is not allowed to intersect the box boundaries.</li></ul>
<p>
<ul>
<li><b> ENLARGEREGION=1.1</b> <br>
 The spatial region covered by the high-res zone normally has a fixed size during the simulation, which initially is set to the smallest region that encompasses all high-res particles. Normally, the simulation will be interrupted if high-res particles leave this region in the course of the run. However, by setting this parameter to a value larger than one, the high-res region can be expanded on the fly. For example, setting it to 1.4 will enlarge its side-length by 40% in such an event (it remains centred on the high-res particles). Hence, with such a setting, the high-res region may expand or move by a limited amount. If in addition <b>SYNCHRONIZATION</b> is activated, then the code will be able to continue even if high-res particles leave the initial high-res grid. In this case, the code will update the size and position of the grid that is placed onto the high-resolution region automatically. To prevent that this potentially happens every single PM step, one should nevertheless assign a value slightly larger than 1 to <b>ENLARGEREGION</b>.</li></ul>
<p>
<ul>
<li><b> ASMTH=1.25</b> <br>
 This can be used to override the value assumed for the scale that defines the long-range/short-range force-split in the TreePM algorithm. The default value is 1.25, in mesh-cells.</li></ul>
<p>
<ul>
<li><b> RCUT=4.5</b> <br>
 This can be used to override the maximum radius in which the short-range tree-force is evaluated (in case the TreePM algorithm is used). The default value is 4.5, given in mesh-cells.</li></ul>
<p>
<br>
 <h2><a class="anchor" name="secmake4">
Single or double precision</a></h2>
<ul>
<li><b>DOUBLEPRECISION</b> <br>
 This makes the code store and compute internal particle data in double precision. Note that output files are nevertheless written by converting the values that are saved to single precision.</li></ul>
<p>
<ul>
<li><b>DOUBLEPRECISION_FFTW</b> <br>
 If this is set, the code will use the double-precision version of FTTW, provided the latter has been explicitly installed with a "d" prefix, and NOTYPEPREFIX_FFTW is not set. Otherwise the single precision version ("s" prefix) is used.</li></ul>
<p>
<br>
 <h2><a class="anchor" name="secmake5">
Time integration options</a></h2>
<ul>
<li><b>SYNCHRONIZATION</b> <br>
 When this is set, particles may only increase their timestep if the new timestep will put them into synchronisation with the higher time level. This typically means that only on half of the timesteps of a particle an increase of its step may occur. Especially for TreePM runs, it is usually advisable to set this option.</li></ul>
<p>
<ul>
<li><b>FLEXSTEPS</b> <br>
 This is an alternative to SYNCHRONIZATION. Particle timesteps are here allowed to be integer multiples of the minimum timestep that occurs among the particles, which in turn is rounded down to the nearest power-of-two devision of the total simulated timespan. This option distributes particles more evenly over individual system timesteps, particularly once a simulation has run for a while, and may then result in a reduction of work-load imbalance losses.</li></ul>
<p>
<ul>
<li><b>PSEUDOSYMMETRIC</b> <br>
 When this option is set, the code will try to `anticipate' timestep changes by extrapolating the change of the acceleration into the future. This in general improves the long-term integration behaviour of periodic orbits, because then the adaptive integration becomes more akin to a strictly time reversible integrator. Note: This option has no effect if FLEXSTEPS is set.</li></ul>
<p>
<ul>
<li><b>NOSTOP_WHEN_BELOW_MINTIMESTEP</b> <br>
 If this is activated, the code will not terminate when the timestep falls below the value of <b>MinSizeTimestep</b> specified in the parameterfile. This is useful for runs where one wants to enforce a constant timestep for all particles. This can be done by activating this option, and by setting <b>MinSizeTimestep</b> and <b>MaxSizeTimestep</b> to an equal value.</li></ul>
<p>
<ul>
<li><b>NOPMSTEPADJUSTMENT</b> <br>
 When this is set, the long-range timestep for the PM force computation is always determined by <b>MaxSizeTimeStep</b>. Otherwise, it is set to the minimum of <b>MaxSizeTimeStep</b> and the timestep obtained for the maximum long-range force with an effective softening scale equal to the PM smoothing-scale.</li></ul>
<p>
<br>
 <h2><a class="anchor" name="secmake6">
Output options</a></h2>
<ul>
<li><b>HAVE_HDF5</b> <br>
 If this is set, the code will be compiled with support for input and output in the HDF5 format. You need to have the HDF5 libraries and headers installed on your computer for this option to work. The HDF5 format can then be selected as format "3" in Gadget's parameterfile.</li></ul>
<p>
<ul>
<li><b>OUTPUTPOTENTIAL</b> <br>
 This will force the code to compute gravitational potentials for all particles each time a snapshot file is generated. These values are then included in the snapshot files. Note that the computation of the values of the potential costs additional time.</li></ul>
<p>
<ul>
<li><b>OUTPUTACCELERATION</b> <br>
 This will include the physical acceleration of each particle in snapshot files.</li></ul>
<p>
<ul>
<li><b>OUTPUTCHANGEOFENTROPY</b> <br>
 This will include the rate of change of entropy of gas particles in snapshot files.</li></ul>
<p>
<ul>
<li><b>OUTPUTTIMESTEP</b> <br>
 This will include the timesteps actually taken by each particle in the snapshot files.</li></ul>
<p>
<br>
 <h2><a class="anchor" name="secmake7">
Things for special behaviour</a></h2>
<ul>
<li><b>NOGRAVITY</b> <br>
 This switches off gravity. Makes only sense for pure SPH simulations in non-expanding space.</li></ul>
<p>
<ul>
<li><b>NOTREERND</b> <br>
 If this is not set, the tree construction will succeed even when there are a few particles at identical locations. This is done by `rerouting' particles once the node-size has fallen below <img class="formulaInl" alt="$10^{-3}$" src="form_2.png"> of the softening length. When this option is activated, this will be suppressed and the tree construction will always fail if there are particles at extremely close or identical coordinates.</li></ul>
<p>
<ul>
<li><b>NOTYPEPREFIX_FFTW</b> <br>
 If this is set, the fftw-header/libraries are accessed without type prefix (adopting whatever was chosen as default at compile-time of fftw). Otherwise, the type prefix 'd' for double-precision is used.</li></ul>
<p>
<ul>
<li><b>LONG_X/Y/Z</b> <br>
 These options can be used together with PERIODIC and NOGRAVITY only. When set, the options define numerical factors that can be used to distort the periodic simulation cube into a parallelepiped of arbitrary aspect ratio. This can be useful for idealized SPH tests.</li></ul>
<p>
<ul>
<li><b>TWODIMS</b> <br>
 This effectively switches of one dimension in SPH, i.e. the code follows only 2d hydrodynamics in the xy-, yz-, or xz-plane. This only works with NOGRAVITY, and if all coordinates of the third axis are exactly equal. Can be useful for idealized SPH tests.</li></ul>
<p>
<ul>
<li><b>SPH_BND_PARTICLES</b> <br>
 If this is set, particles with a particle-ID equal to zero do not receive any SPH acceleration. This can be useful for idealized SPH tests, where these particles represent fixed "walls".</li></ul>
<p>
<ul>
<li><b>NOVISCOSITYLIMITER</b> <br>
 If this is set, there is no explicit upper limit on the viscosity. In the default version, this limiter will try to protect against possible particle `reflections', which could in principle occur if very poor timestepping is used in the presence of strong shocks.</li></ul>
<p>
<ul>
<li><b>COMPUTE_POTENTIAL_ENERGY</b> <br>
 When this option is set, the code will compute the gravitational potential energy each time a global statistics is computed. This can be useful for testing global energy conservation.</li></ul>
<p>
<ul>
<li><b>ISOTHERM_EQS</b> <br>
 This special option makes the gas behave like an isothermal gas with equation of state <img class="formulaInl" alt="$ P = c_s^2 \rho $" src="form_3.png">. The sound-speed <img class="formulaInl" alt="$ c_s $" src="form_4.png"> is set by the thermal energy per unit mass in the intial conditions, i.e. <img class="formulaInl" alt="$ c_s^2=u $" src="form_5.png">. If the value for <img class="formulaInl" alt="$ u $" src="form_6.png"> is zero, then the initial gas temperature in the parameter file is used to define the sound speed according to <img class="formulaInl" alt="$ c_s^2= k\,T/m_p $" src="form_14.png"> , where <img class="formulaInl" alt="$ m_p $" src="form_8.png"> is the proton mass.</li></ul>
<p>
<ul>
<li><b>ADAPTIVE_GRAVSOFT_FORGAS</b> <br>
 When this option is set, the gravitational softening lengths used for gas particles is tied to their SPH smoothing length. This can be useful for dissipative collapse simulations. The option requires the setting of UNEQUALSOFTENINGS.</li></ul>
<p>
<ul>
<li><b>SELECTIVE_NO_GRAVITY</b> <br>
 This can be used for special computations where one wants to exclude certain particle types from receiving gravitational forces. The particle types that are excluded in this fashion are specified by a bit mask, in the same as for the PLACEHIGHRESREGION option.</li></ul>
<p>
<ul>
<li><b>LONGIDS</b> <br>
 If this is set, the code assumes that particle-IDs are stored as 64-bit long integers. This is only really needed if you want to go beyond ~2 billion particles.</li></ul>
<p>
<br>
 <h2><a class="anchor" name="secmake8">
Testing and Debugging options</a></h2>
<ul>
<li><b>FORCETEST=0</b>.01 <br>
 This can be set to check the force accuracy of the code, and is only included as a debugging option. The option needs to be set to a number between 0 and 1 (e.g. 0.01), which specifies the fraction of randomly chosen particles for which at each timestep forces by direct summation are computed. The normal tree-forces and the `correct' direct summation forces are then collected in a file <b>forcetest.txt</b> for later inspection. Note that the simulation itself is unaffected by this option, but it will of course run much(!) slower, particularly if <b> FORCETEST*NumPart*NumPart&gt;&gt;NumPart</b> Note: Particle IDs must be set to numbers &gt;=1 for this option to work.</li></ul>
<p>
<br>
 <h2><a class="anchor" name="secmake9">
Glass making</a></h2>
<ul>
<li><b>MAKEGLASS=262144</b> <br>
 This option can be used to generate a glass-like particle configuration. The value assigned gives the particle load, which is initially generated as a Poisson sample and then evolved towards a glass with the sign of gravity reversed </li></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sat Apr 22 15:29:43 2006 for GADGET-2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
