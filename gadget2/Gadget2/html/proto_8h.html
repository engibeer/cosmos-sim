<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GADGET-2: proto.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>proto.h File Reference</h1>this file contains all function prototypes of the code <a href="#_details">More...</a>
<p>
<code>#include &lt;hdf5.h&gt;</code><br>
<code>#include "<a class="el" href="allvars_8h-source.html">allvars.h</a>"</code><br>

<p>
<a href="proto_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a0">advance_and_find_timesteps</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a1">allocate_commbuffers</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a2">allocate_memory</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a3">begrun</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a4">blockpresent</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a5">catch_abort</a> (int sig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a6">catch_fatal</a> (int sig)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a7">check_omega</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a8">close_outputfiles</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a9">compare_key</a> (const void *a, const void *b)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a10">compute_accelerations</a> (int mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a11">compute_global_quantities_of_system</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a12">compute_potential</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a13">dens_compare_key</a> (const void *a, const void *b)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a14">density</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a15">density_decouple</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a16">density_evaluate</a> (int i, int mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a17">distribute_file</a> (int nfiles, int firstfile, int firsttask, int lasttask, int *filenr, int *master, int *last)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a18">dmax</a> (double, double)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a19">dmin</a> (double, double)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a20">do_box_wrapping</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a21">domain_Decomposition</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a22">domain_compare_key</a> (const void *a, const void *b)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a23">domain_compare_toplist</a> (const void *a, const void *b)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a24">domain_countToGo</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a25">domain_decompose</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a26">domain_determineTopTree</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a27">domain_exchangeParticles</a> (int partner, int sphflag, int send_count, int recv_count)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a28">domain_findExchangeNumbers</a> (int task, int partner, int sphflag, int *send, int *recv)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a29">domain_findExtent</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a30">domain_findSplit</a> (int cpustart, int ncpu, int first, int last)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a31">domain_shiftSplit</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a32">domain_sumCost</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a33">domain_topsplit</a> (int node, <a class="el" href="allvars_8h.html#a45">peanokey</a> startkey)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a34">domain_topsplit_local</a> (int node, <a class="el" href="allvars_8h.html#a45">peanokey</a> startkey)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a35">drift_integ</a> (double a, void *param)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a36">dump_particles</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a37">empty_read_buffer</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr, int offset, int pc, int type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a38">endrun</a> (int)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a39">energy_statistics</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a40">every_timestep_stuff</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a41">ewald_corr</a> (double dx, double dy, double dz, double *fper)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a42">ewald_force</a> (int ii, int jj, int kk, double x[3], double force[3])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a43">ewald_init</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a44">ewald_pot_corr</a> (double dx, double dy, double dz)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a45">ewald_psi</a> (double x[3])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a46">fill_Tab_IO_Labels</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a47">fill_write_buffer</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr, int *pindex, int pc, int type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a48">find_dt_displacement_constraint</a> (double hfac)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a49">find_files</a> (char *fname)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a50">find_next_outputtime</a> (int time)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a51">find_next_sync_point_and_drift</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a52">force_create_empty_nodes</a> (int no, int topnode, int bits, int x, int y, int z, int *nodecount, int *nextfree)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a53">force_exchange_pseudodata</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a54">force_flag_localnodes</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a55">force_insert_pseudo_particles</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a56">force_setupnonrecursive</a> (int no)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a57">force_treeallocate</a> (int maxnodes, int maxpart)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a58">force_treebuild</a> (int npart)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a59">force_treebuild_single</a> (int npart)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a60">force_treeevaluate</a> (int target, int mode, double *ewaldcountsum)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a61">force_treeevaluate_direct</a> (int target, int mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a62">force_treeevaluate_ewald_correction</a> (int target, int mode, double pos_x, double pos_y, double pos_z, double aold)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a63">force_treeevaluate_potential</a> (int target, int type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a64">force_treeevaluate_potential_shortrange</a> (int target, int mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a65">force_treeevaluate_shortrange</a> (int target, int mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a66">force_treefree</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a67">force_treeupdate_pseudos</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a68">force_update_hmax</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a69">force_update_len</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a70">force_update_node</a> (int no, int flag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a71">force_update_node_hmax_local</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a72">force_update_node_hmax_toptree</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a73">force_update_node_len_local</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a74">force_update_node_len_toptree</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a75">force_update_node_recursive</a> (int no, int sib, int father)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a76">force_update_pseudoparticles</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a77">force_update_size_of_parent_node</a> (int no)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a78">free_memory</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a79">get_bytes_per_blockelement</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a80">get_dataset_name</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr, char *buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a81">get_datatype_in_block</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a82">get_drift_factor</a> (int time0, int time1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a83">get_gravkick_factor</a> (int time0, int time1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a84">get_hydrokick_factor</a> (int time0, int time1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a85">get_particles_in_block</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr, int *typelist)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a86">get_random_number</a> (int id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a87">get_timestep</a> (int p, double *a, int flag)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a88">get_values_per_blockelement</a> (enum <a class="el" href="allvars_8h.html#a136">iofields</a> blocknr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a89">grav_tree_compare_key</a> (const void *a, const void *b)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a90">gravity_forcetest</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a91">gravity_tree</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a92">gravity_tree_shortrange</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a93">gravkick_integ</a> (double a, void *param)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a94">hydro_compare_key</a> (const void *a, const void *b)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a95">hydro_evaluate</a> (int target, int mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a96">hydro_force</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a97">hydrokick_integ</a> (double a, void *param)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a98">imax</a> (int, int)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a99">imin</a> (int, int)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a100">init</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a101">init_drift_table</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a102">init_peano_map</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a103">long_range_force</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a104">long_range_init</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a105">long_range_init_regionsize</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a106">move_particles</a> (int time0, int time1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a107">my_fread</a> (void *ptr, size_t size, size_t nmemb, FILE *stream)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a108">my_fwrite</a> (void *ptr, size_t size, size_t nmemb, FILE *stream)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a109">ngb_clear_buf</a> (float searchcenter[3], float hguess, int numngb)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a110">ngb_treeallocate</a> (int npart)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a111">ngb_treebuild</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a112">ngb_treefind_pairs</a> (float searchcenter[3], float hsml, int *startnode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a113">ngb_treefind_variable</a> (float searchcenter[3], float hguess, int *startnode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a114">ngb_treefree</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a115">ngb_treesearch</a> (int)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a116">ngb_treesearch_pairs</a> (int)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a117">ngb_update_nodes</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a118">open_outputfiles</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="allvars_8h.html#a45">peanokey</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a119">peano_hilbert_key</a> (int x, int y, int z, int bits)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a120">peano_hilbert_order</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a121">pm_init_nonperiodic</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a122">pm_init_nonperiodic_allocate</a> (int dimprod)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a123">pm_init_nonperiodic_free</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a124">pm_init_periodic</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a125">pm_init_periodic_allocate</a> (int dimprod)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a126">pm_init_periodic_free</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a127">pm_init_regionsize</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a128">pm_setup_nonperiodic_kernel</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a129">pmforce_nonperiodic</a> (int grnr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a130">pmforce_periodic</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a131">pmpotential_nonperiodic</a> (int grnr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a132">pmpotential_periodic</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a133">pow</a> (double, double)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a134">read_file</a> (char *fname, int readTask, int lastTask)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a135">read_header_attributes_in_hdf5</a> (char *fname)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a136">read_ic</a> (char *fname)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a137">read_outputlist</a> (char *fname)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a138">read_parameter_file</a> (char *fname)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a139">readjust_timebase</a> (double TimeMax_old, double TimeMax_new)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a140">reorder_gas</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a141">reorder_particles</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a142">restart</a> (int mod)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a143">run</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a144">savepositions</a> (int num)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a145">second</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a146">seed_glass</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a147">set_random_numbers</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a148">set_softenings</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a149">set_units</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a150">setup_smoothinglengths</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a151">statistics</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a152">terminate_processes</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a153">timediff</a> (double t0, double t1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a154">write_header_attributes_in_hdf5</a> (hid_t handle)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a155">write_file</a> (char *fname, int readTask, int lastTask)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="proto_8h.html#a156">write_pid_file</a> (void)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
this file contains all function prototypes of the code 
<p>

<p>
Definition in file <a class="el" href="proto_8h-source.html">proto.h</a>.<hr><h2>Function Documentation</h2>
<a class="anchor" name="a0" doxytag="proto.h::advance_and_find_timesteps"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void advance_and_find_timesteps           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function advances the system in momentum space, i.e. it does apply the 'kick' operation after the forces have been computed. Additionally, it assigns new timesteps to particles. At start-up, a half-timestep is carried out, as well as at the end of the simulation. In between, the half-step kick that ends the previous timestep and the half-step kick for the new timestep are combined into one operation.<p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 <p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 <p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 <p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 <p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 <p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 
<p>
Definition at line <a class="el" href="timestep_8c-source.html#l00024">24</a> of file <a class="el" href="timestep_8c-source.html">timestep.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00402">global_data_all_processes::CPU_TimeLine</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8h-source.html#l00542">sph_particle_data::DtEntropy</a>, <a class="el" href="allvars_8h-source.html#l00535">sph_particle_data::Entropy</a>, <a class="el" href="allvars_8c-source.html#l00151">Extnodes</a>, <a class="el" href="allvars_8c-source.html#l00148">Father</a>, <a class="el" href="allvars_8h-source.html#l00582">NODE::father</a>, <a class="el" href="timestep_8c-source.html#l00582">find_dt_displacement_constraint()</a>, <a class="el" href="allvars_8c-source.html#l00036">Flag_FullStep</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00302">global_data_all_processes::G</a>, <a class="el" href="allvars_8h-source.html#l00052">GAMMA</a>, <a class="el" href="allvars_8h-source.html#l00055">GAMMA_MINUS1</a>, <a class="el" href="driftfac_8c-source.html#l00105">get_gravkick_factor()</a>, <a class="el" href="driftfac_8c-source.html#l00142">get_hydrokick_factor()</a>, <a class="el" href="system_8c-source.html#l00029">get_random_number()</a>, <a class="el" href="timestep_8c-source.html#l00437">get_timestep()</a>, <a class="el" href="allvars_8h-source.html#l00497">particle_data::GravAccel</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00543">sph_particle_data::HydroAccel</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00578">NODE::mass</a>, <a class="el" href="allvars_8h-source.html#l00419">global_data_all_processes::MaxSizeTimestep</a>, <a class="el" href="allvars_8h-source.html#l00291">global_data_all_processes::MinEgySpec</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8h-source.html#l00297">global_data_all_processes::NumForcesSinceLastDomainDecomp</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00367">global_data_all_processes::PM_Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00366">global_data_all_processes::PM_Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="allvars_8h-source.html#l00025">TIMEBASE</a>, <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, <a class="el" href="structNODE.html#o10">NODE::u</a>, <a class="el" href="allvars_8h-source.html#l00496">particle_data::Vel</a>, <a class="el" href="allvars_8h-source.html#l00544">sph_particle_data::VelPred</a>, and <a class="el" href="allvars_8h-source.html#l00600">extNODE::vs</a>.
<p>
Referenced by <a class="el" href="run_8c-source.html#l00020">run()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="proto.h::allocate_commbuffers"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void allocate_commbuffers           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocates a number of small buffers and arrays, the largest one being the communication buffer. The communication buffer itself is mapped onto various tables used in the different parts of the force algorithms. We further allocate space for the top-level tree nodes, and auxiliary arrays for the domain decomposition algorithm.<p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition 
<p>
Definition at line <a class="el" href="allocate_8c-source.html#l00019">19</a> of file <a class="el" href="allocate_8c-source.html">allocate.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00269">global_data_all_processes::BufferSize</a>, <a class="el" href="allvars_8h-source.html#l00271">global_data_all_processes::BunchSizeDensity</a>, <a class="el" href="allvars_8h-source.html#l00273">global_data_all_processes::BunchSizeDomain</a>, <a class="el" href="allvars_8h-source.html#l00270">global_data_all_processes::BunchSizeForce</a>, <a class="el" href="allvars_8h-source.html#l00272">global_data_all_processes::BunchSizeHydro</a>, <a class="el" href="allvars_8c-source.html#l00101">CommBuffer</a>, <a class="el" href="allvars_8c-source.html#l00191">DensDataGet</a>, <a class="el" href="allvars_8c-source.html#l00191">DensDataIn</a>, <a class="el" href="allvars_8c-source.html#l00195">DensDataPartialResult</a>, <a class="el" href="allvars_8c-source.html#l00195">DensDataResult</a>, <a class="el" href="allvars_8c-source.html#l00055">DomainCount</a>, <a class="el" href="allvars_8c-source.html#l00056">DomainCountSph</a>, <a class="el" href="allvars_8c-source.html#l00053">DomainEndList</a>, <a class="el" href="allvars_8c-source.html#l00061">DomainHmax</a>, <a class="el" href="allvars_8c-source.html#l00066">DomainKeyBuf</a>, <a class="el" href="allvars_8c-source.html#l00063">DomainMoment</a>, <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, <a class="el" href="allvars_8c-source.html#l00119">DomainPartBuf</a>, <a class="el" href="allvars_8c-source.html#l00127">DomainSphBuf</a>, <a class="el" href="allvars_8c-source.html#l00052">DomainStartList</a>, <a class="el" href="allvars_8c-source.html#l00058">DomainTask</a>, <a class="el" href="allvars_8c-source.html#l00060">DomainTreeNodeLen</a>, <a class="el" href="allvars_8c-source.html#l00054">DomainWork</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00030">Exportflag</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataGet</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataIn</a>, <a class="el" href="allvars_8c-source.html#l00186">GravDataIndexTable</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataOut</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataResult</a>, <a class="el" href="allvars_8c-source.html#l00201">HydroDataGet</a>, <a class="el" href="allvars_8c-source.html#l00201">HydroDataIn</a>, <a class="el" href="allvars_8c-source.html#l00205">HydroDataPartialResult</a>, <a class="el" href="allvars_8c-source.html#l00205">HydroDataResult</a>, <a class="el" href="allvars_8h-source.html#l00029">MAXTOPNODES</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00032">peanokey</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, and <a class="el" href="allvars_8c-source.html#l00075">TopNodes</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="proto.h::allocate_memory"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void allocate_memory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine allocates memory for particle storage, both the collisionless and the SPH particles. 
<p>
Definition at line <a class="el" href="allocate_8c-source.html#l00103">103</a> of file <a class="el" href="allocate_8c-source.html">allocate.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00257">global_data_all_processes::MaxPartSph</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="restart_8c-source.html#l00035">restart()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="proto.h::begrun"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void begrun           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function performs the initial set-up of the simulation. First, the parameterfile is set, then routines for setting units, reading ICs/restart-files are called, auxialiary memory is allocated, etc.<p>
&lt; code version string 
<p>
Definition at line <a class="el" href="begrun_8c-source.html#l00028">28</a> of file <a class="el" href="begrun_8c-source.html">begrun.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allocate_8c-source.html#l00019">allocate_commbuffers()</a>, <a class="el" href="allvars_8h-source.html#l00288">global_data_all_processes::ArtBulkViscConst</a>, <a class="el" href="allvars_8h-source.html#l00269">global_data_all_processes::BufferSize</a>, <a class="el" href="allvars_8h-source.html#l00271">global_data_all_processes::BunchSizeDensity</a>, <a class="el" href="allvars_8h-source.html#l00273">global_data_all_processes::BunchSizeDomain</a>, <a class="el" href="allvars_8h-source.html#l00270">global_data_all_processes::BunchSizeForce</a>, <a class="el" href="allvars_8h-source.html#l00272">global_data_all_processes::BunchSizeHydro</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00428">global_data_all_processes::CourantFac</a>, <a class="el" href="allvars_8h-source.html#l00474">global_data_all_processes::CpuFile</a>, <a class="el" href="allvars_8h-source.html#l00341">global_data_all_processes::CpuTimeBetRestartFile</a>, <a class="el" href="allvars_8h-source.html#l00473">global_data_all_processes::EnergyFile</a>, <a class="el" href="allvars_8h-source.html#l00409">global_data_all_processes::ErrTolForceAcc</a>, <a class="el" href="allvars_8h-source.html#l00414">global_data_all_processes::ErrTolIntAccuracy</a>, <a class="el" href="forcetree_8c-source.html#l02874">ewald_init()</a>, <a class="el" href="run_8c-source.html#l00246">find_next_outputtime()</a>, <a class="el" href="allvars_8h-source.html#l00023">GADGETVERSION</a>, <a class="el" href="allvars_8h-source.html#l00475">global_data_all_processes::InfoFile</a>, <a class="el" href="init_8c-source.html#l00020">init()</a>, <a class="el" href="driftfac_8c-source.html#l00026">init_drift_table()</a>, <a class="el" href="longrange_8c-source.html#l00020">long_range_init()</a>, <a class="el" href="longrange_8c-source.html#l00036">long_range_init_regionsize()</a>, <a class="el" href="allvars_8h-source.html#l00286">global_data_all_processes::MaxNumNgbDeviation</a>, <a class="el" href="allvars_8h-source.html#l00421">global_data_all_processes::MaxRMSDisplacementFac</a>, <a class="el" href="allvars_8h-source.html#l00419">global_data_all_processes::MaxSizeTimestep</a>, <a class="el" href="allvars_8h-source.html#l00417">global_data_all_processes::MinSizeTimestep</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00265">global_data_all_processes::NumFilesPerSnapshot</a>, <a class="el" href="allvars_8h-source.html#l00266">global_data_all_processes::NumFilesWrittenInParallel</a>, <a class="el" href="begrun_8c-source.html#l00199">open_outputfiles()</a>, <a class="el" href="allvars_8h-source.html#l00471">global_data_all_processes::OutputDir</a>, <a class="el" href="allvars_8h-source.html#l00479">global_data_all_processes::OutputListFilename</a>, <a class="el" href="allvars_8h-source.html#l00482">global_data_all_processes::OutputListLength</a>, <a class="el" href="allvars_8h-source.html#l00333">global_data_all_processes::OutputListOn</a>, <a class="el" href="allvars_8h-source.html#l00481">global_data_all_processes::OutputListTimes</a>, <a class="el" href="allvars_8c-source.html#l00085">ParameterFile</a>, <a class="el" href="allvars_8c-source.html#l00039">random_generator</a>, <a class="el" href="begrun_8c-source.html#l00280">read_parameter_file()</a>, <a class="el" href="begrun_8c-source.html#l00793">readjust_timebase()</a>, <a class="el" href="restart_8c-source.html#l00035">restart()</a>, <a class="el" href="allvars_8h-source.html#l00477">global_data_all_processes::RestartFile</a>, <a class="el" href="allvars_8c-source.html#l00026">RestartFlag</a>, <a class="el" href="allvars_8h-source.html#l00478">global_data_all_processes::ResubmitCommand</a>, <a class="el" href="allvars_8h-source.html#l00330">global_data_all_processes::ResubmitOn</a>, <a class="el" href="system_8c-source.html#l00039">set_random_numbers()</a>, <a class="el" href="begrun_8c-source.html#l00149">set_units()</a>, <a class="el" href="allvars_8h-source.html#l00263">global_data_all_processes::SnapFormat</a>, <a class="el" href="allvars_8h-source.html#l00472">global_data_all_processes::SnapshotFileBase</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00360">global_data_all_processes::Ti_nextoutput</a>, <a class="el" href="allvars_8h-source.html#l00339">global_data_all_processes::TimeBetSnapshot</a>, <a class="el" href="allvars_8h-source.html#l00343">global_data_all_processes::TimeBetStatistics</a>, <a class="el" href="allvars_8h-source.html#l00342">global_data_all_processes::TimeLastRestartFile</a>, <a class="el" href="allvars_8h-source.html#l00386">global_data_all_processes::TimeLimitCPU</a>, <a class="el" href="allvars_8h-source.html#l00353">global_data_all_processes::TimeMax</a>, <a class="el" href="allvars_8h-source.html#l00476">global_data_all_processes::TimingsFile</a>, <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>, <a class="el" href="allvars_8h-source.html#l00331">global_data_all_processes::TypeOfOpeningCriterion</a>, and <a class="el" href="allvars_8h-source.html#l00332">global_data_all_processes::TypeOfTimestepCriterion</a>.
<p>
Referenced by <a class="el" href="main_8c-source.html#l00022">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="proto.h::blockpresent"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int blockpresent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>blocknr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function tells whether or not a given block in the output file is present, depending on the type of simulation run and the compile-time options. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00532">532</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="proto.h::catch_abort"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void catch_abort           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sig</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="proto.h::catch_fatal"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void catch_fatal           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sig</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="proto.h::check_omega"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void check_omega           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine computes the mass content of the box and compares it to the specified value of Omega-matter. If discrepant, the run is terminated. 
<p>
Definition at line <a class="el" href="init_8c-source.html#l00165">165</a> of file <a class="el" href="init_8c-source.html">init.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="init_8c-source.html#l00020">init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="proto.h::close_outputfiles"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void close_outputfiles           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function closes the global log-files. 
<p>
Definition at line <a class="el" href="begrun_8c-source.html#l00257">257</a> of file <a class="el" href="begrun_8c-source.html">begrun.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00090">FdCPU</a>, <a class="el" href="allvars_8c-source.html#l00088">FdEnergy</a>, <a class="el" href="allvars_8c-source.html#l00093">FdForceTest</a>, <a class="el" href="allvars_8c-source.html#l00087">FdInfo</a>, <a class="el" href="allvars_8c-source.html#l00089">FdTimings</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="run_8c-source.html#l00020">run()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="proto.h::compare_key"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int compare_key           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>b</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is a comparison kernel for sorting the Peano-Hilbert keys. 
<p>
Definition at line <a class="el" href="peano_8c-source.html#l00098">98</a> of file <a class="el" href="peano_8c-source.html">peano.c</a>.
<p>
Referenced by <a class="el" href="peano_8c-source.html#l00034">peano_hilbert_order()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="proto.h::compute_accelerations"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void compute_accelerations           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>mode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine computes the accelerations for all active particles. First, the long-range PM force is computed if the TreePM algorithm is used and a "big" PM step is done. Next, the gravitational tree forces are computed. This also constructs the tree, if needed.<p>
If gas particles are present, the density-loop for active SPH particles is carried out. This includes an iteration on the correct number of neighbours. Finally, the hydrodynamical forces are added. 
<p>
Definition at line <a class="el" href="accel_8c-source.html#l00024">24</a> of file <a class="el" href="accel_8c-source.html">accel.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00389">global_data_all_processes::CPU_Gravity</a>, <a class="el" href="allvars_8h-source.html#l00399">global_data_all_processes::CPU_Hydro</a>, <a class="el" href="allvars_8h-source.html#l00403">global_data_all_processes::CPU_PM</a>, <a class="el" href="allvars_8h-source.html#l00401">global_data_all_processes::CPU_Predict</a>, <a class="el" href="density_8c-source.html#l00056">density()</a>, <a class="el" href="forcetree_8c-source.html#l01016">force_update_hmax()</a>, <a class="el" href="gravtree__forcetest_8c-source.html#l00028">gravity_forcetest()</a>, <a class="el" href="gravtree_8c-source.html#l00027">gravity_tree()</a>, <a class="el" href="hydra_8c-source.html#l00050">hydro_force()</a>, <a class="el" href="longrange_8c-source.html#l00056">long_range_force()</a>, <a class="el" href="allvars_8h-source.html#l00366">global_data_all_processes::PM_Ti_endstep</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8h-source.html#l00254">global_data_all_processes::TotN_gas</a>, and <a class="el" href="allvars_8h-source.html#l00331">global_data_all_processes::TypeOfOpeningCriterion</a>.
<p>
Referenced by <a class="el" href="run_8c-source.html#l00020">run()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="proto.h::compute_global_quantities_of_system"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void compute_global_quantities_of_system           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine computes various global properties of the particle distribution and stores the result in the struct `SysState'. Currently, not all the information that's computed here is actually used (e.g. momentum is not really used anywhere), just the energies are written to a log-file every once in a while.<p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="global_8c-source.html#l00022">22</a> of file <a class="el" href="global_8c-source.html">global.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00670">state_of_system::AngMomentum</a>, <a class="el" href="allvars_8h-source.html#l00678">state_of_system::AngMomentumComp</a>, <a class="el" href="allvars_8h-source.html#l00671">state_of_system::CenterOfMass</a>, <a class="el" href="allvars_8h-source.html#l00679">state_of_system::CenterOfMassComp</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00542">sph_particle_data::DtEntropy</a>, <a class="el" href="allvars_8h-source.html#l00667">state_of_system::EnergyInt</a>, <a class="el" href="allvars_8h-source.html#l00675">state_of_system::EnergyIntComp</a>, <a class="el" href="allvars_8h-source.html#l00665">state_of_system::EnergyKin</a>, <a class="el" href="allvars_8h-source.html#l00673">state_of_system::EnergyKinComp</a>, <a class="el" href="allvars_8h-source.html#l00666">state_of_system::EnergyPot</a>, <a class="el" href="allvars_8h-source.html#l00674">state_of_system::EnergyPotComp</a>, <a class="el" href="allvars_8h-source.html#l00668">state_of_system::EnergyTot</a>, <a class="el" href="allvars_8h-source.html#l00676">state_of_system::EnergyTotComp</a>, <a class="el" href="allvars_8h-source.html#l00535">sph_particle_data::Entropy</a>, <a class="el" href="allvars_8h-source.html#l00055">GAMMA_MINUS1</a>, <a class="el" href="driftfac_8c-source.html#l00105">get_gravkick_factor()</a>, <a class="el" href="driftfac_8c-source.html#l00142">get_hydrokick_factor()</a>, <a class="el" href="allvars_8h-source.html#l00497">particle_data::GravAccel</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8h-source.html#l00543">sph_particle_data::HydroAccel</a>, <a class="el" href="allvars_8h-source.html#l00664">state_of_system::Mass</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00672">state_of_system::MassComp</a>, <a class="el" href="allvars_8h-source.html#l00669">state_of_system::Momentum</a>, <a class="el" href="allvars_8h-source.html#l00677">state_of_system::MomentumComp</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00367">global_data_all_processes::PM_Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00366">global_data_all_processes::PM_Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00504">particle_data::Potential</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8c-source.html#l00173">SysState</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, and <a class="el" href="allvars_8h-source.html#l00496">particle_data::Vel</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="proto.h::compute_potential"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void compute_potential           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function computes the gravitational potential for ALL the particles. First, the (short-range) tree potential is computed, and then, if needed, the long range PM potential is added. 
<p>
Definition at line <a class="el" href="potential_8c-source.html#l00022">22</a> of file <a class="el" href="potential_8c-source.html">potential.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00270">global_data_all_processes::BunchSizeForce</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00390">global_data_all_processes::CPU_Potential</a>, <a class="el" href="allvars_8h-source.html#l00387">global_data_all_processes::CPU_TreeConstruction</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00030">Exportflag</a>, <a class="el" href="forcetree_8c-source.html#l00061">force_treebuild()</a>, <a class="el" href="forcetree_8c-source.html#l02043">force_treeevaluate_potential()</a>, <a class="el" href="forcetree_8c-source.html#l02304">force_treeevaluate_potential_shortrange()</a>, <a class="el" href="allvars_8h-source.html#l00302">global_data_all_processes::G</a>, <a class="el" href="gravtree_8c-source.html#l00511">grav_tree_compare_key()</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataGet</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataIn</a>, <a class="el" href="allvars_8c-source.html#l00186">GravDataIndexTable</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataOut</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataResult</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00717">gravdata_index::Index</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8c-source.html#l00015">NumPart</a>, <a class="el" href="allvars_8h-source.html#l00505">particle_data::OldAcc</a>, <a class="el" href="allvars_8h-source.html#l00704">gravdata_in::OldAcc</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00329">global_data_all_processes::PeriodicBoundariesOn</a>, <a class="el" href="proto_8h.html#a127">pm_init_regionsize()</a>, <a class="el" href="proto_8h.html#a128">pm_setup_nonperiodic_kernel()</a>, <a class="el" href="proto_8h.html#a131">pmpotential_nonperiodic()</a>, <a class="el" href="pm__periodic_8c-source.html#l00694">pmpotential_periodic()</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00691">gravdata_in::Pos</a>, <a class="el" href="allvars_8h-source.html#l00693">gravdata_in::Potential</a>, <a class="el" href="allvars_8h-source.html#l00504">particle_data::Potential</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="gravtree_8c-source.html#l00454">set_softenings()</a>, <a class="el" href="allvars_8h-source.html#l00458">global_data_all_processes::SofteningTable</a>, <a class="el" href="allvars_8h-source.html#l00718">gravdata_index::SortIndex</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="tags_8h-source.html#l00028">TAG_POTENTIAL_A</a>, <a class="el" href="tags_8h-source.html#l00029">TAG_POTENTIAL_B</a>, <a class="el" href="allvars_8h-source.html#l00716">gravdata_index::Task</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8c-source.html#l00034">TreeReconstructFlag</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, <a class="el" href="structgravdata__in.html#o3">gravdata_in::u</a>, and <a class="el" href="structgravdata__in.html#o6">gravdata_in::w</a>.
<p>
Referenced by <a class="el" href="run_8c-source.html#l00020">run()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="proto.h::dens_compare_key"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int dens_compare_key           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>b</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine is a comparison kernel used in a sort routine to group particles that are exported to the same processor. 
<p>
Definition at line <a class="el" href="density_8c-source.html#l00607">607</a> of file <a class="el" href="density_8c-source.html">density.c</a>.
<p>
Referenced by <a class="el" href="density_8c-source.html#l00056">density()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="proto.h::density"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void density           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function computes the local density for each active SPH particle, the number of neighbours in the current smoothing radius, and the divergence and curl of the velocity field. The pressure is updated as well. If a particle with its smoothing region is fully inside the local domain, it is not exported to the other processors. The function also detects particles that have a number of neighbours outside the allowed tolerance range. For these particles, the smoothing length is adjusted accordingly, and the density computation is executed again. Note that the smoothing length is not allowed to fall below the lower bound set by MinGasHsml.<p>
&lt; For 3D-normalized kernel <p>
&lt; adiabatic index of simulated gas <p>
&lt; maxmimum number of steps for SPH neighbour iteration <p>
&lt; For 3D-normalized kernel <p>
&lt; For 3D-normalized kernel <p>
&lt; maxmimum number of steps for SPH neighbour iteration 
<p>
Definition at line <a class="el" href="density_8c-source.html#l00056">56</a> of file <a class="el" href="density_8c-source.html">density.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="density_8c-source.html#l00028">boxHalf_X</a>, <a class="el" href="density_8c-source.html#l00034">boxHalf_Y</a>, <a class="el" href="density_8c-source.html#l00040">boxHalf_Z</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="density_8c-source.html#l00027">boxSize_X</a>, <a class="el" href="density_8c-source.html#l00033">boxSize_Y</a>, <a class="el" href="density_8c-source.html#l00039">boxSize_Z</a>, <a class="el" href="allvars_8h-source.html#l00271">global_data_all_processes::BunchSizeDensity</a>, <a class="el" href="allvars_8h-source.html#l00400">global_data_all_processes::CPU_EnsureNgb</a>, <a class="el" href="allvars_8h-source.html#l00397">global_data_all_processes::CPU_HydCommSumm</a>, <a class="el" href="allvars_8h-source.html#l00396">global_data_all_processes::CPU_HydCompWalk</a>, <a class="el" href="allvars_8h-source.html#l00398">global_data_all_processes::CPU_HydImbalance</a>, <a class="el" href="allvars_8h-source.html#l00546">sph_particle_data::CurlVel</a>, <a class="el" href="density_8c-source.html#l00607">dens_compare_key()</a>, <a class="el" href="allvars_8c-source.html#l00191">DensDataGet</a>, <a class="el" href="allvars_8c-source.html#l00191">DensDataIn</a>, <a class="el" href="allvars_8c-source.html#l00195">DensDataPartialResult</a>, <a class="el" href="allvars_8c-source.html#l00195">DensDataResult</a>, <a class="el" href="allvars_8h-source.html#l00536">sph_particle_data::Density</a>, <a class="el" href="density_8c-source.html#l00467">density_evaluate()</a>, <a class="el" href="allvars_8h-source.html#l00285">global_data_all_processes::DesNumNgb</a>, <a class="el" href="allvars_8h-source.html#l00739">densdata_out::DhsmlDensity</a>, <a class="el" href="allvars_8h-source.html#l00548">sph_particle_data::DhsmlDensityFactor</a>, <a class="el" href="allvars_8h-source.html#l00738">densdata_out::Div</a>, <a class="el" href="allvars_8h-source.html#l00545">sph_particle_data::DivVel</a>, <a class="el" href="system_8c-source.html#l00095">dmax()</a>, <a class="el" href="allvars_8h-source.html#l00542">sph_particle_data::DtEntropy</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8h-source.html#l00535">sph_particle_data::Entropy</a>, <a class="el" href="allvars_8c-source.html#l00030">Exportflag</a>, <a class="el" href="allvars_8h-source.html#l00052">GAMMA</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00728">densdata_in::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00507">particle_data::ID</a>, <a class="el" href="allvars_8h-source.html#l00729">densdata_in::Index</a>, <a class="el" href="allvars_8h-source.html#l00538">sph_particle_data::Left</a>, <a class="el" href="allvars_8h-source.html#l00097">MAXITER</a>, <a class="el" href="allvars_8h-source.html#l00286">global_data_all_processes::MaxNumNgbDeviation</a>, <a class="el" href="allvars_8h-source.html#l00441">global_data_all_processes::MinGasHsml</a>, <a class="el" href="allvars_8c-source.html#l00016">N_gas</a>, <a class="el" href="allvars_8h-source.html#l00740">densdata_out::Ngb</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00108">NUMDIMS</a>, <a class="el" href="allvars_8h-source.html#l00540">sph_particle_data::NumNgb</a>, <a class="el" href="allvars_8c-source.html#l00021">NumSphUpdate</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00726">densdata_in::Pos</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="allvars_8h-source.html#l00541">sph_particle_data::Pressure</a>, <a class="el" href="allvars_8h-source.html#l00737">densdata_out::Rho</a>, <a class="el" href="allvars_8h-source.html#l00539">sph_particle_data::Right</a>, <a class="el" href="allvars_8h-source.html#l00738">densdata_out::Rot</a>, <a class="el" href="allvars_8h-source.html#l00547">sph_particle_data::Rot</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="tags_8h-source.html#l00030">TAG_DENS_A</a>, <a class="el" href="tags_8h-source.html#l00031">TAG_DENS_B</a>, <a class="el" href="allvars_8h-source.html#l00730">densdata_in::Task</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, <a class="el" href="allvars_8h-source.html#l00727">densdata_in::Vel</a>, and <a class="el" href="allvars_8h-source.html#l00544">sph_particle_data::VelPred</a>.
<p>
Referenced by <a class="el" href="accel_8c-source.html#l00024">compute_accelerations()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="proto.h::density_decouple"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void density_decouple           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="proto.h::density_evaluate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void density_evaluate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function represents the core of the SPH density computation. The target particle may either be local, or reside in the communication buffer.<p>
&lt; Coefficients for SPH spline kernel and its derivative <p>
&lt; Coefficient for kernel normalization. Note: 4.0/3 * PI = 4.188790204786 <p>
&lt; For 3D-normalized kernel 
<p>
Definition at line <a class="el" href="density_8c-source.html#l00467">467</a> of file <a class="el" href="density_8c-source.html">density.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8c-source.html#l00191">DensDataGet</a>, <a class="el" href="allvars_8c-source.html#l00195">DensDataResult</a>, <a class="el" href="allvars_8h-source.html#l00536">sph_particle_data::Density</a>, <a class="el" href="allvars_8h-source.html#l00739">densdata_out::DhsmlDensity</a>, <a class="el" href="allvars_8h-source.html#l00548">sph_particle_data::DhsmlDensityFactor</a>, <a class="el" href="allvars_8h-source.html#l00738">densdata_out::Div</a>, <a class="el" href="allvars_8h-source.html#l00545">sph_particle_data::DivVel</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00728">densdata_in::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00109">KERNEL_COEFF_1</a>, <a class="el" href="allvars_8h-source.html#l00110">KERNEL_COEFF_2</a>, <a class="el" href="allvars_8h-source.html#l00111">KERNEL_COEFF_3</a>, <a class="el" href="allvars_8h-source.html#l00113">KERNEL_COEFF_5</a>, <a class="el" href="allvars_8h-source.html#l00114">KERNEL_COEFF_6</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00740">densdata_out::Ngb</a>, <a class="el" href="ngb_8c-source.html#l00194">ngb_treefind_variable()</a>, <a class="el" href="allvars_8c-source.html#l00032">Ngblist</a>, <a class="el" href="allvars_8h-source.html#l00115">NORM_COEFF</a>, <a class="el" href="allvars_8h-source.html#l00108">NUMDIMS</a>, <a class="el" href="allvars_8h-source.html#l00540">sph_particle_data::NumNgb</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00726">densdata_in::Pos</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00737">densdata_out::Rho</a>, <a class="el" href="allvars_8h-source.html#l00738">densdata_out::Rot</a>, <a class="el" href="allvars_8h-source.html#l00547">sph_particle_data::Rot</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8h-source.html#l00727">densdata_in::Vel</a>, and <a class="el" href="allvars_8h-source.html#l00544">sph_particle_data::VelPred</a>.
<p>
Referenced by <a class="el" href="density_8c-source.html#l00056">density()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="proto.h::distribute_file"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void distribute_file           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>nfiles</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>firstfile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>firsttask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>lasttask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>filenr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>last</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function assigns a certain number of files to processors, such that each processor is exactly assigned to one file, and the number of cpus per file is as homogenous as possible. The number of files may at most be equal to the number of processors. 
<p>
Definition at line <a class="el" href="read__ic_8c-source.html#l00725">725</a> of file <a class="el" href="read__ic_8c-source.html">read_ic.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00031">read_ic()</a>, and <a class="el" href="io_8c-source.html#l00033">savepositions()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="proto.h::dmax"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double dmax           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns the maximum of two double 
<p>
Definition at line <a class="el" href="system_8c-source.html#l00095">95</a> of file <a class="el" href="system_8c-source.html">system.c</a>.
<p>
Referenced by <a class="el" href="density_8c-source.html#l00056">density()</a>, <a class="el" href="domain_8c-source.html#l00327">domain_findSplit()</a>, <a class="el" href="domain_8c-source.html#l00447">domain_shiftSplit()</a>, <a class="el" href="io_8c-source.html#l00129">fill_write_buffer()</a>, and <a class="el" href="read__ic_8c-source.html#l00031">read_ic()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="proto.h::dmin"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double dmin           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns the minimum of two double 
<p>
Definition at line <a class="el" href="system_8c-source.html#l00105">105</a> of file <a class="el" href="system_8c-source.html">system.c</a>.
<p>
Referenced by <a class="el" href="hydra_8c-source.html#l00353">hydro_evaluate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="proto.h::do_box_wrapping"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void do_box_wrapping           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function makes sure that all particle coordinates (Pos) are periodically mapped onto the interval [0, BoxSize]. After this function has been called, a new domain decomposition should be done, which will also force a new tree construction. 
<p>
Definition at line <a class="el" href="predict_8c-source.html#l00103">103</a> of file <a class="el" href="predict_8c-source.html">predict.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, and <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00062">domain_Decomposition()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="proto.h::domain_compare_key"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int domain_compare_key           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>b</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This is a comparison kernel used in a sort routine. 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l01127">1127</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="proto.h::domain_compare_toplist"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int domain_compare_toplist           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>b</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This is a comparison kernel used in a sort routine. 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l01114">1114</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="proto.h::domain_countToGo"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void domain_countToGo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function determines how many particles that are currently stored on the local CPU have to be moved off according to the domain decomposition. 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l00729">729</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00208">topnode_data::Daughter</a>, <a class="el" href="allvars_8c-source.html#l00058">DomainTask</a>, <a class="el" href="allvars_8c-source.html#l00068">Key</a>, <a class="el" href="allvars_8h-source.html#l00211">topnode_data::Leaf</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00212">topnode_data::Size</a>, <a class="el" href="allvars_8h-source.html#l00213">topnode_data::StartKey</a>, <a class="el" href="allvars_8c-source.html#l00075">TopNodes</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00154">domain_decompose()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="proto.h::domain_decompose"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void domain_decompose           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function carries out the actual domain decomposition for all particle types. It will try to balance the work-load for each domain, as estimated based on the P[i]-GravCost values. The decomposition will respect the maximum allowed memory-imbalance given by the value of PartAllocFactor. 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l00154">154</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="domain_8c-source.html#l00729">domain_countToGo()</a>, <a class="el" href="domain_8c-source.html#l00898">domain_determineTopTree()</a>, <a class="el" href="domain_8c-source.html#l00595">domain_exchangeParticles()</a>, <a class="el" href="domain_8c-source.html#l00534">domain_findExchangeNumbers()</a>, <a class="el" href="domain_8c-source.html#l00845">domain_findExtent()</a>, <a class="el" href="domain_8c-source.html#l00327">domain_findSplit()</a>, <a class="el" href="domain_8c-source.html#l00447">domain_shiftSplit()</a>, <a class="el" href="domain_8c-source.html#l00786">domain_sumCost()</a>, <a class="el" href="allvars_8c-source.html#l00053">DomainEndList</a>, <a class="el" href="allvars_8c-source.html#l00051">DomainMyLast</a>, <a class="el" href="allvars_8c-source.html#l00050">DomainMyStart</a>, <a class="el" href="allvars_8c-source.html#l00052">DomainStartList</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8c-source.html#l00073">NTopleaves</a>, <a class="el" href="allvars_8c-source.html#l00017">Ntype</a>, <a class="el" href="allvars_8c-source.html#l00018">NtypeLocal</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00458">global_data_all_processes::SofteningTable</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00254">global_data_all_processes::TotN_gas</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00062">domain_Decomposition()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="proto.h::domain_Decomposition"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void domain_Decomposition           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This is the main routine for the domain decomposition. It acts as a driver routine that allocates various temporary buffers, maps the particles back onto the periodic box if needed, and then does the domain decomposition, and a final Peano-Hilbert order of all particles as a tuning measure. 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l00062">62</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00391">global_data_all_processes::CPU_Domain</a>, <a class="el" href="allvars_8h-source.html#l00404">global_data_all_processes::CPU_Peano</a>, <a class="el" href="predict_8c-source.html#l00103">do_box_wrapping()</a>, <a class="el" href="domain_8c-source.html#l00154">domain_decompose()</a>, <a class="el" href="allvars_8c-source.html#l00068">Key</a>, <a class="el" href="allvars_8c-source.html#l00069">KeySorted</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00257">global_data_all_processes::MaxPartSph</a>, <a class="el" href="allvars_8c-source.html#l00016">N_gas</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00297">global_data_all_processes::NumForcesSinceLastDomainDecomp</a>, <a class="el" href="allvars_8c-source.html#l00015">NumPart</a>, <a class="el" href="peano_8c-source.html#l00034">peano_hilbert_order()</a>, <a class="el" href="allvars_8h-source.html#l00032">peanokey</a>, <a class="el" href="allvars_8h-source.html#l00366">global_data_all_processes::PM_Ti_endstep</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>, and <a class="el" href="allvars_8c-source.html#l00034">TreeReconstructFlag</a>.
<p>
Referenced by <a class="el" href="init_8c-source.html#l00020">init()</a>, and <a class="el" href="run_8c-source.html#l00020">run()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="proto.h::domain_determineTopTree"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void domain_determineTopTree           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function constructs the global top-level tree node that is used for the domain decomposition. This is done by considering the string of Peano-Hilbert keys for all particles, which is recursively chopped off in pieces of eight segments until each segment holds at most a certain number of particles.<p>
&lt; Bits per dimension available for Peano-Hilbert order. Note: If peanokey is defined as type int, the allowed maximum is 10. If 64-bit integers are used, the maximum is 21 <p>
&lt; Bits per dimension available for Peano-Hilbert order. Note: If peanokey is defined as type int, the allowed maximum is 10. If 64-bit integers are used, the maximum is 21 <p>
&lt; The number of different Peano-Hilbert cells <p>
&lt; Bits per dimension available for Peano-Hilbert order. Note: If peanokey is defined as type int, the allowed maximum is 10. If 64-bit integers are used, the maximum is 21 <p>
&lt; The number of different Peano-Hilbert cells 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l00898">898</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00034">BITS_PER_DIMENSION</a>, <a class="el" href="allvars_8c-source.html#l00046">DomainCorner</a>, <a class="el" href="allvars_8c-source.html#l00049">DomainFac</a>, <a class="el" href="allvars_8c-source.html#l00068">Key</a>, <a class="el" href="allvars_8c-source.html#l00069">KeySorted</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, and <a class="el" href="peano_8c-source.html#l00263">peano_hilbert_key()</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00154">domain_decompose()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="proto.h::domain_exchangeParticles"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void domain_exchangeParticles           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>partner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>sphflag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>send_count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>recv_count</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function exchanges particles between two CPUs according to the domain split. In doing this, the memory boundaries which may restrict the exhange process are observed. 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l00595">595</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00208">topnode_data::Daughter</a>, <a class="el" href="allvars_8c-source.html#l00066">DomainKeyBuf</a>, <a class="el" href="allvars_8c-source.html#l00119">DomainPartBuf</a>, <a class="el" href="allvars_8c-source.html#l00127">DomainSphBuf</a>, <a class="el" href="allvars_8c-source.html#l00058">DomainTask</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00068">Key</a>, <a class="el" href="allvars_8h-source.html#l00211">topnode_data::Leaf</a>, <a class="el" href="allvars_8c-source.html#l00016">N_gas</a>, <a class="el" href="allvars_8c-source.html#l00015">NumPart</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00032">peanokey</a>, <a class="el" href="allvars_8h-source.html#l00212">topnode_data::Size</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8h-source.html#l00213">topnode_data::StartKey</a>, <a class="el" href="tags_8h-source.html#l00009">TAG_KEY</a>, <a class="el" href="tags_8h-source.html#l00007">TAG_PDATA</a>, <a class="el" href="tags_8h-source.html#l00008">TAG_SPHDATA</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8c-source.html#l00075">TopNodes</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00154">domain_decompose()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="proto.h::domain_findExchangeNumbers"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void domain_findExchangeNumbers           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>task</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>partner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>sphflag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>send</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>recv</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function counts how many particles have to be exchanged between two CPUs according to the domain split. If the CPUs are already quite full and hold data from other CPUs as well, not all the particles may be exchanged at once. In this case the communication phase has to be repeated, until enough of the third-party particles have been moved away such that the decomposition can be completed. 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l00534">534</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00273">global_data_all_processes::BunchSizeDomain</a>, <a class="el" href="system_8c-source.html#l00125">imin()</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00257">global_data_all_processes::MaxPartSph</a>, and <a class="el" href="allvars_8c-source.html#l00012">NTask</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00154">domain_decompose()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="proto.h::domain_findExtent"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void domain_findExtent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine finds the extent of the global domain grid.<p>
&lt; Bits per dimension available for Peano-Hilbert order. Note: If peanokey is defined as type int, the allowed maximum is 10. If 64-bit integers are used, the maximum is 21 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l00845">845</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00047">DomainCenter</a>, <a class="el" href="allvars_8c-source.html#l00046">DomainCorner</a>, <a class="el" href="allvars_8c-source.html#l00049">DomainFac</a>, <a class="el" href="allvars_8c-source.html#l00048">DomainLen</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, and <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00154">domain_decompose()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="proto.h::domain_findSplit"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int domain_findSplit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>cpustart</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>ncpu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>first</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>last</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function tries to find a split point in a range of cells in the domain-grid. The range of cells starts at 'first', and ends at 'last' (inclusively). The number of cpus that holds the range is 'ncpu', with the first cpu given by 'cpustart'. If more than 2 cpus are to be split, the function calls itself recursively. The division tries to achieve a best particle-load balance under the constraint that 'maxload' and 'maxloadsph' may not be exceeded, and that each cpu holds at least one cell from the domaingrid. If such a decomposition cannot be achieved, a non-zero error code is returned.<p>
After successful completion, DomainMyStart[] and DomainMyLast[] contain the first and last cell of the domaingrid assigned to the local task for the given type. Also, DomainTask[] contains for each cell the task it was assigned to. 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l00327">327</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="system_8c-source.html#l00095">dmax()</a>, <a class="el" href="allvars_8c-source.html#l00055">DomainCount</a>, <a class="el" href="allvars_8c-source.html#l00056">DomainCountSph</a>, <a class="el" href="allvars_8c-source.html#l00053">DomainEndList</a>, <a class="el" href="allvars_8c-source.html#l00052">DomainStartList</a>, and <a class="el" href="allvars_8c-source.html#l00058">DomainTask</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00154">domain_decompose()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="proto.h::domain_shiftSplit"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void domain_shiftSplit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function tries to improve the domain decomposition found by <a class="el" href="domain_8c.html#a17">domain_findSplit()</a> with respect to work-load balance. To this end, the boundaries in the existing domain-split solution (which was found by trying to balance the particle load) are shifted as long as this leads to better work-load while still remaining within the allowed memory-imbalance constraints. 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l00447">447</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="system_8c-source.html#l00095">dmax()</a>, <a class="el" href="allvars_8c-source.html#l00055">DomainCount</a>, <a class="el" href="allvars_8c-source.html#l00056">DomainCountSph</a>, <a class="el" href="allvars_8c-source.html#l00053">DomainEndList</a>, <a class="el" href="allvars_8c-source.html#l00052">DomainStartList</a>, <a class="el" href="allvars_8c-source.html#l00058">DomainTask</a>, <a class="el" href="allvars_8c-source.html#l00054">DomainWork</a>, and <a class="el" href="allvars_8c-source.html#l00012">NTask</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00154">domain_decompose()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="proto.h::domain_sumCost"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void domain_sumCost           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine bins the particles onto the domain-grid, i.e. it sums up the total number of particles and the total amount of work in each of the domain-cells. This information forms the basis for the actual decision on the adopted domain decomposition. 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l00786">786</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00208">topnode_data::Daughter</a>, <a class="el" href="domain_8c-source.html#l00765">domain_walktoptree()</a>, <a class="el" href="allvars_8c-source.html#l00055">DomainCount</a>, <a class="el" href="allvars_8c-source.html#l00056">DomainCountSph</a>, <a class="el" href="allvars_8c-source.html#l00054">DomainWork</a>, <a class="el" href="allvars_8h-source.html#l00518">particle_data::GravCost</a>, <a class="el" href="allvars_8c-source.html#l00068">Key</a>, <a class="el" href="allvars_8h-source.html#l00211">topnode_data::Leaf</a>, <a class="el" href="allvars_8c-source.html#l00073">NTopleaves</a>, <a class="el" href="allvars_8c-source.html#l00072">NTopnodes</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00212">topnode_data::Size</a>, <a class="el" href="allvars_8h-source.html#l00213">topnode_data::StartKey</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8c-source.html#l00075">TopNodes</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00154">domain_decompose()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="proto.h::domain_topsplit"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void domain_topsplit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>node</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="allvars_8h.html#a45">peanokey</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startkey</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is responsible for constructing the global top-level tree segments. Starting from a joint list of all local top-level segments, in which mulitple occurences of the same spatial segment have been combined, a segment is subdivided into 8 pieces recursively until the number of particles in each segment has fallen below All.TotNumPart / (TOPNODEFACTOR * NTask).<p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l01057">1057</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00210">topnode_data::Blocks</a>, <a class="el" href="allvars_8h-source.html#l00214">topnode_data::Count</a>, <a class="el" href="allvars_8h-source.html#l00208">topnode_data::Daughter</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00072">NTopnodes</a>, <a class="el" href="allvars_8h-source.html#l00209">topnode_data::Pstart</a>, <a class="el" href="allvars_8h-source.html#l00212">topnode_data::Size</a>, <a class="el" href="allvars_8h-source.html#l00213">topnode_data::StartKey</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, and <a class="el" href="allvars_8c-source.html#l00075">TopNodes</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="proto.h::domain_topsplit_local"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void domain_topsplit_local           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>node</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="allvars_8h.html#a45">peanokey</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startkey</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is responsible for constructing the local top-level Peano-Hilbert segments. A segment is cut into 8 pieces recursively until the number of particles in the segment has fallen below All.TotNumPart / (TOPNODEFACTOR * NTask * NTask).<p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition 
<p>
Definition at line <a class="el" href="domain_8c-source.html#l00990">990</a> of file <a class="el" href="domain_8c-source.html">domain.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00214">topnode_data::Count</a>, <a class="el" href="allvars_8h-source.html#l00208">topnode_data::Daughter</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00072">NTopnodes</a>, <a class="el" href="allvars_8h-source.html#l00209">topnode_data::Pstart</a>, <a class="el" href="allvars_8h-source.html#l00212">topnode_data::Size</a>, <a class="el" href="allvars_8h-source.html#l00213">topnode_data::StartKey</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, and <a class="el" href="allvars_8c-source.html#l00075">TopNodes</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="proto.h::drift_integ"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double drift_integ           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>param</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Integration kernel for drift factor computation. 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00179">179</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, and <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="proto.h::dump_particles"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void dump_particles           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function dumps some of the basic particle data to a file. In case the tree construction fails, it is called just before the run terminates with an error message. Examination of the generated file may then give clues to what caused the problem. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l02835">2835</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
Referenced by <a class="el" href="forcetree_8c-source.html#l00294">force_create_empty_nodes()</a>, and <a class="el" href="forcetree_8c-source.html#l00093">force_treebuild_single()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="proto.h::empty_read_buffer"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void empty_read_buffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>blocknr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function reads out the buffer that was filled with particle data, and stores it at the appropriate place in the particle structures. 
<p>
Definition at line <a class="el" href="read__ic_8c-source.html#l00168">168</a> of file <a class="el" href="read__ic_8c-source.html">read_ic.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00536">sph_particle_data::Density</a>, <a class="el" href="allvars_8h-source.html#l00535">sph_particle_data::Entropy</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00507">particle_data::ID</a>, <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, and <a class="el" href="allvars_8h-source.html#l00496">particle_data::Vel</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="proto.h::endrun"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void endrun           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ierr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function aborts the simulations. If a single processors wants an immediate termination, the function needs to be called with ierr&gt;0. A bunch of MPI-error messages may also appear in this case. For ierr=0, MPI is gracefully cleaned up, but this requires that all processors call <a class="el" href="endrun_8c.html#a0">endrun()</a>. 
<p>
Definition at line <a class="el" href="endrun_8c-source.html#l00025">25</a> of file <a class="el" href="endrun_8c-source.html">endrun.c</a>.
<p>
References <a class="el" href="proto_8h.html#a152">terminate_processes()</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="allocate_8c-source.html#l00019">allocate_commbuffers()</a>, <a class="el" href="allocate_8c-source.html#l00103">allocate_memory()</a>, <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>, <a class="el" href="density_8c-source.html#l00056">density()</a>, <a class="el" href="domain_8c-source.html#l00154">domain_decompose()</a>, <a class="el" href="domain_8c-source.html#l00595">domain_exchangeParticles()</a>, <a class="el" href="domain_8c-source.html#l01057">domain_topsplit()</a>, <a class="el" href="domain_8c-source.html#l00990">domain_topsplit_local()</a>, <a class="el" href="read__ic_8c-source.html#l00616">find_files()</a>, <a class="el" href="forcetree_8c-source.html#l00294">force_create_empty_nodes()</a>, <a class="el" href="forcetree_8c-source.html#l02622">force_treeallocate()</a>, <a class="el" href="forcetree_8c-source.html#l00093">force_treebuild_single()</a>, <a class="el" href="io_8c-source.html#l00465">get_particles_in_block()</a>, <a class="el" href="gravtree__forcetest_8c-source.html#l00028">gravity_forcetest()</a>, <a class="el" href="init_8c-source.html#l00020">init()</a>, <a class="el" href="longrange_8c-source.html#l00056">long_range_force()</a>, <a class="el" href="main_8c-source.html#l00022">main()</a>, <a class="el" href="io_8c-source.html#l01141">my_fread()</a>, <a class="el" href="io_8c-source.html#l01124">my_fwrite()</a>, <a class="el" href="ngb_8c-source.html#l00358">ngb_treeallocate()</a>, <a class="el" href="begrun_8c-source.html#l00199">open_outputfiles()</a>, <a class="el" href="pm__periodic_8c-source.html#l00114">pm_init_periodic_allocate()</a>, <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, <a class="el" href="begrun_8c-source.html#l00280">read_parameter_file()</a>, <a class="el" href="begrun_8c-source.html#l00793">readjust_timebase()</a>, <a class="el" href="restart_8c-source.html#l00035">restart()</a>, <a class="el" href="io_8c-source.html#l00033">savepositions()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="proto.h::energy_statistics"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void energy_statistics           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine first calls a computation of various global quantities of the particle distribution, and then writes some statistics about the energies in the various particle components to the file FdEnergy. 
<p>
Definition at line <a class="el" href="run_8c-source.html#l00417">417</a> of file <a class="el" href="run_8c-source.html">run.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00667">state_of_system::EnergyInt</a>, <a class="el" href="allvars_8h-source.html#l00675">state_of_system::EnergyIntComp</a>, <a class="el" href="allvars_8h-source.html#l00665">state_of_system::EnergyKin</a>, <a class="el" href="allvars_8h-source.html#l00673">state_of_system::EnergyKinComp</a>, <a class="el" href="allvars_8h-source.html#l00666">state_of_system::EnergyPot</a>, <a class="el" href="allvars_8h-source.html#l00674">state_of_system::EnergyPotComp</a>, <a class="el" href="allvars_8c-source.html#l00088">FdEnergy</a>, <a class="el" href="allvars_8h-source.html#l00672">state_of_system::MassComp</a>, <a class="el" href="allvars_8c-source.html#l00173">SysState</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, and <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>.
<p>
Referenced by <a class="el" href="run_8c-source.html#l00020">run()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="proto.h::every_timestep_stuff"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void every_timestep_stuff           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine writes one line for every timestep to two log-files. In FdInfo, we just list the timesteps that have been done, while in FdCPU the cumulative cpu-time consumption in various parts of the code is stored. 
<p>
Definition at line <a class="el" href="run_8c-source.html#l00374">374</a> of file <a class="el" href="run_8c-source.html">run.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00394">global_data_all_processes::CPU_CommSum</a>, <a class="el" href="allvars_8h-source.html#l00391">global_data_all_processes::CPU_Domain</a>, <a class="el" href="allvars_8h-source.html#l00400">global_data_all_processes::CPU_EnsureNgb</a>, <a class="el" href="allvars_8h-source.html#l00389">global_data_all_processes::CPU_Gravity</a>, <a class="el" href="allvars_8h-source.html#l00397">global_data_all_processes::CPU_HydCommSumm</a>, <a class="el" href="allvars_8h-source.html#l00396">global_data_all_processes::CPU_HydCompWalk</a>, <a class="el" href="allvars_8h-source.html#l00398">global_data_all_processes::CPU_HydImbalance</a>, <a class="el" href="allvars_8h-source.html#l00399">global_data_all_processes::CPU_Hydro</a>, <a class="el" href="allvars_8h-source.html#l00395">global_data_all_processes::CPU_Imbalance</a>, <a class="el" href="allvars_8h-source.html#l00404">global_data_all_processes::CPU_Peano</a>, <a class="el" href="allvars_8h-source.html#l00403">global_data_all_processes::CPU_PM</a>, <a class="el" href="allvars_8h-source.html#l00390">global_data_all_processes::CPU_Potential</a>, <a class="el" href="allvars_8h-source.html#l00401">global_data_all_processes::CPU_Predict</a>, <a class="el" href="allvars_8h-source.html#l00392">global_data_all_processes::CPU_Snapshot</a>, <a class="el" href="allvars_8h-source.html#l00402">global_data_all_processes::CPU_TimeLine</a>, <a class="el" href="allvars_8h-source.html#l00393">global_data_all_processes::CPU_Total</a>, <a class="el" href="allvars_8h-source.html#l00387">global_data_all_processes::CPU_TreeConstruction</a>, <a class="el" href="allvars_8h-source.html#l00388">global_data_all_processes::CPU_TreeWalk</a>, <a class="el" href="allvars_8c-source.html#l00090">FdCPU</a>, <a class="el" href="allvars_8c-source.html#l00087">FdInfo</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00345">global_data_all_processes::NumCurrentTiStep</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, and <a class="el" href="allvars_8h-source.html#l00352">global_data_all_processes::TimeStep</a>.
<p>
Referenced by <a class="el" href="run_8c-source.html#l00020">run()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="proto.h::ewald_corr"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ewald_corr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>dx</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>dy</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>dz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double *&nbsp;</td>
          <td class="mdname" nowrap> <em>fper</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function looks up the correction force due to the infinite number of periodic particle/node images. We here use trilinear interpolation to get it from the precomputed tables, which contain one octant around the target particle at the origin. The other octants are obtained from it by exploiting the symmetry properties. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l03023">3023</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="proto.h::ewald_force"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ewald_force           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>iii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>jjj</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>kkk</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>[3], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>force</em>[3]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function computes the force correction term (difference between full force of infinite lattice and nearest image) by Ewald summation. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l03206">3206</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="proto.h::ewald_init"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ewald_init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function initializes tables with the correction force and the correction potential due to the periodic images of a point mass located at the origin. These corrections are obtained by Ewald summation. (See Hernquist, Bouchet, Suto, ApJS, 1991, 75, 231) The correction fields are used to obtain the full periodic force if periodic boundaries combined with the pure tree algorithm are used. For the TreePM algorithm, the Ewald correction is not used.<p>
The correction fields are stored on disk once they are computed. If a corresponding file is found, they are loaded from disk to speed up the initialization. The Ewald summation is done in parallel, i.e. the processors share the work to compute the tables if needed. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l02874">2874</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="proto.h::ewald_pot_corr"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double ewald_pot_corr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>dx</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>dy</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>dz</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function looks up the correction potential due to the infinite number of periodic particle/node images. We here use tri-linear interpolation to get it from the precomputed table, which contains one octant around the target particle at the origin. The other octants are obtained from it by exploiting symmetry properties. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l03112">3112</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="forcetree_8c-source.html#l00045">EN</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="proto.h::ewald_psi"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double ewald_psi           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>x</em>[3]          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function computes the potential correction term by means of Ewald summation. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l03165">3165</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="proto.h::fill_Tab_IO_Labels"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void fill_Tab_IO_Labels           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function associates a short 4-character block name with each block number. This is stored in front of each block for snapshot FileFormat=2. If one wants to add a new output-block, this function should be augmented accordingly.<p>
&lt; total number of defined information blocks for snapshot files. Must be equal to the number of entries in "enum iofields" 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00566">566</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>, <a class="el" href="allvars_8h-source.html#l00640">iofields</a>, and <a class="el" href="allvars_8c-source.html#l00167">Tab_IO_Labels</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00031">read_ic()</a>, and <a class="el" href="io_8c-source.html#l00033">savepositions()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="proto.h::fill_write_buffer"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void fill_write_buffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>blocknr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>startindex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>pc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function fills the write buffer with particle data. New output blocks can in principle be added here.<p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00129">129</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00536">sph_particle_data::Density</a>, <a class="el" href="system_8c-source.html#l00095">dmax()</a>, <a class="el" href="allvars_8h-source.html#l00542">sph_particle_data::DtEntropy</a>, <a class="el" href="allvars_8h-source.html#l00535">sph_particle_data::Entropy</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00052">GAMMA</a>, <a class="el" href="allvars_8h-source.html#l00055">GAMMA_MINUS1</a>, <a class="el" href="driftfac_8c-source.html#l00105">get_gravkick_factor()</a>, <a class="el" href="driftfac_8c-source.html#l00142">get_hydrokick_factor()</a>, <a class="el" href="allvars_8h-source.html#l00497">particle_data::GravAccel</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00543">sph_particle_data::HydroAccel</a>, <a class="el" href="allvars_8h-source.html#l00507">particle_data::ID</a>, <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00291">global_data_all_processes::MinEgySpec</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00367">global_data_all_processes::PM_Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00366">global_data_all_processes::PM_Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00504">particle_data::Potential</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, and <a class="el" href="allvars_8h-source.html#l00496">particle_data::Vel</a>.
<p>
Referenced by <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="proto.h::find_dt_displacement_constraint"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void find_dt_displacement_constraint           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hfac</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function computes an upper limit ('dt_displacement') to the global timestep of the system based on the rms velocities of particles. For cosmological simulations, the criterion used is that the rms displacement should be at most a fraction MaxRMSDisplacementFac of the mean particle separation. Note that the latter is estimated using the assigned particle masses, separately for each particle type. If comoving integration is not used, the function imposes no constraint on the timestep. <dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>hfac</em>&nbsp;</td><td>
should be a^2*H(a) </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="timestep_8c-source.html#l00582">582</a> of file <a class="el" href="timestep_8c-source.html">timestep.c</a>.
<p>
Referenced by <a class="el" href="timestep_8c-source.html#l00024">advance_and_find_timesteps()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="proto.h::find_files"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int find_files           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fname</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function determines onto how many files a given snapshot is distributed. 
<p>
Definition at line <a class="el" href="read__ic_8c-source.html#l00616">616</a> of file <a class="el" href="read__ic_8c-source.html">read_ic.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00161">header</a>, <a class="el" href="allvars_8h-source.html#l00261">global_data_all_processes::ICFormat</a>, <a class="el" href="allvars_8h-source.html#l00623">io_header::num_files</a>, <a class="el" href="read__ic_8c-source.html#l00765">read_header_attributes_in_hdf5()</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00031">read_ic()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="proto.h::find_next_outputtime"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int find_next_outputtime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ti_curr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
this function returns the next output time that is equal or larger to ti_curr<p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 
<p>
Definition at line <a class="el" href="run_8c-source.html#l00246">246</a> of file <a class="el" href="run_8c-source.html">run.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00482">global_data_all_processes::OutputListLength</a>, <a class="el" href="allvars_8h-source.html#l00481">global_data_all_processes::OutputListTimes</a>, <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>, <a class="el" href="allvars_8h-source.html#l00351">global_data_all_processes::TimeBegin</a>, and <a class="el" href="allvars_8h-source.html#l00353">global_data_all_processes::TimeMax</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="proto.h::find_next_sync_point_and_drift"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void find_next_sync_point_and_drift           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function finds the next synchronization point of the system (i.e. the earliest point of time any of the particles needs a force computation), and drifts the system to this point of time. If the system drifts over the desired time of a snapshot file, the function will drift to this moment, generate an output, and then resume the drift. 
<p>
Definition at line <a class="el" href="run_8c-source.html#l00153">153</a> of file <a class="el" href="run_8c-source.html">run.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8c-source.html#l00036">Flag_FullStep</a>, and <a class="el" href="allvars_8c-source.html#l00119">P</a>.
<p>
Referenced by <a class="el" href="run_8c-source.html#l00020">run()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="proto.h::force_create_empty_nodes"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_create_empty_nodes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>topnode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>bits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>nodecount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>nextfree</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function recursively creates a set of empty tree nodes which corresponds to the top-level tree for the domain grid. This is done to ensure that this top-level tree is always "complete" so that we can easily associate the pseudo-particles of other CPUs with tree-nodes at a given level in the tree, even when the particle population is so sparse that some of these nodes are actually empty. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00294">294</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00567">NODE::center</a>, <a class="el" href="allvars_8h-source.html#l00208">topnode_data::Daughter</a>, <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, <a class="el" href="forcetree_8c-source.html#l02835">dump_particles()</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8h-source.html#l00211">topnode_data::Leaf</a>, <a class="el" href="allvars_8h-source.html#l00566">NODE::len</a>, <a class="el" href="allvars_8c-source.html#l00138">MaxNodes</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="peano_8c-source.html#l00263">peano_hilbert_key()</a>, <a class="el" href="allvars_8h-source.html#l00574">NODE::suns</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8c-source.html#l00075">TopNodes</a>, and <a class="el" href="structNODE.html#o10">NODE::u</a>.
<p>
Referenced by <a class="el" href="forcetree_8c-source.html#l00093">force_treebuild_single()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="proto.h::force_exchange_pseudodata"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_exchange_pseudodata           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function communicates the values of the multipole moments of the top-level tree-nodes of the domain grid. This data can then be used to update the pseudo-particles on each CPU accordingly. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00686">686</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00579">NODE::bitflags</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8c-source.html#l00063">DomainMoment</a>, <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, <a class="el" href="allvars_8c-source.html#l00151">Extnodes</a>, <a class="el" href="allvars_8h-source.html#l00578">NODE::mass</a>, <a class="el" href="allvars_8h-source.html#l00185">DomainNODE::mass</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8h-source.html#l00577">NODE::s</a>, <a class="el" href="allvars_8h-source.html#l00183">DomainNODE::s</a>, <a class="el" href="structNODE.html#o10">NODE::u</a>, <a class="el" href="allvars_8h-source.html#l00600">extNODE::vs</a>, and <a class="el" href="allvars_8h-source.html#l00184">DomainNODE::vs</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="proto.h::force_flag_localnodes"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_flag_localnodes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function flags nodes in the top-level tree that are dependent on local particle data. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00836">836</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00579">NODE::bitflags</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, <a class="el" href="allvars_8h-source.html#l00582">NODE::father</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, and <a class="el" href="structNODE.html#o10">NODE::u</a>.
<p>
Referenced by <a class="el" href="forcetree_8c-source.html#l00061">force_treebuild()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="proto.h::force_insert_pseudo_particles"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_insert_pseudo_particles           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
this function inserts pseudo-particles which will represent the mass distribution of the other CPUs. Initially, the mass of the pseudo-particles is set to zero, and their coordinate is set to the center of the domain-cell they correspond to. These quantities will be updated later on. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00348">348</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00567">NODE::center</a>, <a class="el" href="allvars_8c-source.html#l00063">DomainMoment</a>, <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, <a class="el" href="allvars_8h-source.html#l00185">DomainNODE::mass</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, and <a class="el" href="allvars_8h-source.html#l00183">DomainNODE::s</a>.
<p>
Referenced by <a class="el" href="forcetree_8c-source.html#l00093">force_treebuild_single()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="proto.h::force_setupnonrecursive"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_setupnonrecursive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>no</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="proto.h::force_treeallocate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_treeallocate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>maxnodes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>maxpart</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function allocates the memory used for storage of the tree and of auxiliary arrays needed for tree-walk and link-lists. Usually, maxnodes approximately equal to 0.7*maxpart is sufficient to store the tree for up to maxpart particles.<p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l02622">2622</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00138">MaxNodes</a>, and <a class="el" href="allvars_8c-source.html#l00141">Nodes_base</a>.
<p>
Referenced by <a class="el" href="init_8c-source.html#l00020">init()</a>, <a class="el" href="pm__periodic_8c-source.html#l00181">pmforce_periodic()</a>, <a class="el" href="pm__periodic_8c-source.html#l00694">pmpotential_periodic()</a>, and <a class="el" href="restart_8c-source.html#l00035">restart()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="proto.h::force_treebuild"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int force_treebuild           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>npart</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is a driver routine for constructing the gravitational oct-tree, which is done by calling a small number of other functions. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00061">61</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="forcetree_8c-source.html#l00836">force_flag_localnodes()</a>, <a class="el" href="forcetree_8c-source.html#l00093">force_treebuild_single()</a>, <a class="el" href="forcetree_8c-source.html#l00673">force_update_pseudoparticles()</a>, <a class="el" href="allvars_8c-source.html#l00139">Numnodestree</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, and <a class="el" href="allvars_8c-source.html#l00079">TimeOfLastTreeConstruction</a>.
<p>
Referenced by <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>, <a class="el" href="gravtree_8c-source.html#l00027">gravity_tree()</a>, and <a class="el" href="ngb_8c-source.html#l00403">ngb_treebuild()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="proto.h::force_treebuild_single"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int force_treebuild_single           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>npart</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructs the gravitational oct-tree.<p>
The index convention for accessing tree nodes is the following: the indices 0...NumPart-1 reference single particles, the indices All.MaxPart.... All.MaxPart+nodes-1 reference tree nodes. `Nodes_base' points to the first tree node, while `nodes' is shifted such that nodes[All.MaxPart] gives the first tree node. Finally, node indices with values 'All.MaxPart + MaxNodes' and larger indicate "pseudo particles", i.e. multipole moments of top-level nodes that lie on different CPUs. If such a node needs to be opened, the corresponding particle must be exported to that CPU. The 'Extnodes' structure parallels that of 'Nodes'. Its information is only needed for the SPH part of the computation. (The data is split onto these two structures as a tuning measure. If it is merged into 'Nodes' a somewhat bigger size of the nodes also for gravity would result, which would reduce cache utilization slightly.<p>
&lt; Bits per dimension available for Peano-Hilbert order. Note: If peanokey is defined as type int, the allowed maximum is 10. If 64-bit integers are used, the maximum is 21 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00093">93</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00034">BITS_PER_DIMENSION</a>, <a class="el" href="allvars_8h-source.html#l00567">NODE::center</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8h-source.html#l00208">topnode_data::Daughter</a>, <a class="el" href="allvars_8c-source.html#l00047">DomainCenter</a>, <a class="el" href="allvars_8c-source.html#l00046">DomainCorner</a>, <a class="el" href="allvars_8c-source.html#l00049">DomainFac</a>, <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, <a class="el" href="forcetree_8c-source.html#l02835">dump_particles()</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="forcetree_8c-source.html#l00294">force_create_empty_nodes()</a>, <a class="el" href="forcetree_8c-source.html#l00348">force_insert_pseudo_particles()</a>, <a class="el" href="forcetree_8c-source.html#l00424">force_update_node_recursive()</a>, <a class="el" href="allvars_8h-source.html#l00459">global_data_all_processes::ForceSoftening</a>, <a class="el" href="system_8c-source.html#l00029">get_random_number()</a>, <a class="el" href="allvars_8h-source.html#l00518">particle_data::GravCost</a>, <a class="el" href="allvars_8h-source.html#l00211">topnode_data::Leaf</a>, <a class="el" href="allvars_8h-source.html#l00566">NODE::len</a>, <a class="el" href="allvars_8c-source.html#l00138">MaxNodes</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00581">NODE::nextnode</a>, <a class="el" href="allvars_8c-source.html#l00147">Nextnode</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="peano_8c-source.html#l00263">peano_hilbert_key()</a>, <a class="el" href="allvars_8h-source.html#l00032">peanokey</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00212">topnode_data::Size</a>, <a class="el" href="allvars_8h-source.html#l00213">topnode_data::StartKey</a>, <a class="el" href="allvars_8h-source.html#l00574">NODE::suns</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8c-source.html#l00075">TopNodes</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, and <a class="el" href="structNODE.html#o10">NODE::u</a>.
<p>
Referenced by <a class="el" href="forcetree_8c-source.html#l00061">force_treebuild()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="proto.h::force_treeevaluate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int force_treeevaluate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double *&nbsp;</td>
          <td class="mdname" nowrap> <em>ewaldcountsum</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine computes the gravitational force for a given local particle, or for a particle in the communication buffer. Depending on the value of TypeOfOpeningCriterion, either the geometrical BH cell-opening criterion, or the `relative' opening criterion is used. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l01128">1128</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00409">global_data_all_processes::ErrTolForceAcc</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00505">particle_data::OldAcc</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="gravtree_8c-source.html#l00027">gravity_tree()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="proto.h::force_treeevaluate_direct"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int force_treeevaluate_direct           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function does the force computation with direct summation for the specified particle in the communication buffer. This can be useful for debugging purposes, in particular for explicit checks of the force accuracy. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l02704">2704</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="gravtree__forcetest_8c-source.html#l00028">gravity_forcetest()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="proto.h::force_treeevaluate_ewald_correction"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int force_treeevaluate_ewald_correction           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>pos_x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>pos_y</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>pos_z</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>aold</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function computes the Ewald correction, and is needed if periodic boundary conditions together with a pure tree algorithm are used. Note that the ordinary tree walk does not carry out this correction directly as it was done in Gadget-1.1. Instead, the tree is walked a second time. This is actually faster because the "Ewald-Treewalk" can use a different opening criterion than the normal tree walk. In particular, the Ewald correction is negligible for particles that are very close, but it is large for particles that are far away (this is quite different for the normal direct force). So we can here use a different opening criterion. Sufficient accuracy is usually obtained if the node length has dropped to a certain fraction ~&lt; 0.25 of the BoxLength. However, we may only short-cut the interaction list of the normal full Ewald tree walk if we are sure that the whole node and all daughter nodes "lie on the same side" of the periodic boundary, i.e. that the real tree walk would not find a daughter node or particle that was mapped to a different nearest neighbour position when the tree walk would be further refined. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l01777">1777</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00692">gravdata_in::Acc</a>, <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00579">NODE::bitflags</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="allvars_8h-source.html#l00567">NODE::center</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8c-source.html#l00058">DomainTask</a>, <a class="el" href="forcetree_8c-source.html#l00045">EN</a>, <a class="el" href="allvars_8h-source.html#l00408">global_data_all_processes::ErrTolTheta</a>, <a class="el" href="allvars_8c-source.html#l00030">Exportflag</a>, <a class="el" href="allvars_8h-source.html#l00497">particle_data::GravAccel</a>, <a class="el" href="allvars_8h-source.html#l00518">particle_data::GravCost</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataResult</a>, <a class="el" href="allvars_8h-source.html#l00566">NODE::len</a>, <a class="el" href="allvars_8h-source.html#l00578">NODE::mass</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="forcetree_8c-source.html#l00043">NEAREST</a>, <a class="el" href="allvars_8h-source.html#l00581">NODE::nextnode</a>, <a class="el" href="allvars_8c-source.html#l00147">Nextnode</a>, <a class="el" href="allvars_8h-source.html#l00705">gravdata_in::Ninteractions</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00577">NODE::s</a>, <a class="el" href="allvars_8h-source.html#l00580">NODE::sibling</a>, <a class="el" href="structgravdata__in.html#o3">gravdata_in::u</a>, <a class="el" href="structNODE.html#o10">NODE::u</a>, and <a class="el" href="structgravdata__in.html#o6">gravdata_in::w</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="proto.h::force_treeevaluate_potential"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_treeevaluate_potential           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine computes the gravitational potential by walking the tree. The same opening criteria is used as for the gravitational force walk. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l02043">2043</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00409">global_data_all_processes::ErrTolForceAcc</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00505">particle_data::OldAcc</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="proto.h::force_treeevaluate_potential_shortrange"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_treeevaluate_potential_shortrange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function computes the short-range potential when the TreePM algorithm is used. This potential is the Newtonian potential, modified by a complementary error function. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l02304">2304</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00409">global_data_all_processes::ErrTolForceAcc</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00505">particle_data::OldAcc</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a65" doxytag="proto.h::force_treeevaluate_shortrange"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int force_treeevaluate_shortrange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
In the TreePM algorithm, the tree is walked only locally around the target coordinate. Tree nodes that fall outside a box of half side-length Rcut= RCUT*ASMTH*MeshSize can be discarded. The short-range potential is modified by a complementary error function, multiplied with the Newtonian form. The resulting short-range suppression compared to the Newtonian force is tabulated, because looking up from this table is faster than recomputing the corresponding factor, despite the memory-access panelty (which reduces cache performance) incurred by the table. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l01422">1422</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00409">global_data_all_processes::ErrTolForceAcc</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00505">particle_data::OldAcc</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="gravtree_8c-source.html#l00027">gravity_tree()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a66" doxytag="proto.h::force_treefree"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_treefree           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function frees the memory allocated for the tree, i.e. it frees the space allocated by the function <a class="el" href="forcetree_8c.html#a33">force_treeallocate()</a>. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l02687">2687</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
Referenced by <a class="el" href="pm__periodic_8c-source.html#l00181">pmforce_periodic()</a>, and <a class="el" href="pm__periodic_8c-source.html#l00694">pmpotential_periodic()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a67" doxytag="proto.h::force_treeupdate_pseudos"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_treeupdate_pseudos           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function updates the top-level tree after the multipole moments of the pseudo-particles have been updated. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00734">734</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00579">NODE::bitflags</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8c-source.html#l00063">DomainMoment</a>, <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, <a class="el" href="allvars_8c-source.html#l00151">Extnodes</a>, <a class="el" href="allvars_8h-source.html#l00582">NODE::father</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00459">global_data_all_processes::ForceSoftening</a>, <a class="el" href="allvars_8h-source.html#l00185">DomainNODE::mass</a>, <a class="el" href="allvars_8h-source.html#l00578">NODE::mass</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8h-source.html#l00183">DomainNODE::s</a>, <a class="el" href="allvars_8h-source.html#l00577">NODE::s</a>, <a class="el" href="structNODE.html#o10">NODE::u</a>, <a class="el" href="allvars_8h-source.html#l00184">DomainNODE::vs</a>, and <a class="el" href="allvars_8h-source.html#l00600">extNODE::vs</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a68" doxytag="proto.h::force_update_hmax"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_update_hmax           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function updates the hmax-values in tree nodes that hold SPH particles. These values are needed to find all neighbors in the hydro-force computation. Since the Hsml-values are potentially changed in the SPH-denity computation, <a class="el" href="forcetree_8c.html#a25">force_update_hmax()</a> should be carried out just before the hydrodynamical SPH forces are computed, i.e. after <a class="el" href="density_8c.html#a8">density()</a>. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l01016">1016</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00061">DomainHmax</a>, <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, and <a class="el" href="allvars_8c-source.html#l00151">Extnodes</a>.
<p>
Referenced by <a class="el" href="accel_8c-source.html#l00024">compute_accelerations()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a69" doxytag="proto.h::force_update_len"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_update_len           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function updates the side-length of tree nodes in case the tree is not reconstructed, but only drifted. The grouping of particles to tree nodes is not changed in this case, but some tree nodes may need to be enlarged because particles moved out of their original bounds. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00887">887</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, <a class="el" href="allvars_8c-source.html#l00060">DomainTreeNodeLen</a>, and <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>.
<p>
Referenced by <a class="el" href="predict_8c-source.html#l00031">move_particles()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a70" doxytag="proto.h::force_update_node"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_update_node           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>flag</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a71" doxytag="proto.h::force_update_node_hmax_local"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_update_node_hmax_local           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine updates the hmax-values of local tree nodes. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l01053">1053</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8c-source.html#l00151">Extnodes</a>, <a class="el" href="allvars_8h-source.html#l00582">NODE::father</a>, <a class="el" href="allvars_8c-source.html#l00148">Father</a>, <a class="el" href="allvars_8h-source.html#l00599">extNODE::hmax</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, and <a class="el" href="structNODE.html#o10">NODE::u</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a72" doxytag="proto.h::force_update_node_hmax_toptree"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_update_node_hmax_toptree           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function recursively sets the hmax-values of the top-level tree. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l01089">1089</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8c-source.html#l00061">DomainHmax</a>, <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, <a class="el" href="allvars_8c-source.html#l00151">Extnodes</a>, <a class="el" href="allvars_8h-source.html#l00582">NODE::father</a>, <a class="el" href="allvars_8h-source.html#l00599">extNODE::hmax</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, and <a class="el" href="structNODE.html#o10">NODE::u</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a73" doxytag="proto.h::force_update_node_len_local"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_update_node_len_local           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function recursively enlarges nodes such that they always contain all their daughter nodes and daughter particles. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00925">925</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00567">NODE::center</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8h-source.html#l00582">NODE::father</a>, <a class="el" href="allvars_8c-source.html#l00148">Father</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00566">NODE::len</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, and <a class="el" href="structNODE.html#o10">NODE::u</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a74" doxytag="proto.h::force_update_node_len_toptree"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_update_node_len_toptree           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function recursively enlarges nodes of the top-level tree such that they always contain all their daughter nodes. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00972">972</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00567">NODE::center</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, <a class="el" href="allvars_8c-source.html#l00060">DomainTreeNodeLen</a>, <a class="el" href="allvars_8h-source.html#l00582">NODE::father</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00566">NODE::len</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, and <a class="el" href="structNODE.html#o10">NODE::u</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a75" doxytag="proto.h::force_update_node_recursive"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_update_node_recursive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>sib</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>father</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
this routine determines the multipole moments for a given internal node and all its subnodes using a recursive computation. The result is stored in the Nodes[] structure in the sequence of this tree-walk.<p>
Note that the bitflags-variable for each node is used to store in the lowest bits some special information: Bit 0 flags whether the node belongs to the top-level tree corresponding to the domain decomposition, while Bit 1 signals whether the top-level node is dependent on local mass.<p>
If UNEQUALSOFTENINGS is set, bits 2-4 give the particle type with the maximum softening among the particles in the node, and bit 5 flags whether the node contains any particles with lower softening than that. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00424">424</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00579">NODE::bitflags</a>, <a class="el" href="allvars_8h-source.html#l00567">NODE::center</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8c-source.html#l00151">Extnodes</a>, <a class="el" href="allvars_8h-source.html#l00582">NODE::father</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00459">global_data_all_processes::ForceSoftening</a>, <a class="el" href="allvars_8h-source.html#l00599">extNODE::hmax</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00578">NODE::mass</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00581">NODE::nextnode</a>, <a class="el" href="allvars_8c-source.html#l00147">Nextnode</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00577">NODE::s</a>, <a class="el" href="allvars_8h-source.html#l00580">NODE::sibling</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8h-source.html#l00574">NODE::suns</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, <a class="el" href="structNODE.html#o10">NODE::u</a>, <a class="el" href="allvars_8h-source.html#l00496">particle_data::Vel</a>, and <a class="el" href="allvars_8h-source.html#l00600">extNODE::vs</a>.
<p>
Referenced by <a class="el" href="forcetree_8c-source.html#l00093">force_treebuild_single()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a76" doxytag="proto.h::force_update_pseudoparticles"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_update_pseudoparticles           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function updates the multipole moments of the pseudo-particles that represent the mass distribution on different CPUs. For that purpose, it first exchanges the necessary data, and then updates the top-level tree accordingly. The detailed implementation of these two tasks is done in separate functions. 
<p>
Definition at line <a class="el" href="forcetree_8c-source.html#l00673">673</a> of file <a class="el" href="forcetree_8c-source.html">forcetree.c</a>.
<p>
Referenced by <a class="el" href="forcetree_8c-source.html#l00061">force_treebuild()</a>, and <a class="el" href="predict_8c-source.html#l00031">move_particles()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a77" doxytag="proto.h::force_update_size_of_parent_node"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void force_update_size_of_parent_node           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>no</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a78" doxytag="proto.h::free_memory"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void free_memory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine frees the memory for the particle storage. Note: We don't actually bother to call it in the code... When the program terminats, the memory will be automatically freed by the operating system. 
<p>
Definition at line <a class="el" href="allocate_8c-source.html#l00144">144</a> of file <a class="el" href="allocate_8c-source.html">allocate.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00257">global_data_all_processes::MaxPartSph</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, and <a class="el" href="allvars_8c-source.html#l00127">SphP</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a79" doxytag="proto.h::get_bytes_per_blockelement"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int get_bytes_per_blockelement           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>blocknr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function tells the size of one data entry in each of the blocks defined for the output file. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00366">366</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, and <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a80" doxytag="proto.h::get_dataset_name"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void get_dataset_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>blocknr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function returns a descriptive character string that describes the name of the block when the HDF5 file format is used. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00614">614</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, and <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a81" doxytag="proto.h::get_datatype_in_block"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int get_datatype_in_block           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>blocknr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function returns the type of the data contained in a given block of the output file. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00405">405</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a82" doxytag="proto.h::get_drift_factor"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double get_drift_factor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>time0</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>time1</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function integrates the cosmological prefactor for a drift step between time0 and time1. The value returned is * <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{a_0}^{a_1} \frac{{\rm d}a}{H(a)} * \]" src="form_0.png">
<p>
<p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00067">67</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00095">DRIFT_TABLE_LENGTH</a>, <a class="el" href="allvars_8c-source.html#l00097">DriftTable</a>, and <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>.
<p>
Referenced by <a class="el" href="predict_8c-source.html#l00031">move_particles()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a83" doxytag="proto.h::get_gravkick_factor"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double get_gravkick_factor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>time0</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>time1</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function integrates the cosmological prefactor for a kick step of the gravitational force.<p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00105">105</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00095">DRIFT_TABLE_LENGTH</a>, <a class="el" href="allvars_8c-source.html#l00098">GravKickTable</a>, and <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>.
<p>
Referenced by <a class="el" href="timestep_8c-source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="global_8c-source.html#l00022">compute_global_quantities_of_system()</a>, <a class="el" href="io_8c-source.html#l00129">fill_write_buffer()</a>, and <a class="el" href="predict_8c-source.html#l00031">move_particles()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a84" doxytag="proto.h::get_hydrokick_factor"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double get_hydrokick_factor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>time0</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>time1</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function integrates the cosmological prefactor for a kick step of the hydrodynamical force.<p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00142">142</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00095">DRIFT_TABLE_LENGTH</a>, <a class="el" href="allvars_8c-source.html#l00099">HydroKickTable</a>, and <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>.
<p>
Referenced by <a class="el" href="timestep_8c-source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="global_8c-source.html#l00022">compute_global_quantities_of_system()</a>, <a class="el" href="io_8c-source.html#l00129">fill_write_buffer()</a>, and <a class="el" href="predict_8c-source.html#l00031">move_particles()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a85" doxytag="proto.h::get_particles_in_block"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int get_particles_in_block           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>blocknr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>typelist</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function determines how many particles there are in a given block, based on the information in the header-structure. It also flags particle types that are present in the block in the typelist array. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00465">465</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00161">header</a>, <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>, <a class="el" href="allvars_8h-source.html#l00462">global_data_all_processes::MassTable</a>, and <a class="el" href="allvars_8h-source.html#l00613">io_header::npart</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a86" doxytag="proto.h::get_random_number"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double get_random_number           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>id</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine returns a random number taken from a table of random numbers, which is refilled every timestep. This method is used to allow random number application to particles independent of the number of processors used, and independent of the particular order the particles have. In order to work properly, the particle IDs should be set properly to unique integer values.<p>
&lt; gives the length of a table with random numbers, refreshed at every timestep. This is used to allow application of random numbers to a specific particle in a way that is independent of the number of processors used. 
<p>
Definition at line <a class="el" href="system_8c-source.html#l00029">29</a> of file <a class="el" href="system_8c-source.html">system.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00043">RndTable</a>.
<p>
Referenced by <a class="el" href="timestep_8c-source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="forcetree_8c-source.html#l00093">force_treebuild_single()</a>, <a class="el" href="gravtree__forcetest_8c-source.html#l00028">gravity_forcetest()</a>, and <a class="el" href="init_8c-source.html#l00020">init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a87" doxytag="proto.h::get_timestep"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int get_timestep           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>p</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double *&nbsp;</td>
          <td class="mdname" nowrap> <em>aphys</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>flag</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function normally (for flag==0) returns the maximum allowed timestep of a particle, expressed in terms of the integer mapping that is used to represent the total simulated timespan. The physical acceleration is returned in `aphys'. The latter is used in conjunction with the PSEUDOSYMMETRIC integration option, which also makes of the second function of get_timestep. When it is called with a finite timestep for flag, it returns the physical acceleration that would lead to this timestep, assuming timestep criterion 0.<p>
&lt; adiabatic index of simulated gas <p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 <dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>p</em>&nbsp;</td><td>
particle index </td></tr>
<tr><td valign="top"><em>aphys</em>&nbsp;</td><td>
acceleration (physical units) </td></tr>
<tr><td valign="top"><em>flag</em>&nbsp;</td><td>
either 0 for normal operation, or finite timestep to get corresponding aphys </td></tr>
</table>
</dl>
<p>
Definition at line <a class="el" href="timestep_8c-source.html#l00437">437</a> of file <a class="el" href="timestep_8c-source.html">timestep.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00497">particle_data::GravAccel</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8h-source.html#l00543">sph_particle_data::HydroAccel</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="timestep_8c-source.html#l00024">advance_and_find_timesteps()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a88" doxytag="proto.h::get_values_per_blockelement"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int get_values_per_blockelement           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">enum <a class="el" href="allvars_8h.html#a136">iofields</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>blocknr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function informs about the number of elements stored per particle for the given block of the output file. If one wants to add a new output-block, this function should be augmented accordingly. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00432">432</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8h.html#a136a133">IO_ACCEL</a>, <a class="el" href="allvars_8h.html#a136a134">IO_DTENTR</a>, <a class="el" href="allvars_8h.html#a136a131">IO_HSML</a>, <a class="el" href="allvars_8h.html#a136a127">IO_ID</a>, <a class="el" href="allvars_8h.html#a136a128">IO_MASS</a>, <a class="el" href="allvars_8h.html#a136a125">IO_POS</a>, <a class="el" href="allvars_8h.html#a136a132">IO_POT</a>, <a class="el" href="allvars_8h.html#a136a130">IO_RHO</a>, <a class="el" href="allvars_8h.html#a136a135">IO_TSTP</a>, <a class="el" href="allvars_8h.html#a136a129">IO_U</a>, and <a class="el" href="allvars_8h.html#a136a126">IO_VEL</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a89" doxytag="proto.h::grav_tree_compare_key"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int grav_tree_compare_key           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>b</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is used as a comparison kernel in a sort routine. It is used to group particles in the communication buffer that are going to be sent to the same CPU. 
<p>
Definition at line <a class="el" href="gravtree_8c-source.html#l00511">511</a> of file <a class="el" href="gravtree_8c-source.html">gravtree.c</a>.
<p>
Referenced by <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>, <a class="el" href="gravtree__forcetest_8c-source.html#l00028">gravity_forcetest()</a>, and <a class="el" href="gravtree_8c-source.html#l00027">gravity_tree()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a90" doxytag="proto.h::gravity_forcetest"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void gravity_forcetest           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine does the test of the gravitational tree force by computing the force for a random subset of particles with direct summation. 
<p>
Definition at line <a class="el" href="gravtree__forcetest_8c-source.html#l00028">28</a> of file <a class="el" href="gravtree__forcetest_8c-source.html">gravtree_forcetest.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00692">gravdata_in::Acc</a>, <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00270">global_data_all_processes::BunchSizeForce</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00030">Exportflag</a>, <a class="el" href="allvars_8c-source.html#l00093">FdForceTest</a>, <a class="el" href="allvars_8c-source.html#l00089">FdTimings</a>, <a class="el" href="forcetree_8c-source.html#l02704">force_treeevaluate_direct()</a>, <a class="el" href="allvars_8h-source.html#l00302">global_data_all_processes::G</a>, <a class="el" href="system_8c-source.html#l00029">get_random_number()</a>, <a class="el" href="gravtree_8c-source.html#l00511">grav_tree_compare_key()</a>, <a class="el" href="allvars_8h-source.html#l00497">particle_data::GravAccel</a>, <a class="el" href="allvars_8h-source.html#l00502">particle_data::GravAccelDirect</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataGet</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataIn</a>, <a class="el" href="allvars_8c-source.html#l00186">GravDataIndexTable</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataOut</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataResult</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00717">gravdata_index::Index</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8c-source.html#l00020">NumForceUpdate</a>, <a class="el" href="allvars_8c-source.html#l00015">NumPart</a>, <a class="el" href="allvars_8h-source.html#l00505">particle_data::OldAcc</a>, <a class="el" href="allvars_8h-source.html#l00704">gravdata_in::OldAcc</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, <a class="el" href="allvars_8h-source.html#l00471">global_data_all_processes::OutputDir</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00366">global_data_all_processes::PM_Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00691">gravdata_in::Pos</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="gravtree_8c-source.html#l00454">set_softenings()</a>, <a class="el" href="allvars_8h-source.html#l00718">gravdata_index::SortIndex</a>, <a class="el" href="tags_8h-source.html#l00015">TAG_DIRECT_A</a>, <a class="el" href="tags_8h-source.html#l00016">TAG_DIRECT_B</a>, <a class="el" href="allvars_8h-source.html#l00716">gravdata_index::Task</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8c-source.html#l00079">TimeOfLastTreeConstruction</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, <a class="el" href="structgravdata__in.html#o3">gravdata_in::u</a>, and <a class="el" href="structgravdata__in.html#o6">gravdata_in::w</a>.
<p>
Referenced by <a class="el" href="accel_8c-source.html#l00024">compute_accelerations()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a91" doxytag="proto.h::gravity_tree"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void gravity_tree           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function computes the gravitational forces for all active particles. If needed, a new tree is constructed, otherwise the dynamically updated tree is used. Particles are only exported to other processors when really needed, thereby allowing a good use of the communication buffer. 
<p>
Definition at line <a class="el" href="gravtree_8c-source.html#l00027">27</a> of file <a class="el" href="gravtree_8c-source.html">gravtree.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00692">gravdata_in::Acc</a>, <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00270">global_data_all_processes::BunchSizeForce</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00394">global_data_all_processes::CPU_CommSum</a>, <a class="el" href="allvars_8h-source.html#l00395">global_data_all_processes::CPU_Imbalance</a>, <a class="el" href="allvars_8h-source.html#l00387">global_data_all_processes::CPU_TreeConstruction</a>, <a class="el" href="allvars_8h-source.html#l00388">global_data_all_processes::CPU_TreeWalk</a>, <a class="el" href="allvars_8h-source.html#l00408">global_data_all_processes::ErrTolTheta</a>, <a class="el" href="allvars_8c-source.html#l00030">Exportflag</a>, <a class="el" href="allvars_8c-source.html#l00089">FdTimings</a>, <a class="el" href="forcetree_8c-source.html#l00061">force_treebuild()</a>, <a class="el" href="forcetree_8c-source.html#l01128">force_treeevaluate()</a>, <a class="el" href="forcetree_8c-source.html#l01422">force_treeevaluate_shortrange()</a>, <a class="el" href="allvars_8h-source.html#l00302">global_data_all_processes::G</a>, <a class="el" href="gravtree_8c-source.html#l00511">grav_tree_compare_key()</a>, <a class="el" href="allvars_8h-source.html#l00497">particle_data::GravAccel</a>, <a class="el" href="allvars_8h-source.html#l00518">particle_data::GravCost</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataGet</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataIn</a>, <a class="el" href="allvars_8c-source.html#l00186">GravDataIndexTable</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataOut</a>, <a class="el" href="allvars_8c-source.html#l00180">GravDataResult</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00717">gravdata_index::Index</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00705">gravdata_in::Ninteractions</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00345">global_data_all_processes::NumCurrentTiStep</a>, <a class="el" href="allvars_8c-source.html#l00020">NumForceUpdate</a>, <a class="el" href="allvars_8c-source.html#l00015">NumPart</a>, <a class="el" href="allvars_8h-source.html#l00505">particle_data::OldAcc</a>, <a class="el" href="allvars_8h-source.html#l00704">gravdata_in::OldAcc</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00691">gravdata_in::Pos</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="gravtree_8c-source.html#l00454">set_softenings()</a>, <a class="el" href="allvars_8h-source.html#l00718">gravdata_index::SortIndex</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="tags_8h-source.html#l00013">TAG_GRAV_A</a>, <a class="el" href="tags_8h-source.html#l00014">TAG_GRAV_B</a>, <a class="el" href="allvars_8h-source.html#l00716">gravdata_index::Task</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8h-source.html#l00352">global_data_all_processes::TimeStep</a>, <a class="el" href="allvars_8h-source.html#l00296">global_data_all_processes::TotNumOfForces</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00279">global_data_all_processes::TreeAllocFactor</a>, <a class="el" href="allvars_8c-source.html#l00034">TreeReconstructFlag</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, <a class="el" href="allvars_8h-source.html#l00331">global_data_all_processes::TypeOfOpeningCriterion</a>, <a class="el" href="structgravdata__in.html#o3">gravdata_in::u</a>, and <a class="el" href="structgravdata__in.html#o6">gravdata_in::w</a>.
<p>
Referenced by <a class="el" href="accel_8c-source.html#l00024">compute_accelerations()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a92" doxytag="proto.h::gravity_tree_shortrange"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void gravity_tree_shortrange           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a93" doxytag="proto.h::gravkick_integ"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double gravkick_integ           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>param</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Integration kernel for gravitational kick factor computation. 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00191">191</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, and <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a94" doxytag="proto.h::hydro_compare_key"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int hydro_compare_key           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>b</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This is a comparison kernel for a sort routine, which is used to group particles that are going to be exported to the same CPU. 
<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00563">563</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.
<p>
Referenced by <a class="el" href="hydra_8c-source.html#l00050">hydro_force()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a95" doxytag="proto.h::hydro_evaluate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void hydro_evaluate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is the 'core' of the SPH force computation. A target particle is specified which may either be local, or reside in the communication buffer.<p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00353">353</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00766">hydrodata_out::Acc</a>, <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00288">global_data_all_processes::ArtBulkViscConst</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00546">sph_particle_data::CurlVel</a>, <a class="el" href="allvars_8h-source.html#l00753">hydrodata_in::Density</a>, <a class="el" href="allvars_8h-source.html#l00536">sph_particle_data::Density</a>, <a class="el" href="allvars_8h-source.html#l00756">hydrodata_in::DhsmlDensityFactor</a>, <a class="el" href="allvars_8h-source.html#l00548">sph_particle_data::DhsmlDensityFactor</a>, <a class="el" href="system_8c-source.html#l00105">dmin()</a>, <a class="el" href="allvars_8h-source.html#l00767">hydrodata_out::DtEntropy</a>, <a class="el" href="allvars_8h-source.html#l00542">sph_particle_data::DtEntropy</a>, <a class="el" href="allvars_8h-source.html#l00755">hydrodata_in::F1</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00052">GAMMA</a>, <a class="el" href="allvars_8h-source.html#l00751">hydrodata_in::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00543">sph_particle_data::HydroAccel</a>, <a class="el" href="allvars_8c-source.html#l00201">HydroDataGet</a>, <a class="el" href="allvars_8c-source.html#l00205">HydroDataResult</a>, <a class="el" href="system_8c-source.html#l00115">imax()</a>, <a class="el" href="allvars_8h-source.html#l00111">KERNEL_COEFF_3</a>, <a class="el" href="allvars_8h-source.html#l00114">KERNEL_COEFF_6</a>, <a class="el" href="allvars_8h-source.html#l00752">hydrodata_in::Mass</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00768">hydrodata_out::MaxSignalVel</a>, <a class="el" href="allvars_8h-source.html#l00549">sph_particle_data::MaxSignalVel</a>, <a class="el" href="ngb_8c-source.html#l00064">ngb_treefind_pairs()</a>, <a class="el" href="allvars_8c-source.html#l00032">Ngblist</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00749">hydrodata_in::Pos</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00754">hydrodata_in::Pressure</a>, <a class="el" href="allvars_8h-source.html#l00541">sph_particle_data::Pressure</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>, <a class="el" href="allvars_8h-source.html#l00757">hydrodata_in::Timestep</a>, <a class="el" href="allvars_8h-source.html#l00750">hydrodata_in::Vel</a>, and <a class="el" href="allvars_8h-source.html#l00544">sph_particle_data::VelPred</a>.
<p>
Referenced by <a class="el" href="hydra_8c-source.html#l00050">hydro_force()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a96" doxytag="proto.h::hydro_force"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void hydro_force           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is the driver routine for the calculation of hydrodynamical force and rate of change of entropy due to shock heating for all active particles .<p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="hydra_8c-source.html#l00050">50</a> of file <a class="el" href="hydra_8c-source.html">hydra.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00766">hydrodata_out::Acc</a>, <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="density_8c-source.html#l00028">boxHalf_X</a>, <a class="el" href="density_8c-source.html#l00034">boxHalf_Y</a>, <a class="el" href="density_8c-source.html#l00040">boxHalf_Z</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="density_8c-source.html#l00027">boxSize_X</a>, <a class="el" href="density_8c-source.html#l00033">boxSize_Y</a>, <a class="el" href="density_8c-source.html#l00039">boxSize_Z</a>, <a class="el" href="allvars_8h-source.html#l00272">global_data_all_processes::BunchSizeHydro</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00397">global_data_all_processes::CPU_HydCommSumm</a>, <a class="el" href="allvars_8h-source.html#l00396">global_data_all_processes::CPU_HydCompWalk</a>, <a class="el" href="allvars_8h-source.html#l00398">global_data_all_processes::CPU_HydImbalance</a>, <a class="el" href="allvars_8h-source.html#l00546">sph_particle_data::CurlVel</a>, <a class="el" href="allvars_8h-source.html#l00536">sph_particle_data::Density</a>, <a class="el" href="allvars_8h-source.html#l00753">hydrodata_in::Density</a>, <a class="el" href="allvars_8h-source.html#l00548">sph_particle_data::DhsmlDensityFactor</a>, <a class="el" href="allvars_8h-source.html#l00756">hydrodata_in::DhsmlDensityFactor</a>, <a class="el" href="allvars_8h-source.html#l00767">hydrodata_out::DtEntropy</a>, <a class="el" href="allvars_8h-source.html#l00542">sph_particle_data::DtEntropy</a>, <a class="el" href="allvars_8c-source.html#l00030">Exportflag</a>, <a class="el" href="allvars_8h-source.html#l00755">hydrodata_in::F1</a>, <a class="el" href="allvars_8h-source.html#l00052">GAMMA</a>, <a class="el" href="allvars_8h-source.html#l00055">GAMMA_MINUS1</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00751">hydrodata_in::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="hydra_8c-source.html#l00563">hydro_compare_key()</a>, <a class="el" href="hydra_8c-source.html#l00353">hydro_evaluate()</a>, <a class="el" href="allvars_8h-source.html#l00543">sph_particle_data::HydroAccel</a>, <a class="el" href="allvars_8c-source.html#l00201">HydroDataGet</a>, <a class="el" href="allvars_8c-source.html#l00201">HydroDataIn</a>, <a class="el" href="allvars_8c-source.html#l00205">HydroDataPartialResult</a>, <a class="el" href="allvars_8c-source.html#l00205">HydroDataResult</a>, <a class="el" href="allvars_8h-source.html#l00507">particle_data::ID</a>, <a class="el" href="allvars_8h-source.html#l00759">hydrodata_in::Index</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00752">hydrodata_in::Mass</a>, <a class="el" href="allvars_8h-source.html#l00768">hydrodata_out::MaxSignalVel</a>, <a class="el" href="allvars_8h-source.html#l00549">sph_particle_data::MaxSignalVel</a>, <a class="el" href="allvars_8c-source.html#l00016">N_gas</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8c-source.html#l00021">NumSphUpdate</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00749">hydrodata_in::Pos</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="allvars_8h-source.html#l00541">sph_particle_data::Pressure</a>, <a class="el" href="allvars_8h-source.html#l00754">hydrodata_in::Pressure</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="tags_8h-source.html#l00017">TAG_HYDRO_A</a>, <a class="el" href="tags_8h-source.html#l00018">TAG_HYDRO_B</a>, <a class="el" href="allvars_8h-source.html#l00758">hydrodata_in::Task</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8h-source.html#l00757">hydrodata_in::Timestep</a>, <a class="el" href="allvars_8h-source.html#l00750">hydrodata_in::Vel</a>, and <a class="el" href="allvars_8h-source.html#l00544">sph_particle_data::VelPred</a>.
<p>
Referenced by <a class="el" href="accel_8c-source.html#l00024">compute_accelerations()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a97" doxytag="proto.h::hydrokick_integ"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double hydrokick_integ           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>param</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Integration kernel for hydrodynamical kick factor computation.<p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00204">204</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00055">GAMMA_MINUS1</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, and <a class="el" href="proto_8h.html#a133">pow()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a98" doxytag="proto.h::imax"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int imax           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns the maximum of two integers 
<p>
Definition at line <a class="el" href="system_8c-source.html#l00115">115</a> of file <a class="el" href="system_8c-source.html">system.c</a>.
<p>
Referenced by <a class="el" href="hydra_8c-source.html#l00353">hydro_evaluate()</a>, and <a class="el" href="pm__periodic_8c-source.html#l00114">pm_init_periodic_allocate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a99" doxytag="proto.h::imin"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int imin           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns the minimum of two integers 
<p>
Definition at line <a class="el" href="system_8c-source.html#l00125">125</a> of file <a class="el" href="system_8c-source.html">system.c</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00534">domain_findExchangeNumbers()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a100" doxytag="proto.h::init"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function reads the initial conditions, and allocates storage for the tree. Various variables of the particle data are initialised and An intial domain decomposition is performed. If SPH particles are present, the inial SPH smoothing lengths are determined.<p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 <p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 <p>
&lt; defines maximum length of neighbour list <p>
&lt; adiabatic index of simulated gas <p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="init_8c-source.html#l00020">20</a> of file <a class="el" href="init_8c-source.html">init.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="init_8c-source.html#l00165">check_omega()</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00536">sph_particle_data::Density</a>, <a class="el" href="domain_8c-source.html#l00062">domain_Decomposition()</a>, <a class="el" href="allvars_8h-source.html#l00542">sph_particle_data::DtEntropy</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8h-source.html#l00535">sph_particle_data::Entropy</a>, <a class="el" href="allvars_8h-source.html#l00631">io_header::flag_entropy_instead_u</a>, <a class="el" href="allvars_8c-source.html#l00036">Flag_FullStep</a>, <a class="el" href="forcetree_8c-source.html#l02622">force_treeallocate()</a>, <a class="el" href="allvars_8h-source.html#l00055">GAMMA_MINUS1</a>, <a class="el" href="system_8c-source.html#l00029">get_random_number()</a>, <a class="el" href="allvars_8h-source.html#l00497">particle_data::GravAccel</a>, <a class="el" href="allvars_8h-source.html#l00518">particle_data::GravCost</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8c-source.html#l00161">header</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00543">sph_particle_data::HydroAccel</a>, <a class="el" href="allvars_8h-source.html#l00261">global_data_all_processes::ICFormat</a>, <a class="el" href="allvars_8h-source.html#l00470">global_data_all_processes::InitCondFile</a>, <a class="el" href="allvars_8h-source.html#l00091">MAX_NGB</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="ngb_8c-source.html#l00358">ngb_treeallocate()</a>, <a class="el" href="ngb_8c-source.html#l00403">ngb_treebuild()</a>, <a class="el" href="allvars_8h-source.html#l00345">global_data_all_processes::NumCurrentTiStep</a>, <a class="el" href="allvars_8h-source.html#l00297">global_data_all_processes::NumForcesSinceLastDomainDecomp</a>, <a class="el" href="allvars_8h-source.html#l00505">particle_data::OldAcc</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00329">global_data_all_processes::PeriodicBoundariesOn</a>, <a class="el" href="allvars_8h-source.html#l00367">global_data_all_processes::PM_Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00366">global_data_all_processes::PM_Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00504">particle_data::Potential</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="read__ic_8c-source.html#l00031">read_ic()</a>, <a class="el" href="allvars_8c-source.html#l00026">RestartFlag</a>, <a class="el" href="proto_8h.html#a146">seed_glass()</a>, <a class="el" href="gravtree_8c-source.html#l00454">set_softenings()</a>, <a class="el" href="init_8c-source.html#l00202">setup_smoothinglengths()</a>, <a class="el" href="allvars_8h-source.html#l00338">global_data_all_processes::SnapshotFileCount</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="allvars_8h-source.html#l00025">TIMEBASE</a>, <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>, <a class="el" href="allvars_8h-source.html#l00351">global_data_all_processes::TimeBegin</a>, <a class="el" href="allvars_8h-source.html#l00343">global_data_all_processes::TimeBetStatistics</a>, <a class="el" href="allvars_8h-source.html#l00344">global_data_all_processes::TimeLastStatistics</a>, <a class="el" href="allvars_8h-source.html#l00353">global_data_all_processes::TimeMax</a>, <a class="el" href="allvars_8h-source.html#l00296">global_data_all_processes::TotNumOfForces</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00279">global_data_all_processes::TreeAllocFactor</a>, <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>, <a class="el" href="allvars_8c-source.html#l00034">TreeReconstructFlag</a>, <a class="el" href="allvars_8h-source.html#l00496">particle_data::Vel</a>, and <a class="el" href="allvars_8h-source.html#l00544">sph_particle_data::VelPred</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a101" doxytag="proto.h::init_drift_table"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void init_drift_table           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function computes look-up tables for factors needed in cosmological integrations. The (simple) integrations are carried out with the GSL library. Separate factors are computed for the "drift", and the gravitational and hydrodynamical "kicks". The lookup-table is used for reasons of speed.<p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00026">26</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00095">DRIFT_TABLE_LENGTH</a>, <a class="el" href="allvars_8c-source.html#l00097">DriftTable</a>, <a class="el" href="allvars_8c-source.html#l00098">GravKickTable</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8c-source.html#l00099">HydroKickTable</a>, <a class="el" href="allvars_8h-source.html#l00351">global_data_all_processes::TimeBegin</a>, <a class="el" href="allvars_8h-source.html#l00353">global_data_all_processes::TimeMax</a>, and <a class="el" href="driftfac_8c.html#a0">WORKSIZE</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a102" doxytag="proto.h::init_peano_map"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void init_peano_map           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a103" doxytag="proto.h::long_range_force"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void long_range_force           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is a driver routine for the long-range PM force computation. It calls periodic and/or non-periodic FFT routines as needed for the present simulation set-up. 
<p>
Definition at line <a class="el" href="longrange_8c-source.html#l00056">56</a> of file <a class="el" href="longrange_8c-source.html">longrange.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="proto_8h.html#a127">pm_init_regionsize()</a>, <a class="el" href="proto_8h.html#a128">pm_setup_nonperiodic_kernel()</a>, <a class="el" href="proto_8h.html#a129">pmforce_nonperiodic()</a>, <a class="el" href="pm__periodic_8c-source.html#l00181">pmforce_periodic()</a>, and <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>.
<p>
Referenced by <a class="el" href="accel_8c-source.html#l00024">compute_accelerations()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a104" doxytag="proto.h::long_range_init"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void long_range_init           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Calls initializiation routines of periodic or/and non-periodic FFT routines. 
<p>
Definition at line <a class="el" href="longrange_8c-source.html#l00020">20</a> of file <a class="el" href="longrange_8c-source.html">longrange.c</a>.
<p>
References <a class="el" href="proto_8h.html#a121">pm_init_nonperiodic()</a>, and <a class="el" href="pm__periodic_8c-source.html#l00055">pm_init_periodic()</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a105" doxytag="proto.h::long_range_init_regionsize"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void long_range_init_regionsize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function calls subroutines that determine the spatial region covered by the PM mesh. 
<p>
Definition at line <a class="el" href="longrange_8c-source.html#l00036">36</a> of file <a class="el" href="longrange_8c-source.html">longrange.c</a>.
<p>
References <a class="el" href="proto_8h.html#a127">pm_init_regionsize()</a>, <a class="el" href="proto_8h.html#a128">pm_setup_nonperiodic_kernel()</a>, and <a class="el" href="allvars_8c-source.html#l00026">RestartFlag</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a106" doxytag="proto.h::move_particles"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void move_particles           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>time0</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>time1</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function drifts all particles from the current time to the future: time0 - &gt; time1<p>
If there is no explicit tree construction in the following timestep, the tree nodes are also drifted and updated accordingly. Note: For periodic boundary conditions, the mapping of coordinates onto the interval [0,All.BoxSize] is only done before the domain decomposition, or for outputs to snapshot files. This simplifies dynamic tree updates, and allows the domain decomposition to be carried out only every once in a while.<p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="predict_8c-source.html#l00031">31</a> of file <a class="el" href="predict_8c-source.html">predict.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00401">global_data_all_processes::CPU_Predict</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8h-source.html#l00536">sph_particle_data::Density</a>, <a class="el" href="allvars_8h-source.html#l00542">sph_particle_data::DtEntropy</a>, <a class="el" href="allvars_8h-source.html#l00535">sph_particle_data::Entropy</a>, <a class="el" href="allvars_8c-source.html#l00151">Extnodes</a>, <a class="el" href="forcetree_8c-source.html#l00887">force_update_len()</a>, <a class="el" href="forcetree_8c-source.html#l00673">force_update_pseudoparticles()</a>, <a class="el" href="allvars_8h-source.html#l00052">GAMMA</a>, <a class="el" href="driftfac_8c-source.html#l00067">get_drift_factor()</a>, <a class="el" href="driftfac_8c-source.html#l00105">get_gravkick_factor()</a>, <a class="el" href="driftfac_8c-source.html#l00142">get_hydrokick_factor()</a>, <a class="el" href="allvars_8h-source.html#l00497">particle_data::GravAccel</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00543">sph_particle_data::HydroAccel</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00441">global_data_all_processes::MinGasHsml</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8h-source.html#l00297">global_data_all_processes::NumForcesSinceLastDomainDecomp</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="allvars_8h-source.html#l00541">sph_particle_data::Pressure</a>, <a class="el" href="allvars_8h-source.html#l00577">NODE::s</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, <a class="el" href="structNODE.html#o10">NODE::u</a>, <a class="el" href="allvars_8h-source.html#l00496">particle_data::Vel</a>, <a class="el" href="allvars_8h-source.html#l00544">sph_particle_data::VelPred</a>, and <a class="el" href="allvars_8h-source.html#l00600">extNODE::vs</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a107" doxytag="proto.h::my_fread"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">size_t my_fread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname" nowrap> <em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>nmemb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>stream</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This catches I/O errors occuring for fread(). In this case we better stop. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l01141">1141</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a108" doxytag="proto.h::my_fwrite"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">size_t my_fwrite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname" nowrap> <em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>nmemb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>stream</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This catches I/O errors occuring for <a class="el" href="io_8c.html#a14">my_fwrite()</a>. In this case we better stop. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l01124">1124</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a109" doxytag="proto.h::ngb_clear_buf"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ngb_clear_buf           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">float&nbsp;</td>
          <td class="mdname" nowrap> <em>searchcenter</em>[3], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>float&nbsp;</td>
          <td class="mdname" nowrap> <em>hsml</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>numngb</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The buffer for the neighbour list has a finite length MAX_NGB. For a large search region, this buffer can get full, in which case this routine can be called to eliminate some of the superfluous particles in the "corners" of the search box - only the ones in the inscribed sphere need to be kept. 
<p>
Definition at line <a class="el" href="ngb_8c-source.html#l00320">320</a> of file <a class="el" href="ngb_8c-source.html">ngb.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="ngb_8c-source.html#l00047">NGB_PERIODIC_X</a>, <a class="el" href="ngb_8c-source.html#l00048">NGB_PERIODIC_Y</a>, <a class="el" href="ngb_8c-source.html#l00049">NGB_PERIODIC_Z</a>, <a class="el" href="allvars_8c-source.html#l00032">Ngblist</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, and <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>.
<p>
Referenced by <a class="el" href="ngb_8c-source.html#l00194">ngb_treefind_variable()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a110" doxytag="proto.h::ngb_treeallocate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ngb_treeallocate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>npart</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocates memory for the neighbour list buffer. 
<p>
Definition at line <a class="el" href="ngb_8c-source.html#l00358">358</a> of file <a class="el" href="ngb_8c-source.html">ngb.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="density_8c-source.html#l00028">boxHalf_X</a>, <a class="el" href="density_8c-source.html#l00034">boxHalf_Y</a>, <a class="el" href="density_8c-source.html#l00040">boxHalf_Z</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="density_8c-source.html#l00027">boxSize_X</a>, <a class="el" href="density_8c-source.html#l00033">boxSize_Y</a>, <a class="el" href="density_8c-source.html#l00039">boxSize_Z</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00032">Ngblist</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="init_8c-source.html#l00020">init()</a>, and <a class="el" href="restart_8c-source.html#l00035">restart()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a111" doxytag="proto.h::ngb_treebuild"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ngb_treebuild           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function constructs the neighbour tree. To this end, we actually need to construct the gravitational tree, because we use it now for the neighbour search. 
<p>
Definition at line <a class="el" href="ngb_8c-source.html#l00403">403</a> of file <a class="el" href="ngb_8c-source.html">ngb.c</a>.
<p>
References <a class="el" href="forcetree_8c-source.html#l00061">force_treebuild()</a>, <a class="el" href="allvars_8c-source.html#l00016">N_gas</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="init_8c-source.html#l00020">init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a112" doxytag="proto.h::ngb_treefind_pairs"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ngb_treefind_pairs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">float&nbsp;</td>
          <td class="mdname" nowrap> <em>searchcenter</em>[3], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>float&nbsp;</td>
          <td class="mdname" nowrap> <em>hsml</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>startnode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine finds all neighbours `j' that can interact with the particle `i' in the communication buffer.<p>
Note that an interaction can take place if <img class="formulaInl" alt="$ r_{ij} < h_i $" src="form_9.png"> OR if <img class="formulaInl" alt="$ r_{ij} < h_j $" src="form_10.png">.<p>
In the range-search this is taken into account, i.e. it is guaranteed that all particles are found that fulfil this condition, including the (more difficult) second part of it. For this purpose, each node knows the maximum h occuring among the particles it represents.<p>
&lt; defines maximum length of neighbour list 
<p>
Definition at line <a class="el" href="ngb_8c-source.html#l00064">64</a> of file <a class="el" href="ngb_8c-source.html">ngb.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8c-source.html#l00058">DomainTask</a>, <a class="el" href="allvars_8c-source.html#l00030">Exportflag</a>, <a class="el" href="allvars_8c-source.html#l00151">Extnodes</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00599">extNODE::hmax</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8c-source.html#l00147">Nextnode</a>, <a class="el" href="ngb_8c-source.html#l00047">NGB_PERIODIC_X</a>, <a class="el" href="ngb_8c-source.html#l00048">NGB_PERIODIC_Y</a>, <a class="el" href="ngb_8c-source.html#l00049">NGB_PERIODIC_Z</a>, <a class="el" href="allvars_8c-source.html#l00032">Ngblist</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="hydra_8c-source.html#l00353">hydro_evaluate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a113" doxytag="proto.h::ngb_treefind_variable"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ngb_treefind_variable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">float&nbsp;</td>
          <td class="mdname" nowrap> <em>searchcenter</em>[3], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>float&nbsp;</td>
          <td class="mdname" nowrap> <em>hsml</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>startnode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function returns neighbours with distance &lt;= hsml and returns them in Ngblist. Actually, particles in a box of half side length hsml are returned, i.e. the reduction to a sphere still needs to be done in the calling routine.<p>
&lt; defines maximum length of neighbour list <p>
&lt; defines maximum length of neighbour list 
<p>
Definition at line <a class="el" href="ngb_8c-source.html#l00194">194</a> of file <a class="el" href="ngb_8c-source.html">ngb.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8c-source.html#l00058">DomainTask</a>, <a class="el" href="allvars_8c-source.html#l00030">Exportflag</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00581">NODE::nextnode</a>, <a class="el" href="allvars_8c-source.html#l00147">Nextnode</a>, <a class="el" href="ngb_8c-source.html#l00320">ngb_clear_buf()</a>, <a class="el" href="ngb_8c-source.html#l00047">NGB_PERIODIC_X</a>, <a class="el" href="ngb_8c-source.html#l00048">NGB_PERIODIC_Y</a>, <a class="el" href="ngb_8c-source.html#l00049">NGB_PERIODIC_Z</a>, <a class="el" href="allvars_8c-source.html#l00032">Ngblist</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00580">NODE::sibling</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, and <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>.
<p>
Referenced by <a class="el" href="density_8c-source.html#l00467">density_evaluate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a114" doxytag="proto.h::ngb_treefree"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ngb_treefree           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
free memory allocated for neighbour list buffer. 
<p>
Definition at line <a class="el" href="ngb_8c-source.html#l00394">394</a> of file <a class="el" href="ngb_8c-source.html">ngb.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00032">Ngblist</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a115" doxytag="proto.h::ngb_treesearch"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ngb_treesearch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a116" doxytag="proto.h::ngb_treesearch_pairs"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ngb_treesearch_pairs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a117" doxytag="proto.h::ngb_update_nodes"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ngb_update_nodes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a118" doxytag="proto.h::open_outputfiles"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void open_outputfiles           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function opens various log-files that report on the status and performance of the simulstion. On restart from restart-files (start-option 1), the code will append to these files. 
<p>
Definition at line <a class="el" href="begrun_8c-source.html#l00199">199</a> of file <a class="el" href="begrun_8c-source.html">begrun.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00474">global_data_all_processes::CpuFile</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8h-source.html#l00473">global_data_all_processes::EnergyFile</a>, <a class="el" href="allvars_8c-source.html#l00090">FdCPU</a>, <a class="el" href="allvars_8c-source.html#l00088">FdEnergy</a>, <a class="el" href="allvars_8c-source.html#l00093">FdForceTest</a>, <a class="el" href="allvars_8c-source.html#l00087">FdInfo</a>, <a class="el" href="allvars_8c-source.html#l00089">FdTimings</a>, <a class="el" href="allvars_8h-source.html#l00475">global_data_all_processes::InfoFile</a>, <a class="el" href="allvars_8h-source.html#l00471">global_data_all_processes::OutputDir</a>, <a class="el" href="allvars_8c-source.html#l00026">RestartFlag</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, and <a class="el" href="allvars_8h-source.html#l00476">global_data_all_processes::TimingsFile</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a119" doxytag="proto.h::peano_hilbert_key"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="allvars_8h.html#a45">peanokey</a> peano_hilbert_key           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>z</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>bits</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function computes a Peano-Hilbert key for an integer triplet (x,y,z), with x,y,z in the range between 0 and 2^bits-1. 
<p>
Definition at line <a class="el" href="peano_8c-source.html#l00263">263</a> of file <a class="el" href="peano_8c-source.html">peano.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00032">peanokey</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00898">domain_determineTopTree()</a>, <a class="el" href="forcetree_8c-source.html#l00294">force_create_empty_nodes()</a>, and <a class="el" href="forcetree_8c-source.html#l00093">force_treebuild_single()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a120" doxytag="proto.h::peano_hilbert_order"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void peano_hilbert_order           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function puts the particles into Peano-Hilbert order by sorting them according to their keys. The latter half already been computed in the domain decomposition. Since gas particles need to stay at the beginning of the particle list, they are sorted as a separate block. 
<p>
Definition at line <a class="el" href="peano_8c-source.html#l00034">34</a> of file <a class="el" href="peano_8c-source.html">peano.c</a>.
<p>
References <a class="el" href="peano_8c-source.html#l00098">compare_key()</a>, <a class="el" href="allvars_8c-source.html#l00068">Key</a>, <a class="el" href="allvars_8c-source.html#l00016">N_gas</a>, <a class="el" href="allvars_8c-source.html#l00015">NumPart</a>, <a class="el" href="peano_8c-source.html#l00117">reorder_gas()</a>, <a class="el" href="peano_8c-source.html#l00166">reorder_particles()</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="domain_8c-source.html#l00062">domain_Decomposition()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a121" doxytag="proto.h::pm_init_nonperiodic"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pm_init_nonperiodic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="longrange_8c-source.html#l00020">long_range_init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a122" doxytag="proto.h::pm_init_nonperiodic_allocate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pm_init_nonperiodic_allocate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dimprod</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a123" doxytag="proto.h::pm_init_nonperiodic_free"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pm_init_nonperiodic_free           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a124" doxytag="proto.h::pm_init_periodic"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pm_init_periodic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routines generates the FFTW-plans to carry out the parallel FFTs later on. Some auxiliary variables are also initialized.<p>
&lt; @-ASMTH gives the scale of the short-range/long-range force split in units of FFT-mesh cells <p>
&lt; @-RCUT gives the maximum distance (in units of the scale used for the force split) out to which short-range forces are evaluated in the short-range tree walk. 
<p>
Definition at line <a class="el" href="pm__periodic_8c-source.html#l00055">55</a> of file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00083">ASMTH</a>, <a class="el" href="allvars_8h-source.html#l00374">global_data_all_processes::Asmth</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00087">RCUT</a>, <a class="el" href="allvars_8h-source.html#l00375">global_data_all_processes::Rcut</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="longrange_8c-source.html#l00020">long_range_init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a125" doxytag="proto.h::pm_init_periodic_allocate"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pm_init_periodic_allocate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dimprod</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function allocates the memory neeed to compute the long-range PM force. Three fields are used, one to hold the density (and its FFT, and then the real-space potential), one to hold the force field obtained by finite differencing, and finally a workspace field, which is used both as workspace for the parallel FFT, and as buffer for the communication algorithm used in the force computation. 
<p>
Definition at line <a class="el" href="pm__periodic_8c-source.html#l00114">114</a> of file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.
<p>
References <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="system_8c-source.html#l00115">imax()</a>, and <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>.
<p>
Referenced by <a class="el" href="pm__periodic_8c-source.html#l00181">pmforce_periodic()</a>, and <a class="el" href="pm__periodic_8c-source.html#l00694">pmpotential_periodic()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a126" doxytag="proto.h::pm_init_periodic_free"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pm_init_periodic_free           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine frees the space allocated for the parallel FFT algorithm. 
<p>
Definition at line <a class="el" href="pm__periodic_8c-source.html#l00161">161</a> of file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.
<p>
Referenced by <a class="el" href="pm__periodic_8c-source.html#l00181">pmforce_periodic()</a>, and <a class="el" href="pm__periodic_8c-source.html#l00694">pmpotential_periodic()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a127" doxytag="proto.h::pm_init_regionsize"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pm_init_regionsize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>, <a class="el" href="longrange_8c-source.html#l00056">long_range_force()</a>, and <a class="el" href="longrange_8c-source.html#l00036">long_range_init_regionsize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a128" doxytag="proto.h::pm_setup_nonperiodic_kernel"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pm_setup_nonperiodic_kernel           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>, <a class="el" href="longrange_8c-source.html#l00056">long_range_force()</a>, and <a class="el" href="longrange_8c-source.html#l00036">long_range_init_regionsize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a129" doxytag="proto.h::pmforce_nonperiodic"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pmforce_nonperiodic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>grnr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="longrange_8c-source.html#l00056">long_range_force()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a130" doxytag="proto.h::pmforce_periodic"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pmforce_periodic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Calculates the long-range periodic force given the particle positions using the PM method. The force is Gaussian filtered with Asmth, given in mesh-cell units. We carry out a CIC charge assignment, and compute the potenial by Fourier transform methods. The potential is finite differenced using a 4-point finite differencing formula, and the forces are interpolated tri-linearly to the particle positions. The CIC kernel is deconvolved. Note that the particle distribution is not in the slab decomposition that is used for the FFT. Instead, overlapping patches between local domains and FFT slabs are communicated as needed. 
<p>
Definition at line <a class="el" href="pm__periodic_8c-source.html#l00181">181</a> of file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00374">global_data_all_processes::Asmth</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="forcetree_8c-source.html#l02622">force_treeallocate()</a>, <a class="el" href="forcetree_8c-source.html#l02687">force_treefree()</a>, <a class="el" href="allvars_8h-source.html#l00302">global_data_all_processes::G</a>, <a class="el" href="allvars_8h-source.html#l00499">particle_data::GravPM</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00297">global_data_all_processes::NumForcesSinceLastDomainDecomp</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="pm__periodic_8c-source.html#l00114">pm_init_periodic_allocate()</a>, <a class="el" href="pm__periodic_8c-source.html#l00161">pm_init_periodic_free()</a>, <a class="el" href="pm__periodic_8c-source.html#l00029">PMGRID2</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="tags_8h-source.html#l00020">TAG_PERIODIC_A</a>, <a class="el" href="tags_8h-source.html#l00021">TAG_PERIODIC_B</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00279">global_data_all_processes::TreeAllocFactor</a>, and <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>.
<p>
Referenced by <a class="el" href="longrange_8c-source.html#l00056">long_range_force()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a131" doxytag="proto.h::pmpotential_nonperiodic"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int pmpotential_nonperiodic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>grnr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a132" doxytag="proto.h::pmpotential_periodic"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void pmpotential_periodic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Calculates the long-range potential using the PM method. The potential is Gaussian filtered with Asmth, given in mesh-cell units. We carry out a CIC charge assignment, and compute the potenial by Fourier transform methods. The CIC kernel is deconvolved. 
<p>
Definition at line <a class="el" href="pm__periodic_8c-source.html#l00694">694</a> of file <a class="el" href="pm__periodic_8c-source.html">pm_periodic.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00374">global_data_all_processes::Asmth</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="forcetree_8c-source.html#l02622">force_treeallocate()</a>, <a class="el" href="forcetree_8c-source.html#l02687">force_treefree()</a>, <a class="el" href="allvars_8h-source.html#l00302">global_data_all_processes::G</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00297">global_data_all_processes::NumForcesSinceLastDomainDecomp</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="pm__periodic_8c-source.html#l00114">pm_init_periodic_allocate()</a>, <a class="el" href="pm__periodic_8c-source.html#l00161">pm_init_periodic_free()</a>, <a class="el" href="pm__periodic_8c-source.html#l00029">PMGRID2</a>, <a class="el" href="allvars_8h-source.html#l00494">particle_data::Pos</a>, <a class="el" href="allvars_8h-source.html#l00504">particle_data::Potential</a>, <a class="el" href="tags_8h-source.html#l00022">TAG_PERIODIC_C</a>, <a class="el" href="tags_8h-source.html#l00023">TAG_PERIODIC_D</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00279">global_data_all_processes::TreeAllocFactor</a>, and <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>.
<p>
Referenced by <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a133" doxytag="proto.h::pow"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double pow           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="timestep_8c-source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="global_8c-source.html#l00022">compute_global_quantities_of_system()</a>, <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>, <a class="el" href="density_8c-source.html#l00056">density()</a>, <a class="el" href="io_8c-source.html#l00129">fill_write_buffer()</a>, <a class="el" href="driftfac_8c-source.html#l00214">growthfactor_integ()</a>, <a class="el" href="hydra_8c-source.html#l00050">hydro_force()</a>, <a class="el" href="driftfac_8c-source.html#l00204">hydrokick_integ()</a>, <a class="el" href="init_8c-source.html#l00020">init()</a>, <a class="el" href="predict_8c-source.html#l00031">move_particles()</a>, <a class="el" href="begrun_8c-source.html#l00149">set_units()</a>, <a class="el" href="init_8c-source.html#l00202">setup_smoothinglengths()</a>, and <a class="el" href="system_8c-source.html#l00074">timediff()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a134" doxytag="proto.h::read_file"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void read_file           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>readTask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>lastTask</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function reads a snapshot file and distributes the data it contains to tasks 'readTask' to 'lastTask'.<p>
&lt; total number of defined information blocks for snapshot files. Must be equal to the number of entries in "enum iofields" 
<p>
Definition at line <a class="el" href="read__ic_8c-source.html#l00244">244</a> of file <a class="el" href="read__ic_8c-source.html">read_ic.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allocate_8c-source.html#l00103">allocate_memory()</a>, <a class="el" href="io_8c-source.html#l00532">blockpresent()</a>, <a class="el" href="allvars_8h-source.html#l00269">global_data_all_processes::BufferSize</a>, <a class="el" href="allvars_8c-source.html#l00101">CommBuffer</a>, <a class="el" href="read__ic_8c-source.html#l00168">empty_read_buffer()</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="io_8c-source.html#l00366">get_bytes_per_blockelement()</a>, <a class="el" href="io_8c-source.html#l00614">get_dataset_name()</a>, <a class="el" href="io_8c-source.html#l00405">get_datatype_in_block()</a>, <a class="el" href="io_8c-source.html#l00465">get_particles_in_block()</a>, <a class="el" href="io_8c-source.html#l00432">get_values_per_blockelement()</a>, <a class="el" href="allvars_8c-source.html#l00161">header</a>, <a class="el" href="allvars_8h-source.html#l00261">global_data_all_processes::ICFormat</a>, <a class="el" href="allvars_8h-source.html#l00640">iofields</a>, <a class="el" href="allvars_8h-source.html#l00614">io_header::mass</a>, <a class="el" href="allvars_8h-source.html#l00462">global_data_all_processes::MassTable</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00257">global_data_all_processes::MaxPartSph</a>, <a class="el" href="io_8c-source.html#l01141">my_fread()</a>, <a class="el" href="allvars_8c-source.html#l00016">N_gas</a>, <a class="el" href="allvars_8h-source.html#l00613">io_header::npart</a>, <a class="el" href="allvars_8h-source.html#l00620">io_header::npartTotal</a>, <a class="el" href="allvars_8h-source.html#l00630">io_header::npartTotalHighWord</a>, <a class="el" href="allvars_8h-source.html#l00623">io_header::num_files</a>, <a class="el" href="allvars_8c-source.html#l00015">NumPart</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00275">global_data_all_processes::PartAllocFactor</a>, <a class="el" href="read__ic_8c-source.html#l00765">read_header_attributes_in_hdf5()</a>, <a class="el" href="allvars_8c-source.html#l00026">RestartFlag</a>, <a class="el" href="allvars_8c-source.html#l00167">Tab_IO_Labels</a>, <a class="el" href="tags_8h-source.html#l00006">TAG_HEADER</a>, <a class="el" href="tags_8h-source.html#l00007">TAG_PDATA</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="allvars_8h-source.html#l00616">io_header::time</a>, <a class="el" href="allvars_8h-source.html#l00351">global_data_all_processes::TimeBegin</a>, <a class="el" href="allvars_8h-source.html#l00254">global_data_all_processes::TotN_gas</a>, and <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00031">read_ic()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a135" doxytag="proto.h::read_header_attributes_in_hdf5"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void read_header_attributes_in_hdf5           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fname</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function reads the header information in case the HDF5 file format is used. 
<p>
Definition at line <a class="el" href="read__ic_8c-source.html#l00765">765</a> of file <a class="el" href="read__ic_8c-source.html">read_ic.c</a>.
<p>
References <a class="el" href="allvars_8h-source.html#l00631">io_header::flag_entropy_instead_u</a>, <a class="el" href="allvars_8c-source.html#l00161">header</a>, <a class="el" href="allvars_8h-source.html#l00614">io_header::mass</a>, <a class="el" href="allvars_8h-source.html#l00613">io_header::npart</a>, <a class="el" href="allvars_8h-source.html#l00620">io_header::npartTotal</a>, <a class="el" href="allvars_8h-source.html#l00630">io_header::npartTotalHighWord</a>, <a class="el" href="allvars_8h-source.html#l00623">io_header::num_files</a>, and <a class="el" href="allvars_8h-source.html#l00616">io_header::time</a>.
<p>
Referenced by <a class="el" href="read__ic_8c-source.html#l00616">find_files()</a>, and <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a136" doxytag="proto.h::read_ic"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void read_ic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fname</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function reads initial conditions, in one of the three possible file formats currently supported by Gadget. Note: When a snapshot file is started from initial conditions (start-option 0), not all the information in the header is used, in particular, the STARTING TIME needs to be set in the parameterfile. Also, for gas particles, only the internal energy is read, the density and mean molecular weight will be recomputed by the code. When InitGasTemp&gt;0 is given, the gas temperature will be initialzed to this value assuming a mean colecular weight either corresponding to complete neutrality, or full ionization.<p>
However, when the code is started with start-option 2, then all the this data in the snapshot files is preserved, i.e. this is also the way to resume a simulation from a snapshot file in case a regular restart file is not available.<p>
&lt; adiabatic index of simulated gas <p>
&lt; mass fraction of hydrogen, relevant only for radiative cooling <p>
&lt; mass fraction of hydrogen, relevant only for radiative cooling 
<p>
Definition at line <a class="el" href="read__ic_8c-source.html#l00031">31</a> of file <a class="el" href="read__ic_8c-source.html">read_ic.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00066">BOLTZMANN</a>, <a class="el" href="read__ic_8c-source.html#l00725">distribute_file()</a>, <a class="el" href="system_8c-source.html#l00095">dmax()</a>, <a class="el" href="allvars_8h-source.html#l00535">sph_particle_data::Entropy</a>, <a class="el" href="io_8c-source.html#l00566">fill_Tab_IO_Labels()</a>, <a class="el" href="read__ic_8c-source.html#l00616">find_files()</a>, <a class="el" href="allvars_8h-source.html#l00261">global_data_all_processes::ICFormat</a>, <a class="el" href="allvars_8h-source.html#l00289">global_data_all_processes::InitGasTemp</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8h-source.html#l00462">global_data_all_processes::MassTable</a>, <a class="el" href="allvars_8h-source.html#l00291">global_data_all_processes::MinEgySpec</a>, <a class="el" href="allvars_8c-source.html#l00016">N_gas</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00266">global_data_all_processes::NumFilesWrittenInParallel</a>, <a class="el" href="allvars_8c-source.html#l00015">NumPart</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="read__ic_8c-source.html#l00244">read_file()</a>, <a class="el" href="allvars_8c-source.html#l00026">RestartFlag</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, <a class="el" href="allvars_8h-source.html#l00310">global_data_all_processes::UnitEnergy_in_cgs</a>, and <a class="el" href="allvars_8h-source.html#l00304">global_data_all_processes::UnitMass_in_g</a>.
<p>
Referenced by <a class="el" href="init_8c-source.html#l00020">init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a137" doxytag="proto.h::read_outputlist"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int read_outputlist           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fname</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
this function reads a table with a list of desired output times. The table does not have to be ordered in any way, but may not contain more than MAXLEN_OUTPUTLIST entries.<p>
&lt; maxmimum number of entries in list of snapshot output times 
<p>
Definition at line <a class="el" href="begrun_8c-source.html#l00759">759</a> of file <a class="el" href="begrun_8c-source.html">begrun.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00482">global_data_all_processes::OutputListLength</a>, and <a class="el" href="allvars_8h-source.html#l00481">global_data_all_processes::OutputListTimes</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00280">read_parameter_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a138" doxytag="proto.h::read_parameter_file"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void read_parameter_file           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fname</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function parses the parameterfile in a simple way. Each paramater is defined by a keyword (`tag'), and can be either of type double, int, or character string. The routine makes sure that each parameter appears exactly once in the parameterfile, otherwise error messages are produced that complain about the missing parameters. 
<p>
Definition at line <a class="el" href="begrun_8c-source.html#l00280">280</a> of file <a class="el" href="begrun_8c-source.html">begrun.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00288">global_data_all_processes::ArtBulkViscConst</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="allvars_8h-source.html#l00269">global_data_all_processes::BufferSize</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00428">global_data_all_processes::CourantFac</a>, <a class="el" href="allvars_8h-source.html#l00474">global_data_all_processes::CpuFile</a>, <a class="el" href="allvars_8h-source.html#l00341">global_data_all_processes::CpuTimeBetRestartFile</a>, <a class="el" href="allvars_8h-source.html#l00285">global_data_all_processes::DesNumNgb</a>, <a class="el" href="begrun_8c.html#a0">DOUBLE</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8h-source.html#l00473">global_data_all_processes::EnergyFile</a>, <a class="el" href="allvars_8h-source.html#l00409">global_data_all_processes::ErrTolForceAcc</a>, <a class="el" href="allvars_8h-source.html#l00414">global_data_all_processes::ErrTolIntAccuracy</a>, <a class="el" href="allvars_8h-source.html#l00408">global_data_all_processes::ErrTolTheta</a>, <a class="el" href="allvars_8h-source.html#l00312">global_data_all_processes::GravityConstantInternal</a>, <a class="el" href="allvars_8h-source.html#l00323">global_data_all_processes::HubbleParam</a>, <a class="el" href="allvars_8h-source.html#l00261">global_data_all_processes::ICFormat</a>, <a class="el" href="allvars_8h-source.html#l00475">global_data_all_processes::InfoFile</a>, <a class="el" href="allvars_8h-source.html#l00470">global_data_all_processes::InitCondFile</a>, <a class="el" href="allvars_8h-source.html#l00289">global_data_all_processes::InitGasTemp</a>, <a class="el" href="begrun_8c.html#a2">INT</a>, <a class="el" href="allvars_8h-source.html#l00286">global_data_all_processes::MaxNumNgbDeviation</a>, <a class="el" href="allvars_8h-source.html#l00421">global_data_all_processes::MaxRMSDisplacementFac</a>, <a class="el" href="allvars_8h-source.html#l00419">global_data_all_processes::MaxSizeTimestep</a>, <a class="el" href="allvars_8h-source.html#l00440">global_data_all_processes::MinGasHsmlFractional</a>, <a class="el" href="allvars_8h-source.html#l00290">global_data_all_processes::MinGasTemp</a>, <a class="el" href="allvars_8h-source.html#l00417">global_data_all_processes::MinSizeTimestep</a>, <a class="el" href="allvars_8h-source.html#l00265">global_data_all_processes::NumFilesPerSnapshot</a>, <a class="el" href="allvars_8h-source.html#l00266">global_data_all_processes::NumFilesWrittenInParallel</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00322">global_data_all_processes::OmegaBaryon</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, <a class="el" href="allvars_8h-source.html#l00471">global_data_all_processes::OutputDir</a>, <a class="el" href="allvars_8h-source.html#l00479">global_data_all_processes::OutputListFilename</a>, <a class="el" href="allvars_8h-source.html#l00482">global_data_all_processes::OutputListLength</a>, <a class="el" href="allvars_8h-source.html#l00333">global_data_all_processes::OutputListOn</a>, <a class="el" href="allvars_8h-source.html#l00275">global_data_all_processes::PartAllocFactor</a>, <a class="el" href="allvars_8h-source.html#l00329">global_data_all_processes::PeriodicBoundariesOn</a>, <a class="el" href="begrun_8c-source.html#l00759">read_outputlist()</a>, <a class="el" href="allvars_8h-source.html#l00477">global_data_all_processes::RestartFile</a>, <a class="el" href="allvars_8h-source.html#l00478">global_data_all_processes::ResubmitCommand</a>, <a class="el" href="allvars_8h-source.html#l00330">global_data_all_processes::ResubmitOn</a>, <a class="el" href="allvars_8h-source.html#l00263">global_data_all_processes::SnapFormat</a>, <a class="el" href="allvars_8h-source.html#l00472">global_data_all_processes::SnapshotFileBase</a>, <a class="el" href="allvars_8h-source.html#l00449">global_data_all_processes::SofteningBndry</a>, <a class="el" href="allvars_8h-source.html#l00456">global_data_all_processes::SofteningBndryMaxPhys</a>, <a class="el" href="allvars_8h-source.html#l00447">global_data_all_processes::SofteningBulge</a>, <a class="el" href="allvars_8h-source.html#l00454">global_data_all_processes::SofteningBulgeMaxPhys</a>, <a class="el" href="allvars_8h-source.html#l00446">global_data_all_processes::SofteningDisk</a>, <a class="el" href="allvars_8h-source.html#l00453">global_data_all_processes::SofteningDiskMaxPhys</a>, <a class="el" href="allvars_8h-source.html#l00444">global_data_all_processes::SofteningGas</a>, <a class="el" href="allvars_8h-source.html#l00451">global_data_all_processes::SofteningGasMaxPhys</a>, <a class="el" href="allvars_8h-source.html#l00445">global_data_all_processes::SofteningHalo</a>, <a class="el" href="allvars_8h-source.html#l00452">global_data_all_processes::SofteningHaloMaxPhys</a>, <a class="el" href="allvars_8h-source.html#l00448">global_data_all_processes::SofteningStars</a>, <a class="el" href="allvars_8h-source.html#l00455">global_data_all_processes::SofteningStarsMaxPhys</a>, <a class="el" href="begrun_8c.html#a1">STRING</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00351">global_data_all_processes::TimeBegin</a>, <a class="el" href="allvars_8h-source.html#l00339">global_data_all_processes::TimeBetSnapshot</a>, <a class="el" href="allvars_8h-source.html#l00343">global_data_all_processes::TimeBetStatistics</a>, <a class="el" href="allvars_8h-source.html#l00386">global_data_all_processes::TimeLimitCPU</a>, <a class="el" href="allvars_8h-source.html#l00353">global_data_all_processes::TimeMax</a>, <a class="el" href="allvars_8h-source.html#l00340">global_data_all_processes::TimeOfFirstSnapshot</a>, <a class="el" href="allvars_8h-source.html#l00476">global_data_all_processes::TimingsFile</a>, <a class="el" href="allvars_8h-source.html#l00279">global_data_all_processes::TreeAllocFactor</a>, <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>, <a class="el" href="allvars_8h-source.html#l00331">global_data_all_processes::TypeOfOpeningCriterion</a>, <a class="el" href="allvars_8h-source.html#l00332">global_data_all_processes::TypeOfTimestepCriterion</a>, <a class="el" href="allvars_8h-source.html#l00306">global_data_all_processes::UnitLength_in_cm</a>, <a class="el" href="allvars_8h-source.html#l00304">global_data_all_processes::UnitMass_in_g</a>, and <a class="el" href="allvars_8h-source.html#l00305">global_data_all_processes::UnitVelocity_in_cm_per_s</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a139" doxytag="proto.h::readjust_timebase"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void readjust_timebase           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>TimeMax_old</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>TimeMax_new</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
If a restart from restart-files is carried out where the TimeMax variable is increased, then the integer timeline needs to be adjusted. The approach taken here is to reduce the resolution of the integer timeline by factors of 2 until the new final time can be reached within TIMEBASE.<p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 
<p>
Definition at line <a class="el" href="begrun_8c-source.html#l00793">793</a> of file <a class="el" href="begrun_8c-source.html">begrun.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00367">global_data_all_processes::PM_Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00366">global_data_all_processes::PM_Ti_endstep</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00514">particle_data::Ti_begstep</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00513">particle_data::Ti_endstep</a>, <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>, <a class="el" href="allvars_8h-source.html#l00351">global_data_all_processes::TimeBegin</a>, and <a class="el" href="allvars_8h-source.html#l00353">global_data_all_processes::TimeMax</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a140" doxytag="proto.h::reorder_gas"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void reorder_gas           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function brings the gas particles into the same order as the sorted keys. (The sort is first done only on the keys themselves and done directly on the gas particles in order to reduce the amount of data that needs to be moved in memory. Only once the order is established, the gas particles are rearranged, such that each particle has to be moved at most once.) 
<p>
Definition at line <a class="el" href="peano_8c-source.html#l00117">117</a> of file <a class="el" href="peano_8c-source.html">peano.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00119">P</a>, and <a class="el" href="allvars_8c-source.html#l00127">SphP</a>.
<p>
Referenced by <a class="el" href="peano_8c-source.html#l00034">peano_hilbert_order()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a141" doxytag="proto.h::reorder_particles"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void reorder_particles           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function brings the collisionless particles into the same order as the sorted keys. (The sort is first done only on the keys themselves and done directly on the particles in order to reduce the amount of data that needs to be moved in memory. Only once the order is established, the particles are rearranged, such that each particle has to be moved at most once.) 
<p>
Definition at line <a class="el" href="peano_8c-source.html#l00166">166</a> of file <a class="el" href="peano_8c-source.html">peano.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00119">P</a>.
<p>
Referenced by <a class="el" href="peano_8c-source.html#l00034">peano_hilbert_order()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a142" doxytag="proto.h::restart"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void restart           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>modus</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function reads or writes the restart files. Each processor writes its own restart file, with the I/O being done in parallel. To avoid congestion of the disks you can tell the program to restrict the number of files that are simultaneously written to NumFilesWrittenInParallel.<p>
If modus&gt;0 the <a class="el" href="proto_8h.html#a142">restart()</a>-routine reads, if modus==0 it writes a restart file.<p>
&lt; defines maximum length of neighbour list <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition <p>
&lt; Maximum number of nodes in the top-level tree used for domain decomposition 
<p>
Definition at line <a class="el" href="restart_8c-source.html#l00035">35</a> of file <a class="el" href="restart_8c-source.html">restart.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allocate_8c-source.html#l00103">allocate_memory()</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8c-source.html#l00047">DomainCenter</a>, <a class="el" href="allvars_8c-source.html#l00046">DomainCorner</a>, <a class="el" href="allvars_8c-source.html#l00053">DomainEndList</a>, <a class="el" href="allvars_8c-source.html#l00049">DomainFac</a>, <a class="el" href="allvars_8c-source.html#l00061">DomainHmax</a>, <a class="el" href="allvars_8c-source.html#l00048">DomainLen</a>, <a class="el" href="allvars_8c-source.html#l00063">DomainMoment</a>, <a class="el" href="allvars_8c-source.html#l00051">DomainMyLast</a>, <a class="el" href="allvars_8c-source.html#l00050">DomainMyStart</a>, <a class="el" href="allvars_8c-source.html#l00059">DomainNodeIndex</a>, <a class="el" href="allvars_8c-source.html#l00052">DomainStartList</a>, <a class="el" href="allvars_8c-source.html#l00058">DomainTask</a>, <a class="el" href="allvars_8c-source.html#l00060">DomainTreeNodeLen</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="allvars_8c-source.html#l00151">Extnodes_base</a>, <a class="el" href="allvars_8c-source.html#l00148">Father</a>, <a class="el" href="allvars_8h-source.html#l00582">NODE::father</a>, <a class="el" href="allvars_8h-source.html#l00103">FLOAT</a>, <a class="el" href="forcetree_8c-source.html#l02622">force_treeallocate()</a>, <a class="el" href="allvars_8h-source.html#l00091">MAX_NGB</a>, <a class="el" href="allvars_8c-source.html#l00138">MaxNodes</a>, <a class="el" href="allvars_8h-source.html#l00256">global_data_all_processes::MaxPart</a>, <a class="el" href="allvars_8h-source.html#l00257">global_data_all_processes::MaxPartSph</a>, <a class="el" href="allvars_8h-source.html#l00029">MAXTOPNODES</a>, <a class="el" href="allvars_8c-source.html#l00016">N_gas</a>, <a class="el" href="allvars_8c-source.html#l00147">Nextnode</a>, <a class="el" href="allvars_8h-source.html#l00581">NODE::nextnode</a>, <a class="el" href="ngb_8c-source.html#l00358">ngb_treeallocate()</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes_base</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00266">global_data_all_processes::NumFilesWrittenInParallel</a>, <a class="el" href="allvars_8c-source.html#l00139">Numnodestree</a>, <a class="el" href="allvars_8c-source.html#l00015">NumPart</a>, <a class="el" href="allvars_8h-source.html#l00471">global_data_all_processes::OutputDir</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="allvars_8h-source.html#l00275">global_data_all_processes::PartAllocFactor</a>, <a class="el" href="allvars_8c-source.html#l00039">random_generator</a>, <a class="el" href="allvars_8h-source.html#l00477">global_data_all_processes::RestartFile</a>, <a class="el" href="allvars_8h-source.html#l00580">NODE::sibling</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="allvars_8h-source.html#l00254">global_data_all_processes::TotN_gas</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00279">global_data_all_processes::TreeAllocFactor</a>, and <a class="el" href="structNODE.html#o10">NODE::u</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>, and <a class="el" href="run_8c-source.html#l00020">run()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a143" doxytag="proto.h::run"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void run           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine contains the main simulation loop that iterates over single timesteps. The loop terminates when the cpu-time limit is reached, when a `stop' file is found in the output directory, or when the simulation ends because we arrived at TimeMax.<p>
&lt; The simulated timespan is mapped onto the integer interval [0,TIMESPAN], where TIMESPAN needs to be a power of 2. Note that (1&lt;&lt;28) corresponds to 2^29 
<p>
Definition at line <a class="el" href="run_8c-source.html#l00020">20</a> of file <a class="el" href="run_8c-source.html">run.c</a>.
<p>
References <a class="el" href="timestep_8c-source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="begrun_8c-source.html#l00257">close_outputfiles()</a>, <a class="el" href="accel_8c-source.html#l00024">compute_accelerations()</a>, <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>, <a class="el" href="allvars_8h-source.html#l00393">global_data_all_processes::CPU_Total</a>, <a class="el" href="allvars_8c-source.html#l00023">CPUThisRun</a>, <a class="el" href="allvars_8h-source.html#l00341">global_data_all_processes::CpuTimeBetRestartFile</a>, <a class="el" href="domain_8c-source.html#l00062">domain_Decomposition()</a>, <a class="el" href="run_8c-source.html#l00417">energy_statistics()</a>, <a class="el" href="run_8c-source.html#l00374">every_timestep_stuff()</a>, <a class="el" href="run_8c-source.html#l00153">find_next_sync_point_and_drift()</a>, <a class="el" href="allvars_8h-source.html#l00345">global_data_all_processes::NumCurrentTiStep</a>, <a class="el" href="allvars_8h-source.html#l00471">global_data_all_processes::OutputDir</a>, <a class="el" href="restart_8c-source.html#l00035">restart()</a>, <a class="el" href="allvars_8h-source.html#l00478">global_data_all_processes::ResubmitCommand</a>, <a class="el" href="allvars_8h-source.html#l00330">global_data_all_processes::ResubmitOn</a>, <a class="el" href="io_8c-source.html#l00033">savepositions()</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="allvars_8h-source.html#l00338">global_data_all_processes::SnapshotFileCount</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00359">global_data_all_processes::Ti_Current</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="allvars_8h-source.html#l00025">TIMEBASE</a>, <a class="el" href="allvars_8h-source.html#l00343">global_data_all_processes::TimeBetStatistics</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8h-source.html#l00342">global_data_all_processes::TimeLastRestartFile</a>, <a class="el" href="allvars_8h-source.html#l00344">global_data_all_processes::TimeLastStatistics</a>, <a class="el" href="allvars_8h-source.html#l00386">global_data_all_processes::TimeLimitCPU</a>, and <a class="el" href="allvars_8h-source.html#l00353">global_data_all_processes::TimeMax</a>.
<p>
Referenced by <a class="el" href="main_8c-source.html#l00022">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a144" doxytag="proto.h::savepositions"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void savepositions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>num</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function writes a snapshot of the particle distribution to one or several files using the selected file format. If NumFilesPerSnapshot&gt;1, the snapshot is distributed onto several files, several of them can be written simultaneously (up to NumFilesWrittenInParallel). Each file contains data from a group of processors. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00033">33</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00392">global_data_all_processes::CPU_Snapshot</a>, <a class="el" href="read__ic_8c-source.html#l00725">distribute_file()</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="io_8c-source.html#l00566">fill_Tab_IO_Labels()</a>, <a class="el" href="allvars_8c-source.html#l00012">NTask</a>, <a class="el" href="allvars_8h-source.html#l00265">global_data_all_processes::NumFilesPerSnapshot</a>, <a class="el" href="allvars_8h-source.html#l00266">global_data_all_processes::NumFilesWrittenInParallel</a>, <a class="el" href="allvars_8h-source.html#l00297">global_data_all_processes::NumForcesSinceLastDomainDecomp</a>, <a class="el" href="allvars_8h-source.html#l00471">global_data_all_processes::OutputDir</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="system_8c-source.html#l00053">second()</a>, <a class="el" href="allvars_8h-source.html#l00263">global_data_all_processes::SnapFormat</a>, <a class="el" href="allvars_8h-source.html#l00472">global_data_all_processes::SnapshotFileBase</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="system_8c-source.html#l00074">timediff()</a>, <a class="el" href="allvars_8h-source.html#l00253">global_data_all_processes::TotNumPart</a>, <a class="el" href="allvars_8h-source.html#l00433">global_data_all_processes::TreeDomainUpdateFrequency</a>, <a class="el" href="allvars_8h-source.html#l00512">particle_data::Type</a>, and <a class="el" href="io_8c-source.html#l00673">write_file()</a>.
<p>
Referenced by <a class="el" href="run_8c-source.html#l00020">run()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a145" doxytag="proto.h::second"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double second           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns the number of cpu-ticks in seconds that have elapsed, or the wall-clock time obtained with MPI_Wtime(). 
<p>
Definition at line <a class="el" href="system_8c-source.html#l00053">53</a> of file <a class="el" href="system_8c-source.html">system.c</a>.
<p>
Referenced by <a class="el" href="timestep_8c-source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="accel_8c-source.html#l00024">compute_accelerations()</a>, <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>, <a class="el" href="density_8c-source.html#l00056">density()</a>, <a class="el" href="domain_8c-source.html#l00062">domain_Decomposition()</a>, <a class="el" href="gravtree__forcetest_8c-source.html#l00028">gravity_forcetest()</a>, <a class="el" href="gravtree_8c-source.html#l00027">gravity_tree()</a>, <a class="el" href="hydra_8c-source.html#l00050">hydro_force()</a>, <a class="el" href="main_8c-source.html#l00022">main()</a>, <a class="el" href="predict_8c-source.html#l00031">move_particles()</a>, <a class="el" href="run_8c-source.html#l00020">run()</a>, and <a class="el" href="io_8c-source.html#l00033">savepositions()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a146" doxytag="proto.h::seed_glass"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void seed_glass           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="init_8c-source.html#l00020">init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a147" doxytag="proto.h::set_random_numbers"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void set_random_numbers           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This routine fills the random number table.<p>
&lt; gives the length of a table with random numbers, refreshed at every timestep. This is used to allow application of random numbers to a specific particle in a way that is independent of the number of processors used. 
<p>
Definition at line <a class="el" href="system_8c-source.html#l00039">39</a> of file <a class="el" href="system_8c-source.html">system.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00043">RndTable</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a148" doxytag="proto.h::set_softenings"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void set_softenings           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function sets the (comoving) softening length of all particle types in the table All.SofteningTable[...]. We check that the physical softening length is bounded by the Softening-MaxPhys values. 
<p>
Definition at line <a class="el" href="gravtree_8c-source.html#l00454">454</a> of file <a class="el" href="gravtree_8c-source.html">gravtree.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="allvars_8h-source.html#l00459">global_data_all_processes::ForceSoftening</a>, <a class="el" href="allvars_8h-source.html#l00441">global_data_all_processes::MinGasHsml</a>, <a class="el" href="allvars_8h-source.html#l00440">global_data_all_processes::MinGasHsmlFractional</a>, <a class="el" href="allvars_8h-source.html#l00449">global_data_all_processes::SofteningBndry</a>, <a class="el" href="allvars_8h-source.html#l00456">global_data_all_processes::SofteningBndryMaxPhys</a>, <a class="el" href="allvars_8h-source.html#l00447">global_data_all_processes::SofteningBulge</a>, <a class="el" href="allvars_8h-source.html#l00454">global_data_all_processes::SofteningBulgeMaxPhys</a>, <a class="el" href="allvars_8h-source.html#l00446">global_data_all_processes::SofteningDisk</a>, <a class="el" href="allvars_8h-source.html#l00453">global_data_all_processes::SofteningDiskMaxPhys</a>, <a class="el" href="allvars_8h-source.html#l00444">global_data_all_processes::SofteningGas</a>, <a class="el" href="allvars_8h-source.html#l00451">global_data_all_processes::SofteningGasMaxPhys</a>, <a class="el" href="allvars_8h-source.html#l00445">global_data_all_processes::SofteningHalo</a>, <a class="el" href="allvars_8h-source.html#l00452">global_data_all_processes::SofteningHaloMaxPhys</a>, <a class="el" href="allvars_8h-source.html#l00448">global_data_all_processes::SofteningStars</a>, <a class="el" href="allvars_8h-source.html#l00455">global_data_all_processes::SofteningStarsMaxPhys</a>, <a class="el" href="allvars_8h-source.html#l00458">global_data_all_processes::SofteningTable</a>, and <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>.
<p>
Referenced by <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>, <a class="el" href="gravtree__forcetest_8c-source.html#l00028">gravity_forcetest()</a>, <a class="el" href="gravtree_8c-source.html#l00027">gravity_tree()</a>, and <a class="el" href="init_8c-source.html#l00020">init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a149" doxytag="proto.h::set_units"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void set_units           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Computes conversion factors between internal code units and the cgs-system.<p>
&lt; Gravitational constant (in cgs units) <p>
&lt; mass fraction of hydrogen, relevant only for radiative cooling <p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="begrun_8c-source.html#l00149">149</a> of file <a class="el" href="begrun_8c-source.html">begrun.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00066">BOLTZMANN</a>, <a class="el" href="allvars_8h-source.html#l00302">global_data_all_processes::G</a>, <a class="el" href="allvars_8h-source.html#l00061">GRAVITY</a>, <a class="el" href="allvars_8h-source.html#l00312">global_data_all_processes::GravityConstantInternal</a>, <a class="el" href="allvars_8h-source.html#l00075">HUBBLE</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00291">global_data_all_processes::MinEgySpec</a>, <a class="el" href="allvars_8h-source.html#l00290">global_data_all_processes::MinGasTemp</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00309">global_data_all_processes::UnitCoolingRate_in_cgs</a>, <a class="el" href="allvars_8h-source.html#l00308">global_data_all_processes::UnitDensity_in_cgs</a>, <a class="el" href="allvars_8h-source.html#l00310">global_data_all_processes::UnitEnergy_in_cgs</a>, <a class="el" href="allvars_8h-source.html#l00306">global_data_all_processes::UnitLength_in_cm</a>, <a class="el" href="allvars_8h-source.html#l00304">global_data_all_processes::UnitMass_in_g</a>, <a class="el" href="allvars_8h-source.html#l00307">global_data_all_processes::UnitPressure_in_cgs</a>, <a class="el" href="allvars_8h-source.html#l00311">global_data_all_processes::UnitTime_in_Megayears</a>, <a class="el" href="allvars_8h-source.html#l00303">global_data_all_processes::UnitTime_in_s</a>, and <a class="el" href="allvars_8h-source.html#l00305">global_data_all_processes::UnitVelocity_in_cm_per_s</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a150" doxytag="proto.h::setup_smoothinglengths"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void setup_smoothinglengths           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function is used to find an initial smoothing length for each SPH particle. It guarantees that the number of neighbours will be between desired_ngb-MAXDEV and desired_ngb+MAXDEV. For simplicity, a first guess of the smoothing length is provided to the function <a class="el" href="density_8c.html#a8">density()</a>, which will then iterate if needed to find the right smoothing length. 
<p>
Definition at line <a class="el" href="init_8c-source.html#l00202">202</a> of file <a class="el" href="init_8c-source.html">init.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="structNODE.html#o9">NODE::d</a>, <a class="el" href="allvars_8h-source.html#l00285">global_data_all_processes::DesNumNgb</a>, <a class="el" href="allvars_8h-source.html#l00582">NODE::father</a>, <a class="el" href="allvars_8c-source.html#l00148">Father</a>, <a class="el" href="allvars_8h-source.html#l00537">sph_particle_data::Hsml</a>, <a class="el" href="allvars_8h-source.html#l00566">NODE::len</a>, <a class="el" href="allvars_8h-source.html#l00578">NODE::mass</a>, <a class="el" href="allvars_8h-source.html#l00495">particle_data::Mass</a>, <a class="el" href="allvars_8c-source.html#l00141">Nodes</a>, <a class="el" href="allvars_8c-source.html#l00119">P</a>, <a class="el" href="proto_8h.html#a133">pow()</a>, <a class="el" href="allvars_8c-source.html#l00026">RestartFlag</a>, <a class="el" href="allvars_8c-source.html#l00127">SphP</a>, and <a class="el" href="structNODE.html#o10">NODE::u</a>.
<p>
Referenced by <a class="el" href="init_8c-source.html#l00020">init()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a151" doxytag="proto.h::statistics"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void statistics           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a152" doxytag="proto.h::terminate_processes"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void terminate_processes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a153" doxytag="proto.h::timediff"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double timediff           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>t0</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>t1</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
returns the time difference between two measurements obtained with <a class="el" href="proto_8h.html#a145">second()</a>. The routine takes care of the possible overflow of the tick counter on 32bit systems, but depending on the system, this may not always work properly. Similarly, in some MPI implementations, the MPI_Wtime() function may also overflow, in which case a negative time difference would be returned. The routine returns instead a time difference equal to 0. 
<p>
Definition at line <a class="el" href="system_8c-source.html#l00074">74</a> of file <a class="el" href="system_8c-source.html">system.c</a>.
<p>
References <a class="el" href="proto_8h.html#a133">pow()</a>.
<p>
Referenced by <a class="el" href="timestep_8c-source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="accel_8c-source.html#l00024">compute_accelerations()</a>, <a class="el" href="potential_8c-source.html#l00022">compute_potential()</a>, <a class="el" href="density_8c-source.html#l00056">density()</a>, <a class="el" href="domain_8c-source.html#l00062">domain_Decomposition()</a>, <a class="el" href="gravtree__forcetest_8c-source.html#l00028">gravity_forcetest()</a>, <a class="el" href="gravtree_8c-source.html#l00027">gravity_tree()</a>, <a class="el" href="hydra_8c-source.html#l00050">hydro_force()</a>, <a class="el" href="main_8c-source.html#l00022">main()</a>, <a class="el" href="predict_8c-source.html#l00031">move_particles()</a>, <a class="el" href="run_8c-source.html#l00020">run()</a>, and <a class="el" href="io_8c-source.html#l00033">savepositions()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a155" doxytag="proto.h::write_file"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void write_file           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>writeTask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>lastTask</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function writes an actual snapshot file containing the data from processors 'writeTask' to 'lastTask'. 'writeTask' is the one that actually writes. Each snapshot file contains a header first, then particle positions, velocities and ID's. Particle masses are written only for those particle types with zero entry in MassTable. After that, first the internal energies u, and then the density is written for the SPH particles. If cooling is enabled, mean molecular weight and neutral hydrogen abundance are written for the gas particles. This is followed by the SPH smoothing length and further blocks of information, depending on included physics and compile-time flags. If HDF5 is used, the header is stored in a group called "/Header", and the particle data is stored separately for each particle type in groups calles "/PartType0", "/PartType1", etc. The sequence of the blocks is unimportant in this case.<p>
&lt; Various tags used for labelling MPI messages <p>
&lt; Various tags used for labelling MPI messages <p>
&lt; total number of defined information blocks for snapshot files. Must be equal to the number of entries in "enum iofields" 
<p>
Definition at line <a class="el" href="io_8c-source.html#l00673">673</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="io_8c-source.html#l00532">blockpresent()</a>, <a class="el" href="allvars_8h-source.html#l00259">global_data_all_processes::BoxSize</a>, <a class="el" href="allvars_8h-source.html#l00624">io_header::BoxSize</a>, <a class="el" href="allvars_8h-source.html#l00269">global_data_all_processes::BufferSize</a>, <a class="el" href="allvars_8c-source.html#l00101">CommBuffer</a>, <a class="el" href="allvars_8h-source.html#l00328">global_data_all_processes::ComovingIntegrationOn</a>, <a class="el" href="endrun_8c-source.html#l00025">endrun()</a>, <a class="el" href="io_8c-source.html#l00129">fill_write_buffer()</a>, <a class="el" href="allvars_8h-source.html#l00622">io_header::flag_cooling</a>, <a class="el" href="allvars_8h-source.html#l00619">io_header::flag_feedback</a>, <a class="el" href="allvars_8h-source.html#l00629">io_header::flag_metals</a>, <a class="el" href="allvars_8h-source.html#l00618">io_header::flag_sfr</a>, <a class="el" href="allvars_8h-source.html#l00628">io_header::flag_stellarage</a>, <a class="el" href="io_8c-source.html#l00366">get_bytes_per_blockelement()</a>, <a class="el" href="io_8c-source.html#l00614">get_dataset_name()</a>, <a class="el" href="io_8c-source.html#l00405">get_datatype_in_block()</a>, <a class="el" href="io_8c-source.html#l00465">get_particles_in_block()</a>, <a class="el" href="io_8c-source.html#l00432">get_values_per_blockelement()</a>, <a class="el" href="allvars_8c-source.html#l00161">header</a>, <a class="el" href="allvars_8h-source.html#l00323">global_data_all_processes::HubbleParam</a>, <a class="el" href="allvars_8h-source.html#l00627">io_header::HubbleParam</a>, <a class="el" href="allvars_8h-source.html#l00640">iofields</a>, <a class="el" href="allvars_8h-source.html#l00614">io_header::mass</a>, <a class="el" href="allvars_8h-source.html#l00462">global_data_all_processes::MassTable</a>, <a class="el" href="io_8c-source.html#l01124">my_fwrite()</a>, <a class="el" href="allvars_8h-source.html#l00613">io_header::npart</a>, <a class="el" href="allvars_8h-source.html#l00620">io_header::npartTotal</a>, <a class="el" href="allvars_8h-source.html#l00630">io_header::npartTotalHighWord</a>, <a class="el" href="allvars_8h-source.html#l00623">io_header::num_files</a>, <a class="el" href="allvars_8h-source.html#l00265">global_data_all_processes::NumFilesPerSnapshot</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00625">io_header::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, <a class="el" href="allvars_8h-source.html#l00626">io_header::OmegaLambda</a>, <a class="el" href="allvars_8h-source.html#l00617">io_header::redshift</a>, <a class="el" href="allvars_8h-source.html#l00263">global_data_all_processes::SnapFormat</a>, <a class="el" href="allvars_8c-source.html#l00167">Tab_IO_Labels</a>, <a class="el" href="tags_8h-source.html#l00032">TAG_LOCALN</a>, <a class="el" href="tags_8h-source.html#l00005">TAG_N</a>, <a class="el" href="tags_8h-source.html#l00019">TAG_NFORTHISTASK</a>, <a class="el" href="tags_8h-source.html#l00007">TAG_PDATA</a>, <a class="el" href="allvars_8c-source.html#l00011">ThisTask</a>, <a class="el" href="allvars_8h-source.html#l00350">global_data_all_processes::Time</a>, <a class="el" href="allvars_8h-source.html#l00616">io_header::time</a>, and <a class="el" href="io_8c-source.html#l01000">write_header_attributes_in_hdf5()</a>.
<p>
Referenced by <a class="el" href="io_8c-source.html#l00033">savepositions()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a154" doxytag="proto.h::write_header_attributes_in_hdf5"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void write_header_attributes_in_hdf5           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">hid_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>handle</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function writes the header information in case HDF5 is selected as file format. 
<p>
Definition at line <a class="el" href="io_8c-source.html#l01000">1000</a> of file <a class="el" href="io_8c-source.html">io.c</a>.
<p>
Referenced by <a class="el" href="io_8c-source.html#l00673">write_file()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a156" doxytag="proto.h::write_pid_file"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void write_pid_file           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat Apr 22 15:29:42 2006 for GADGET-2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
