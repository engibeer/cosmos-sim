<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>GADGET-2: driftfac.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>driftfac.c File Reference</h1>compute loop-up tables for prefactors in cosmological integration <a href="#_details">More...</a>
<p>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;math.h&gt;</code><br>
<code>#include &lt;mpi.h&gt;</code><br>
<code>#include &lt;gsl/gsl_math.h&gt;</code><br>
<code>#include &lt;gsl/gsl_integration.h&gt;</code><br>
<code>#include "<a class="el" href="allvars_8h-source.html">allvars.h</a>"</code><br>
<code>#include "<a class="el" href="proto_8h-source.html">proto.h</a>"</code><br>

<p>
<a href="driftfac_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a0">WORKSIZE</a>&nbsp;&nbsp;&nbsp;100000</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a3">init_drift_table</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a4">get_drift_factor</a> (int time0, int time1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a5">get_gravkick_factor</a> (int time0, int time1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a6">get_hydrokick_factor</a> (int time0, int time1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a7">drift_integ</a> (double a, void *param)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a8">gravkick_integ</a> (double a, void *param)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a9">hydrokick_integ</a> (double a, void *param)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="driftfac_8c.html#a10">growthfactor_integ</a> (double a, void *param)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
compute loop-up tables for prefactors in cosmological integration 
<p>

<p>
Definition in file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="driftfac.c::WORKSIZE"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define WORKSIZE&nbsp;&nbsp;&nbsp;100000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="driftfac_8c-source.html#l00026">init_drift_table()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a7" doxytag="driftfac.c::drift_integ"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double drift_integ           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>param</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Integration kernel for drift factor computation. 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00179">179</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, and <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="driftfac.c::get_drift_factor"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double get_drift_factor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>time0</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>time1</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function integrates the cosmological prefactor for a drift step between time0 and time1. The value returned is * <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{a_0}^{a_1} \frac{{\rm d}a}{H(a)} * \]" src="form_0.png">
<p>
<p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00067">67</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00095">DRIFT_TABLE_LENGTH</a>, <a class="el" href="allvars_8c-source.html#l00097">DriftTable</a>, and <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>.
<p>
Referenced by <a class="el" href="predict_8c-source.html#l00031">move_particles()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="driftfac.c::get_gravkick_factor"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double get_gravkick_factor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>time0</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>time1</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function integrates the cosmological prefactor for a kick step of the gravitational force.<p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00105">105</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00095">DRIFT_TABLE_LENGTH</a>, <a class="el" href="allvars_8c-source.html#l00098">GravKickTable</a>, and <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>.
<p>
Referenced by <a class="el" href="timestep_8c-source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="global_8c-source.html#l00022">compute_global_quantities_of_system()</a>, <a class="el" href="io_8c-source.html#l00129">fill_write_buffer()</a>, and <a class="el" href="predict_8c-source.html#l00031">move_particles()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="driftfac.c::get_hydrokick_factor"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double get_hydrokick_factor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>time0</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>time1</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function integrates the cosmological prefactor for a kick step of the hydrodynamical force.<p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00142">142</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00095">DRIFT_TABLE_LENGTH</a>, <a class="el" href="allvars_8c-source.html#l00099">HydroKickTable</a>, and <a class="el" href="allvars_8h-source.html#l00358">global_data_all_processes::Timebase_interval</a>.
<p>
Referenced by <a class="el" href="timestep_8c-source.html#l00024">advance_and_find_timesteps()</a>, <a class="el" href="global_8c-source.html#l00022">compute_global_quantities_of_system()</a>, <a class="el" href="io_8c-source.html#l00129">fill_write_buffer()</a>, and <a class="el" href="predict_8c-source.html#l00031">move_particles()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="driftfac.c::gravkick_integ"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double gravkick_integ           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>param</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Integration kernel for gravitational kick factor computation. 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00191">191</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, and <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="driftfac.c::growthfactor_integ"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double growthfactor_integ           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>param</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00214">214</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, and <a class="el" href="proto_8h.html#a133">pow()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="driftfac.c::hydrokick_integ"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double hydrokick_integ           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">double&nbsp;</td>
          <td class="mdname" nowrap> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>param</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Integration kernel for hydrodynamical kick factor computation.<p>
&lt; adiabatic index of simulated gas 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00204">204</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00055">GAMMA_MINUS1</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8h-source.html#l00320">global_data_all_processes::Omega0</a>, <a class="el" href="allvars_8h-source.html#l00321">global_data_all_processes::OmegaLambda</a>, and <a class="el" href="proto_8h.html#a133">pow()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="driftfac.c::init_drift_table"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void init_drift_table           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function computes look-up tables for factors needed in cosmological integrations. The (simple) integrations are carried out with the GSL library. Separate factors are computed for the "drift", and the gravitational and hydrodynamical "kicks". The lookup-table is used for reasons of speed.<p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors <p>
&lt; length of the lookup table used to hold the drift and kick factors 
<p>
Definition at line <a class="el" href="driftfac_8c-source.html#l00026">26</a> of file <a class="el" href="driftfac_8c-source.html">driftfac.c</a>.
<p>
References <a class="el" href="allvars_8c-source.html#l00111">All</a>, <a class="el" href="allvars_8h-source.html#l00095">DRIFT_TABLE_LENGTH</a>, <a class="el" href="allvars_8c-source.html#l00097">DriftTable</a>, <a class="el" href="allvars_8c-source.html#l00098">GravKickTable</a>, <a class="el" href="allvars_8h-source.html#l00319">global_data_all_processes::Hubble</a>, <a class="el" href="allvars_8c-source.html#l00099">HydroKickTable</a>, <a class="el" href="allvars_8h-source.html#l00351">global_data_all_processes::TimeBegin</a>, <a class="el" href="allvars_8h-source.html#l00353">global_data_all_processes::TimeMax</a>, and <a class="el" href="driftfac_8c.html#a0">WORKSIZE</a>.
<p>
Referenced by <a class="el" href="begrun_8c-source.html#l00028">begrun()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat Apr 22 15:29:42 2006 for GADGET-2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
